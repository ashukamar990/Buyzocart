<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Buyzo Cart — Modern Shop</title>
  <meta name="description" content="Buyzo Cart — clean, mobile‑first shop template with product cards, step checkout, and policy modals."/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://images.unsplash.com"/>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <style>
    :root {
      --bg: #f8fafc;
      --card: #ffffff;
      --accent: #2563eb;
      --accent-hover: #1d4ed8;
      --muted: #64748b;
      --muted-light: #94a3b8;
      --success: #22c55e;
      --error: #ef4444;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      --shadow-hover: 0 6px 16px rgba(0, 0, 0, 0.08);
      --ring: #dbeafe;
      --ink: #0f172a;
      --ink-2: #334155;
      --border: #e2e8f0;
      --radius: 12px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--ink);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* Header */
    header {
      background: var(--card);
      box-shadow: var(--shadow);
      padding: 16px 24px;
      position: sticky;
      top: 0;
      z-index: 50;
      border-bottom: 1px solid var(--border);
    }

    .header-inner {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 16px;
      justify-content: space-between;
    }

    .brand {
      font-weight: 800;
      color: var(--ink);
      font-size: 20px;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .brand .chip {
      background: var(--accent);
      color: #fff;
      font-weight: 700;
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 14px;
    }

    .search-wrap {
      flex: 1;
      display: flex;
      max-width: 500px;
      margin: 16px 0;
    }

    .search-wrap input {
      flex: 1;
      padding: 12px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      font-family: inherit;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    .search-wrap input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--ring);
    }

    .cta {
      display: flex;
      gap: 10px;
      position: relative;
    }

    .btn {
      background: var(--accent);
      color: #fff;
      border: 0;
      padding: 10px 16px;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .btn:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
    }

    .btn.secondary {
      background: #f1f5f9;
      color: var(--ink-2);
    }

    .btn.secondary:hover {
      background: #e2e8f0;
      transform: translateY(-1px);
    }

    .btn.error {
      background: var(--error);
    }

    .btn.error:hover {
      background: #dc2626;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Notification Badge */
    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: var(--error);
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: bold;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    /* Container */
    .container {
      max-width: 1100px;
      margin: 28px auto;
      padding: 0 20px;
      min-height: 70vh;
    }

    /* Hero */
    .hero {
      background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 24px;
      margin-bottom: 24px;
    }

    .hero h1 {
      margin: 0 0 8px 0;
      font-size: 24px;
      font-weight: 700;
    }

    .hero p {
      margin: 0;
      color: var(--muted);
      font-size: 16px;
    }

    /* Steps */
    .steps {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin: 24px 0;
      flex-wrap: wrap;
    }

    .step-pill {
      background: #fff;
      padding: 10px 16px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-weight: 600;
      color: var(--ink-2);
      cursor: pointer;
      user-select: none;
      transition: all 0.2s ease;
      font-size: 14px;
    }

    .step-pill:hover {
      border-color: var(--accent);
    }

    .step-pill.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .step-pill.disabled:hover {
      border-color: var(--border);
    }

    /* Grid - ALWAYS 2 columns */
    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
    }

    .img {
      height: 220px;
      background-position: center;
      background-size: cover;
    }

    .card-body {
      padding: 16px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .title {
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 16px;
    }

    .price {
      font-weight: 700;
      color: var(--ink);
      margin-bottom: 8px;
      font-size: 18px;
    }

    .badge {
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 12px;
    }

    /* Pages */
    .page {
      display: none;
    }

    .page.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card-panel {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
      margin-bottom: 16px;
      border: 1px solid var(--border);
    }

    .card-panel h3 {
      margin-top: 0;
      margin-bottom: 12px;
      font-size: 18px;
      font-weight: 600;
    }

    label {
      display: block;
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 6px;
      font-weight: 500;
    }

    input, select, textarea {
      width: 100%;
      padding: 12px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: #fff;
      outline: none;
      font-family: inherit;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    input:focus, select:focus, textarea:focus {
      box-shadow: 0 0 0 3px var(--ring);
      border-color: var(--accent);
    }

    .row {
      display: flex;
      gap: 16px;
    }

    .col {
      flex: 1;
    }

    .summary {
      background: #f8fafc;
      padding: 16px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    .center {
      text-align: center;
    }

    footer {
      margin-top: 48px;
      text-align: center;
      color: var(--muted);
      padding: 28px 0;
      border-top: 1px solid var(--border);
    }

    /* Thumbnails */
    .thumbs {
      display: flex;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .thumb {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      border: 2px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .thumb:hover {
      transform: scale(1.05);
    }

    .thumb.selected {
      border-color: var(--accent);
    }

    /* FIX FOR PROBLEM 1: Remove blue background from order page slider */
    #orderPage .gallery-main {
      background-color: transparent !important;
    }

    .gallery-main {
      height: 340px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      position: relative;
      overflow: hidden;
    }

    /* NEW: Product Image Slider Container */
    .product-img-slider-container {
      position: relative;
      height: 220px;
      overflow: hidden;
      border-radius: var(--radius) var(--radius) 0 0;
      cursor: pointer;
    }

    .product-img-slider {
      height: 100%;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      transition: background-image 0.3s ease;
      background-color: transparent;
    }

    /* NEW: Slider Controls for Product Cards */
    .product-card-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 14px;
      color: var(--ink);
      transition: all 0.2s ease;
      z-index: 10;
      opacity: 0;
    }

    .card:hover .product-card-control {
      opacity: 1;
    }

    .product-card-control:hover {
      background: rgba(255, 255, 255, 1);
    }

    .product-card-control.prev {
      left: 5px;
    }

    .product-card-control.next {
      right: 5px;
    }

    .product-card-dots {
      position: absolute;
      bottom: 10px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 6px;
      z-index: 10;
    }

    .product-card-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .product-card-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }

    /* Social Media Icons */
    .social-links {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-top: 20px;
    }

    .social-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--accent);
      color: white;
      transition: all 0.3s ease;
    }

    .social-icon:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      background: var(--accent-hover);
    }

    .social-icon svg {
      width: 20px;
      height: 20px;
    }

    /* Product Detail Page */
    .product-detail-page {
      padding: 20px;
    }
    
    .product-detail-container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }
    
    .product-detail-gallery {
      flex: 1;
      min-width: 300px;
      position: relative;
    }
    
    .product-detail-info {
      flex: 1;
      min-width: 300px;
    }
    
    .product-detail-main-image {
      width: 100%;
      height: 400px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      margin-bottom: 16px;
      position: relative;
      overflow: hidden;
      cursor: zoom-in;
    }
    
    .product-detail-thumbnails {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .product-detail-thumbnail {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      border: 2px solid var(--border);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .product-detail-thumbnail:hover,
    .product-detail-thumbnail.active {
      border-color: var(--accent);
      transform: scale(1.05);
    }
    
    .product-detail-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .product-detail-price {
      font-size: 28px;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 12px;
    }
    
    .product-detail-desc {
      color: var(--muted);
      margin-bottom: 20px;
      font-size: 16px;
    }
    
    .product-detail-full-desc {
      margin-bottom: 24px;
      line-height: 1.6;
      color: var(--ink-2);
    }
    
    .product-detail-meta {
      background: #f8fafc;
      padding: 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      margin-bottom: 24px;
    }
    
    .product-detail-meta h4 {
      margin: 0 0 12px 0;
      color: var(--accent);
      font-size: 16px;
    }
    
    .back-to-products {
      display: inline-flex;
      align-items: center;
      margin-bottom: 20px;
      color: var(--accent);
      font-weight: 600;
      cursor: pointer;
      padding: 8px 16px;
      border-radius: var(--radius);
      background: #f1f5f9;
      transition: all 0.2s ease;
    }
    
    .back-to-products:hover {
      background: #e2e8f0;
      color: var(--accent-hover);
    }

    /* Similar Products Section */
    .similar-products {
      margin-top: 40px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }
    
    .similar-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--ink);
    }

    /* Carousel Controls for Product Detail */
    .detail-carousel-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      color: var(--ink);
      transition: all 0.2s ease;
      z-index: 10;
    }

    .detail-carousel-control:hover {
      background: rgba(255, 255, 255, 1);
    }

    .detail-carousel-control.prev {
      left: 10px;
    }

    .detail-carousel-control.next {
      right: 10px;
    }

    .detail-carousel-dots {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }

    .detail-carousel-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .detail-carousel-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }

    /* Policy Pages */
    .policy-page {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .policy-content {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      border: 1px solid var(--border);
    }
    
    .policy-content h2 {
      margin-top: 0;
      color: var(--accent);
      border-bottom: 2px solid var(--border);
      padding-bottom: 12px;
      margin-bottom: 20px;
    }
    
    .policy-content h3 {
      margin: 24px 0 12px;
      color: var(--ink);
    }
    
    .policy-content p {
      margin-bottom: 16px;
      line-height: 1.6;
    }
    
    .policy-content ul, .policy-content ol {
      margin: 16px 0;
      padding-left: 24px;
    }
    
    .policy-content li {
      margin-bottom: 8px;
    }
    
    .back-button {
      display: inline-flex;
      align-items: center;
      margin-bottom: 20px;
      color: var(--accent);
      font-weight: 600;
      cursor: pointer;
    }
    
    .back-button:hover {
      color: var(--accent-hover);
    }

    /* Product Details Enhancement */
    .product-details {
      margin: 16px 0;
      padding: 16px;
      background: #f8fafc;
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }
    
    .product-details h4 {
      margin: 0 0 12px 0;
      color: var(--accent);
      font-size: 16px;
    }
    
    .product-details p {
      margin: 0;
      color: var(--ink-2);
      line-height: 1.6;
    }

    /* Category Navigation */
    .categories {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 16px 0 24px;
      justify-content: center;
    }
    
    .category-pill {
      background: #fff;
      padding: 8px 16px;
      border-radius: 20px;
      border: 1px solid var(--border);
      font-weight: 500;
      color: var(--ink-2);
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
      white-space: nowrap;
    }
    
    .category-pill:hover, .category-pill.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    .category-pill.active {
      font-weight: 600;
    }

    /* Carousel Controls */
    .carousel-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      color: var(--ink);
      transition: all 0.2s ease;
      z-index: 10;
    }

    .carousel-control:hover {
      background: rgba(255, 255, 255, 1);
    }

    .carousel-control.prev {
      left: 10px;
    }

    .carousel-control.next {
      right: 10px;
    }

    .carousel-dots {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }

    .carousel-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .carousel-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }

    /* About Us Section */
    .about-us {
      margin-top: 40px;
      padding: 20px;
      background: #f8fafc;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      text-align: center;
    }

    .about-us h3 {
      margin-bottom: 12px;
      color: var(--accent);
    }

    .about-us p {
      color: var(--ink-2);
      max-width: 600px;
      margin: 0 auto;
    }

    /* My Orders Page */
    .orders-container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .order-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
      margin-bottom: 20px;
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
    }
    
    .order-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-hover);
    }
    
    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }
    
    .order-id {
      font-weight: 600;
      color: var(--accent);
    }
    
    .order-date {
      color: var(--muted);
      font-size: 14px;
    }
    
    .order-estimated {
      color: var(--success);
      font-size: 14px;
      font-weight: 500;
      margin-top: 4px;
    }
    
    .order-status {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .status-confirmed {
      background: #dcfce7;
      color: #166534;
    }
    
    .status-shipped {
      background: #dbeafe;
      color: #1e40af;
    }
    
    .status-delivered {
      background: #dcfce7;
      color: #166534;
    }
    
    .status-cancelled {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .order-details {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }
    
    .order-product-image {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border: 1px solid var(--border);
    }
    
    .order-product-info {
      flex: 1;
    }
    
    .order-product-title {
      font-weight: 600;
      margin-bottom: 6px;
    }
    
    .order-product-price {
      color: var(--accent);
      font-weight: 700;
      margin-bottom: 6px;
    }
    
    .order-product-meta {
      color: var(--muted);
      font-size: 14px;
    }
    
    .order-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    /* Order Detail Page */
    .order-detail-page {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      margin-bottom: 24px;
    }
    
    .order-detail-section {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }
    
    .order-detail-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    
    .order-detail-label {
      font-weight: 600;
      color: var(--muted);
      margin-bottom: 6px;
      font-size: 14px;
    }
    
    .order-detail-value {
      font-size: 16px;
      color: var(--ink);
    }
    
    .order-detail-image {
      width: 120px;
      height: 120px;
      border-radius: 8px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border: 1px solid var(--border);
      margin-right: 16px;
    }
    
    .order-detail-product {
      display: flex;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .order-detail-product-info {
      flex: 1;
    }

    /* Horizontal Product Slider */
    .product-slider {
      margin: 30px 0;
      position: relative;
    }
    
    .slider-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .slider-title {
      font-size: 20px;
      font-weight: 700;
    }
    
    .slider-controls {
      display: flex;
      gap: 8px;
    }
    
    .slider-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--card);
      border: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .slider-btn:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    .slider-container {
      overflow-x: auto;
      scroll-behavior: smooth;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
      user-select: none;
    }
    
    .slider-container::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }
    
    .slider-track {
      display: flex;
      gap: 16px;
      padding: 4px;
      user-select: none;
    }
    
    .slider-item {
      flex: 0 0 auto;
      width: 200px;
      background: var(--card);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      transition: all 0.3s ease;
      cursor: pointer;
      user-select: none;
    }
    
    .slider-item:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
    }
    
    .slider-item-img {
      height: 150px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .slider-item-body {
      padding: 12px;
    }
    
    .slider-item-title {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .slider-item-price {
      font-weight: 700;
      color: var(--accent);
      font-size: 16px;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card);
      color: var(--ink);
      padding: 16px 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow-hover);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }
    
    .toast.success {
      border-left: 4px solid var(--success);
    }
    
    .toast.error {
      border-left: 4px solid var(--error);
    }
    
    .toast-icon {
      font-size: 20px;
    }
    
    .toast.success .toast-icon {
      color: var(--success);
    }
    
    .toast.error .toast-icon {
      color: var(--error);
    }

    /* Cancellation Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .cancellation-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow-hover);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }
    
    .cancellation-modal h3 {
      margin-top: 0;
      margin-bottom: 16px;
      color: var(--ink);
    }
    
    .cancellation-reason {
      margin-bottom: 12px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .cancellation-reason:hover {
      border-color: var(--accent);
      background: #f8fafc;
    }
    
    .cancellation-reason.selected {
      border-color: var(--accent);
      background: var(--ring);
    }
    
    .cancellation-reason input {
      margin-right: 8px;
      width: auto;
    }
    
    .cancellation-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      justify-content: flex-end;
    }

    /* Alert Modal - Updated with Cancel and Yes buttons */
    .alert-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow-hover);
      max-width: 500px;
      width: 90%;
      text-align: center;
    }
    
    .alert-modal h3 {
      margin-top: 0;
      margin-bottom: 16px;
      color: var(--ink);
    }
    
    .alert-modal p {
      margin-bottom: 20px;
      line-height: 1.6;
    }
    
    .alert-modal .alert-icon {
      font-size: 48px;
      color: var(--error);
      margin-bottom: 16px;
    }
    
    /* New styles for alert modal buttons */
    .alert-modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 20px;
    }

    /* Quantity Input Controls */
    .quantity-control {
      display: flex;
      align-items: center;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      width: 100%;
    }
    
    .quantity-control button {
      background: #f1f5f9;
      border: none;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s ease;
    }
    
    .quantity-control button:hover {
      background: #e2e8f0;
    }
    
    .quantity-control input {
      flex: 1;
      text-align: center;
      border: none;
      border-left: 1px solid var(--border);
      border-right: 1px solid var(--border);
      border-radius: 0;
      padding: 10px;
      margin: 0;
    }

    /* Delivery Congratulations */
    .delivery-congrats {
      background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
      border: 1px solid #22c55e;
      border-radius: var(--radius);
      padding: 16px;
      margin-top: 16px;
      text-align: center;
      color: #166534;
      font-weight: 600;
    }
    
    .delivery-congrats-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }

    /* Refund Request Section */
    .refund-section {
      background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
      border: 1px solid #f59e0b;
      border-radius: var(--radius);
      padding: 16px;
      margin-top: 16px;
    }
    
    .refund-title {
      font-size: 16px;
      font-weight: 600;
      color: #92400e;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .refund-note {
      color: #92400e;
      font-size: 14px;
      margin-bottom: 12px;
    }
    
    .refund-time-left {
      background: #fef3c7;
      border: 1px solid #f59e0b;
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 12px;
      font-weight: 600;
      color: #92400e;
      display: inline-block;
      margin-bottom: 12px;
    }

    /* Mobile Menu Icon */
    .menu-icon {
      display: none;
      flex-direction: column;
      justify-content: space-between;
      width: 24px;
      height: 18px;
      cursor: pointer;
    }
    
    .menu-icon span {
      height: 2px;
      width: 100%;
      background-color: var(--ink);
      border-radius: 2px;
      transition: all 0.3s ease;
    }
    
    /* Mobile Menu */
    .mobile-menu {
      position: fixed;
      top: 0;
      left: -280px;
      width: 280px;
      height: 100vh;
      background: var(--card);
      box-shadow: var(--shadow-hover);
      z-index: 1000;
      transition: left 0.3s ease;
      overflow-y: auto;
    }
    
    .mobile-menu.active {
      left: 0;
    }
    
    .menu-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
    }
    
    .menu-close {
      font-size: 24px;
      cursor: pointer;
      color: var(--muted);
    }
    
    .menu-items {
      padding: 16px 0;
    }
    
    .menu-item {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: var(--ink);
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .menu-item:hover {
      background: #f1f5f9;
      color: var(--accent);
    }
    
    .menu-item svg {
      margin-right: 12px;
      width: 18px;
      height: 18px;
    }
    
    .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .menu-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* Product Slider Enhancements */
    .product-slider-container {
      position: relative;
      margin: 20px 0;
    }
    
    .product-slider-wrapper {
      overflow: hidden;
      position: relative;
      border-radius: var(--radius);
    }
    
    .product-slider-track {
      display: flex;
      transition: transform 0.3s ease;
    }
    
    .product-slide {
      flex: 0 0 auto;
      width: 100%;
      height: 400px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .product-slider-nav {
      position: absolute;
      bottom: 20px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }
    
    .product-slider-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .product-slider-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }
    
    .product-slider-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      color: var(--ink);
      transition: all 0.2s ease;
      z-index: 10;
    }
    
    .product-slider-arrow:hover {
      background: rgba(255, 255, 255, 1);
    }
    
    .product-slider-arrow.prev {
      left: 10px;
    }
    
    .product-slider-arrow.next {
      right: 10px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header-inner {
        flex-wrap: wrap;
      }
      
      .search-wrap {
        margin-left: 0;
        order: 3;
        width: 100%;
        max-width: 100%;
      }
      
      .row {
        flex-direction: column;
      }
      
      /* Keep 2 columns on mobile */
      .grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      
      .steps {
        gap: 6px;
      }
      
      .step-pill {
        font-size: 12px;
        padding: 8px 12px;
      }
      
      .policy-content {
        padding: 16px;
      }
      
      .categories {
        overflow-x: auto;
        padding-bottom: 8px;
        justify-content: flex-start;
      }

      .carousel-control {
        width: 32px;
        height: 32px;
        font-size: 14px;
      }
      
      .product-detail-container {
        flex-direction: column;
      }
      
      .product-detail-main-image {
        height: 300px;
      }
      
      .order-details {
        flex-direction: column;
      }
      
      .order-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      
      .order-actions {
        justify-content: flex-start;
      }
      
      .cancellation-modal {
        padding: 16px;
      }
      
      .cancellation-actions {
        flex-direction: column;
      }
      
      .alert-modal {
        padding: 16px;
      }
      
      .alert-modal-buttons {
        flex-direction: column;
      }
      
      .quantity-control button {
        width: 36px;
        height: 36px;
      }
      
      /* Show menu icon on mobile */
      .menu-icon {
        display: flex;
      }
      
      /* Hide some CTA buttons on mobile to make space */
      .cta .btn:not(:last-child) {
        display: none;
      }
      
      /* Adjust product card controls for mobile */
      .product-card-control {
        opacity: 1;
        width: 25px;
        height: 25px;
        font-size: 12px;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 0 16px;
      }
      
      .hero {
        padding: 20px;
      }
      
      .card-panel {
        padding: 16px;
      }
      
      .product-detail-main-image {
        height: 250px;
      }
      
      .product-detail-thumbnail {
        width: 60px;
        height: 60px;
      }
      
      /* Keep 2 columns on very small screens */
      .grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
    }

    /* Copyright Section */
    .copyright {
      text-align: center;
      padding: 20px;
      background-color: var(--card);
      color: var(--muted);
      font-size: 14px;
      border-top: 1px solid var(--border);
    }
  
/* === Clean Animated Banners CSS === */
.hero-messages {
  margin-top: 10px;
  font-size: 16px;
  color: var(--muted);
  font-weight: 600;
  display: flex;
  justify-content: center;
  gap: 24px;
  overflow: hidden;
  position: relative;
}
.hero-messages span {
  opacity: 0;
  position: absolute;
  transition: opacity 0.6s ease;
}
.hero-messages span.active {
  opacity: 1;
  position: relative;
}

.highlight-strip {
  margin-top: 16px;
  padding: 10px 16px;
  border-radius: 8px;
  background: linear-gradient(90deg,#2563eb,#1d4ed8);
  color: white;
  font-weight: 600;
  text-align: center;
  animation: pulseStrip 4s infinite;
  cursor: pointer;
}
@keyframes pulseStrip {
  0%,100% { box-shadow: 0 0 0 rgba(37,99,235,0); }
  50% { box-shadow: 0 0 16px rgba(37,99,235,0.35); }
}

/* Search Results Grid */
#homeSearchResults {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
  margin-top: 20px;
}

/* Trending Now Section */
.trending-section {
  margin: 30px 0;
}

.trending-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.trending-title {
  font-size: 20px;
  font-weight: 700;
}

/* NEW FEATURES STYLES */

/* Recently Viewed Products */
.recently-viewed {
  margin: 40px 0;
  padding-top: 24px;
  border-top: 1px solid var(--border);
}

.recently-viewed-title {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 16px;
  color: var(--ink);
}

/* Newsletter Section */
.newsletter-section {
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
  border-radius: var(--radius);
  padding: 32px 24px;
  text-align: center;
  margin: 40px 0;
  border: 1px solid var(--border);
}

.newsletter-title {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 8px;
  color: var(--ink);
}

.newsletter-desc {
  color: var(--muted);
  margin-bottom: 20px;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}

.newsletter-form {
  display: flex;
  max-width: 400px;
  margin: 0 auto;
  gap: 10px;
}

.newsletter-input {
  flex: 1;
  padding: 12px 16px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  font-family: inherit;
  font-size: 14px;
}

.newsletter-btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .newsletter-btn:hover {
      background: var(--accent-hover);
    }

    /* Social Sharing */
    .social-sharing {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .share-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: var(--radius);
      background: #f1f5f9;
      color: var(--ink);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .share-btn:hover {
      background: #e2e8f0;
      transform: translateY(-1px);
    }

    .share-btn.facebook { background: #f0f7ff; color: #1877f2; }
    .share-btn.twitter { background: #f0f9ff; color: #1da1f2; }
    .share-btn.whatsapp { background: #f0fff4; color: #25d366; }

    /* Product Quick Actions */
    .quick-actions {
      display: flex;
      gap: 8px;
      margin-top: 16px;
    }

    .quick-action-btn {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 12px;
      text-align: center;
    }

    .quick-action-btn:hover {
      background: #f8fafc;
      border-color: var(--accent);
    }

    /* Stock Status */
    .stock-status {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .in-stock {
      background: #dcfce7;
      color: #166534;
    }

    .low-stock {
      background: #fef3c7;
      color: #92400e;
    }

    .out-of-stock {
      background: #fee2e2;
      color: #991b1b;
    }

    /* Product SKU */
    .product-sku {
      color: var(--muted);
      font-size: 14px;
      margin-bottom: 8px;
    }

    /* Breadcrumb Navigation */
    .breadcrumb {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      color: var(--muted);
    }

    .breadcrumb a {
      color: var(--accent);
    }

    .breadcrumb span {
      color: var(--muted-light);
    }

    /* Loading Spinner */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Price Filter */
    .price-filter {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 20px;
      border: 1px solid var(--border);
    }

    .price-filter-title {
      font-weight: 600;
      margin-bottom: 12px;
      font-size: 16px;
    }

    .price-range {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .price-input {
      flex: 1;
    }

    /* Wishlist Button Active State - UPDATED TO RED */
    .wishlist-btn.active {
      color: var(--error) !important;
      background: #fee2e2 !important;
      border-color: var(--error) !important;
    }

    .wishlist-btn.active:hover {
      background: #fecaca !important;
    }

    /* Product Detail Page Wishlist Button - UPDATED TO RED */
    #detailWishlistBtn.active {
      background: var(--error) !important;
      color: white !important;
      border-color: var(--error) !important;
    }

    #detailWishlistBtn.active:hover {
      background: #dc2626 !important;
    }

    /* Size and Color Selection */
    .size-color-options {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }

    .size-option, .color-option {
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .size-option:hover, .color-option:hover {
      border-color: var(--accent);
    }

    .size-option.selected, .color-option.selected {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* Simple Price Range Slider */
    .price-range-slider {
      margin: 16px 0;
    }

    .price-slider {
      width: 100%;
      height: 5px;
      border-radius: 5px;
      background: #ddd;
      outline: none;
      -webkit-appearance: none;
    }

    .price-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
    }

    .price-slider::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      border: none;
    }

    .price-range-values {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      font-size: 14px;
      color: var(--muted);
    }

    /* Remove blue overlay from product images */
    .product-img-slider:focus,
    .product-detail-main-image:focus,
    .gallery-main:focus {
      outline: none;
      box-shadow: none;
    }

    /* Product image container fixes */
    .product-img-slider-container,
    .product-detail-gallery,
    .gallery-main {
      background-color: transparent !important;
    }

    /* NEW: Remove blue highlight from product and order pages */
    .card,
    .card-body,
    .product-img-slider-container,
    .gallery-main,
    .product-detail-main-image,
    .product-detail-thumbnail,
    .slider-item,
    .order-card,
    .order-detail-page {
      -webkit-tap-highlight-color: transparent;
      outline: none;
    }

    /* Keep blue highlight only for menu items */
    .menu-item {
      -webkit-tap-highlight-color: rgba(37, 99, 235, 0.1);
    }

    /* Size validation error styling */
    .size-validation-error {
      color: var(--error);
      font-size: 14px;
      margin-top: 8px;
      display: none;
    }

    .size-validation-error.show {
      display: block;
    }

    /* Cancel Order Flow Modal */
    .cancel-confirm-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow-hover);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .cancel-confirm-modal h3 {
      margin-top: 0;
      margin-bottom: 16px;
      color: var(--ink);
    }

    .cancel-confirm-modal .payment-charge-note {
      background: #fef3c7;
      border: 1px solid #f59e0b;
      border-radius: var(--radius);
      padding: 16px;
      margin: 16px 0;
      color: #92400e;
    }

    .cancel-confirm-modal .refund-calculation {
      background: #f8fafc;
      border-radius: var(--radius);
      padding: 16px;
      margin: 16px 0;
    }

    .cancel-confirm-modal .refund-calculation p {
      margin: 8px 0;
    }

    .cancel-confirm-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      justify-content: flex-end;
    }

    /* NEW: Login/Signup Modal Styles */
    .auth-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 32px;
      box-shadow: var(--shadow-hover);
      max-width: 450px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }
    
    .auth-modal h3 {
      margin-top: 0;
      margin-bottom: 24px;
      color: var(--ink);
      text-align: center;
      font-size: 24px;
    }
    
    .auth-tabs {
      display: flex;
      margin-bottom: 24px;
      border-bottom: 1px solid var(--border);
    }
    
    .auth-tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      font-weight: 600;
      color: var(--muted);
      transition: all 0.2s ease;
      border-bottom: 2px solid transparent;
    }
    
    .auth-tab.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }
    
    .auth-form {
      display: none;
    }
    
    .auth-form.active {
      display: block;
    }
    
    .auth-form-group {
      margin-bottom: 16px;
    }
    
    .auth-form-footer {
      margin-top: 24px;
      text-align: center;
      font-size: 14px;
      color: var(--muted);
    }
    
    .auth-form-footer a {
      color: var(--accent);
      cursor: pointer;
    }
    
    .user-profile {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }
    
    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--accent);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
    }
    
    .user-name {
      font-weight: 600;
      color: var(--ink);
    }
    
    /* NEW: Close button for auth modal */
    .auth-close {
      position: absolute;
      top: 16px;
      right: 16px;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--muted);
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s ease;
    }
    
    .auth-close:hover {
      background: #f1f5f9;
      color: var(--ink);
    }
    
    /* NEW: Google Sign-In Button */
    .google-signin-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
      padding: 12px 16px;
      background: white;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 16px;
    }
    
    .google-signin-btn:hover {
      background: #f8fafc;
      border-color: var(--accent);
    }
    
    .google-signin-btn img {
      width: 18px;
      height: 18px;
    }
    
    .divider {
      display: flex;
      align-items: center;
      margin: 20px 0;
      color: var(--muted);
      font-size: 14px;
    }
    
    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid var(--border);
    }
    
    .divider span {
      padding: 0 12px;
    }

    /* NEW: Image Zoom Modal */
    .zoom-modal {
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .zoom-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
    }
    
    .zoom-image {
      max-width: 100%;
      max-height: 90vh;
      object-fit: contain;
    }
    
    .zoom-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 20px;
      transition: all 0.2s ease;
    }
    
    .zoom-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .zoom-controls {
      position: absolute;
      bottom: 20px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    
    .zoom-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.2s ease;
    }
    
    .zoom-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* NEW: Enhanced Product Gallery */
    .product-gallery-zoom {
      position: relative;
      cursor: zoom-in;
    }
    
    .zoom-indicator {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .product-gallery-zoom:hover .zoom-indicator {
      opacity: 1;
    }

    /* NEW: Advertisement Banner Styles */
    .ad-banner-section {
      margin: 30px 0;
      position: relative;
    }
    
    .ad-slider-container {
      overflow: hidden;
      border-radius: var(--radius);
      position: relative;
    }
    
    .ad-slider-track {
      display: flex;
      transition: transform 0.5s ease;
    }
    
    .ad-slide {
      flex: 0 0 100%;
      height: 200px;
      background-size: cover;
      background-position: center;
      border-radius: var(--radius);
      cursor: pointer;
    }
    
    .ad-slider-nav {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }
    
    .ad-slider-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .ad-slider-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }
    
    .ad-slider-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      color: var(--ink);
      transition: all 0.2s ease;
      z-index: 10;
    }
    
    .ad-slider-arrow:hover {
      background: rgba(255, 255, 255, 1);
    }
    
    .ad-slider-arrow.prev {
      left: 10px;
    }
    
    .ad-slider-arrow.next {
      right: 10px;
    }

    /* NEW: Category Circle Styles */
    .category-circles {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    
    .category-circle {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .category-circle:hover {
      transform: translateY(-5px);
    }
    
    .category-icon {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      border: 2px solid var(--border);
      transition: all 0.3s ease;
    }
    
    .category-circle:hover .category-icon {
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
    }
    
    .category-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--ink);
      text-align: center;
    }

    /* NEW: User Profile Page Styles */
    .profile-page {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .profile-header {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }
    
    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      background-color: var(--accent);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 32px;
      font-weight: 700;
    }
    
    .profile-info h2 {
      margin: 0 0 8px 0;
      font-size: 24px;
    }
    
    .profile-info p {
      margin: 0;
      color: var(--muted);
    }
    
    .profile-section {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      border: 1px solid var(--border);
    }
    
    .profile-section h3 {
      margin-top: 0;
      margin-bottom: 20px;
      color: var(--accent);
      font-size: 18px;
    }
    
    .address-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .address-item {
      padding: 16px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: #f8fafc;
    }
    
    .address-item.active {
      border-color: var(--accent);
      background: var(--ring);
    }
    
    .address-actions {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }

    /* NEW: Forgot Password Link */
    .forgot-password {
      text-align: right;
      margin-top: 8px;
    }
    
    .forgot-password a {
      color: var(--accent);
      font-size: 14px;
      cursor: pointer;
    }
    
    .forgot-password a:hover {
      text-decoration: underline;
    }

    /* NEW: Error Message Styling */
    .error-message {
      color: var(--error);
      font-size: 14px;
      margin-top: 8px;
      display: none;
    }
    
    .error-message.show {
      display: block;
    }
</style>

</head>
<body>
  <!-- Mobile Menu Overlay -->
  <div class="menu-overlay" id="menuOverlay"></div>
  
  <!-- Mobile Menu - Updated with login/signup -->
  <div class="mobile-menu" id="mobileMenu">
    <div class="menu-header">
      <div class="brand">
        <span class="chip">BUYZO</span>
        <span>Cart</span>
      </div>
      <div class="menu-close" id="menuClose">×</div>
    </div>
    <div class="menu-items">
      <div class="menu-item" onclick="showPage('homePage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
        Home
      </div>
      <div class="menu-item" onclick="showPage('productsPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        Products
      </div>
      <div class="menu-item" onclick="showPage('profilePage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        My Account
      </div>
      <div class="menu-item" onclick="showMyOrders(); showPage('myOrdersPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="20" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
        My Orders
      </div>
      <div class="menu-item" onclick="showPage('wishlistPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>
        Wishlist
      </div>
      <div class="menu-item" onclick="showPage('cancellationPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="15" y1="9" x2="9" y2="15"></line>
          <line x1="9" y1="9" x2="15" y2="15"></line>
        </svg>
        Refund & Cancellation
      </div>
      <div class="menu-item" onclick="showPage('termsPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        Terms & Conditions
      </div>
      <div class="menu-item" onclick="showPage('shippingPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 15a5 5 0 0 1 5-5h8a5 5 0 0 1 5 5v0a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5v0z"></path>
          <path d="M3 15V9a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v6"></path>
          <path d="M9 19h6"></path>
        </svg>
        Shipping Policy
      </div>
      <div class="menu-item" onclick="showPage('privacyPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
        </svg>
        Privacy Policy
      </div>
      <div class="menu-item" onclick="showPage('contactPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
          <polyline points="22,6 12,13 2,6"></polyline>
        </svg>
        Contact Us
      </div>
      
      <!-- NEW: Login/Signup at the bottom of mobile menu -->
      <div class="menu-item" id="mobileLoginBtn" onclick="showLoginModal(); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        Login / Sign Up
      </div>
      <div class="menu-item" id="mobileUserProfile" style="display:none;" onclick="showPage('profilePage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        <span id="mobileUserName">User</span>
      </div>
    </div>
  </div>

  <header>
    <div class="header-inner">
      <div class="menu-icon" id="menuIcon">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div class="brand" aria-label="Buyzo Cart brand" onclick="showPage('homePage')">
        <span class="chip">BUYZO</span>
        <span>Cart</span>
      </div>
      <div class="cta">
        <button class="btn secondary" id="openContactTop" title="Contact">Contact</button>
        <button class="btn secondary" id="openMyOrdersTop" title="My Orders">My Orders
          <span id="ordersNotification" class="notification-badge" style="display:none"></span>
        </button>
        <button class="btn secondary" id="openProfileTop" title="My Account">My Account</button>
        <!-- NEW: Login/Signup buttons instead of Wishlist -->
        <button class="btn secondary" id="openLoginTop" title="Login">Login</button>
        <div class="user-profile" id="userProfile" style="display:none;">
          <div class="user-avatar" id="userAvatar">U</div>
          <div class="user-name" id="userName">User</div>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Home Page -->
    <section class="page active" id="homePage">
      
      <section class="hero">
        <h1>Welcome to <span style="color:var(--accent)">Buyzo Cart</span></h1>
        <p>Clean, fast checkout. Hand‑picked products. Fully responsive UI.</p>

        <!-- Rotating subtle messages -->
        <div class="hero-messages" id="heroMessages">
          <span class="active">🔥 Big Sale Today</span>
          <span>🚚 Free Shipping over ₹999</span>
          <span>✨ New Arrivals Just Dropped</span>
        </div>

        <!-- Highlight CTA strip -->
        <div class="highlight-strip" onclick="showPage('productsPage')">
          Limited Time Offer: Flat 40% OFF on all Fashion Items — <u>Shop Now →</u>
        </div>
      </section>

      <!-- NEW: Advertisement Banner Section -->
      <div class="ad-banner-section" id="adBannerSection" style="display:none;">
        <div class="ad-slider-container">
          <div class="ad-slider-track" id="adSliderTrack"></div>
          <button class="ad-slider-arrow prev">&#10094;</button>
          <button class="ad-slider-arrow next">&#10095;</button>
          <div class="ad-slider-nav" id="adSliderNav"></div>
        </div>
      </div>

      <!-- TRENDING NOW SECTION (moved to top) -->
      <div class="trending-section">
        <div class="trending-header">
          <h2 class="trending-title">Trending Now</h2>
        </div>
        <div class="slider-container">
          <div class="slider-track" id="productSlider"></div>
        </div>
      </div>

      <!-- NEW: Category Circles Section -->
      <div class="category-circles" id="categoryCircles">
        <!-- Category circles will be loaded here from Firebase -->
      </div>

      <!-- SEARCH BAR (added below Trending Now) -->
      <div class="search-wrap">
        <input id="homeSearchInput" placeholder="Search products (e.g. 'Sneakers', 'T-shirt', 'Earbuds')" />
      </div>

      <!-- Search Results Grid -->
      <div id="homeSearchResults" style="display:none;"></div>

      <div class="steps center">
        <div class="step-pill" id="pill-products">1 • Products</div>
        <div class="step-pill disabled" id="pill-order">2 • Order Details</div>
        <div class="step-pill disabled" id="pill-user">3 • Your Info</div>
        <div class="step-pill disabled" id="pill-pay">4 • Payment</div>
      </div>

      <div class="card-panel" style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
        <h2 style="margin:0">Featured Products</h2>
      </div>

      <!-- Featured Products Grid -->
      <div class="grid" id="homeProductGrid">
        <!-- Product cards will be loaded here -->
      </div>

      <!-- NEW: Recently Viewed Products Section -->
      <div class="recently-viewed" id="recentlyViewedSection" style="display:none;">
        <h2 class="recently-viewed-title">Recently Viewed</h2>
        <div class="slider-container">
          <div class="slider-track" id="recentlyViewedSlider"></div>
        </div>
      </div>

      <!-- NEW: Newsletter Subscription Section -->
      <div class="newsletter-section">
        <h2 class="newsletter-title">Stay Updated</h2>
        <p class="newsletter-desc">Subscribe to our newsletter for exclusive deals, new arrivals, and special offers delivered to your inbox.</p>
        <div class="newsletter-form">
          <input type="email" class="newsletter-input" placeholder="Enter your email" id="newsletterEmail" />
          <button class="newsletter-btn" id="subscribeBtn">Subscribe</button>
        </div>
      </div>
    </section>

    <!-- Products Page -->
    <section class="page" id="productsPage">
      <div class="card-panel" style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
        <h2 style="margin:0">All Products</h2>
      </div>

      <!-- NEW: Price Filter - Simplified -->
      <div class="price-filter">
        <div class="price-filter-title">Filter by Price</div>
        <div class="price-range-slider">
          <input type="range" min="0" max="5000" value="0" class="price-slider" id="minPriceSlider">
          <input type="range" min="0" max="5000" value="5000" class="price-slider" id="maxPriceSlider">
          <div class="price-range-values">
            <span id="minPriceValue">₹0</span>
            <span id="maxPriceValue">₹5000</span>
          </div>
        </div>
        <div class="price-range" style="margin-top: 12px;">
          <input type="number" class="price-input" id="minPrice" placeholder="Min" min="0" />
          <span>to</span>
          <input type="number" class="price-input" id="maxPrice" placeholder="Max" min="0" />
          <button class="btn secondary" id="applyPriceFilter">Apply</button>
          <button class="btn secondary" id="resetPriceFilter">Reset</button>
        </div>
      </div>

      <!-- Search bar -->
      <div class="search-wrap">
        <input id="searchInput" placeholder="Search products (e.g. 'Sneakers', 'T-shirt', 'Earbuds')" />
      </div>

      <!-- Category Navigation -->
      <div class="categories" id="categoriesContainer">
        <!-- Categories will be loaded from Firebase by admin -->
      </div>

      <div class="grid" id="productGrid">
        <!-- Product cards will be loaded here -->
      </div>
    </section>

    <!-- NEW: User Profile Page -->
    <section class="page" id="profilePage">
      <div class="profile-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        
        <div class="profile-header">
          <div class="profile-avatar" id="profileAvatar">
            <!-- Avatar will be loaded here -->
          </div>
          <div class="profile-info">
            <h2 id="profileName">User Name</h2>
            <p id="profileEmail">user@example.com</p>
          </div>
        </div>
        
        <div class="profile-section">
          <h3>Personal Information</h3>
          <div class="row">
            <div class="col">
              <label>Full Name</label>
              <input type="text" id="profileFullName" placeholder="Enter your full name">
            </div>
            <div class="col">
              <label>Phone Number</label>
              <input type="tel" id="profilePhone" placeholder="Enter your phone number">
            </div>
          </div>
          <button class="btn" style="margin-top: 16px;" id="saveProfileBtn">Save Changes</button>
        </div>
        
        <div class="profile-section">
          <h3>Delivery Addresses</h3>
          <div class="address-list" id="addressList">
            <!-- Addresses will be loaded here -->
          </div>
          <button class="btn secondary" style="margin-top: 16px;" id="addAddressBtn">Add New Address</button>
        </div>
        
        <div class="profile-section">
          <h3>Account Actions</h3>
          <div style="display: flex; gap: 12px; flex-wrap: wrap;">
            <button class="btn secondary" onclick="showMyOrders(); showPage('myOrdersPage')">View My Orders</button>
            <button class="btn secondary" onclick="showPage('wishlistPage')">View Wishlist</button>
            <button class="btn error" onclick="logoutUser()">Logout</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Product Detail Page -->
    <section class="page" id="productDetailPage">
      <div class="product-detail-page">
        <!-- NEW: Breadcrumb Navigation -->
        <div class="breadcrumb">
          <a href="#" onclick="showPage('homePage')">Home</a>
          <span>></span>
          <a href="#" onclick="showPage('productsPage')">Products</a>
          <span>></span>
          <span id="breadcrumbProductName">Product Details</span>
        </div>
        
        <div class="back-to-products" onclick="showPage('productsPage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Products
        </div>
        
        <div class="product-detail-container">
          <div class="product-detail-gallery">
            <!-- NEW: Enhanced gallery with zoom -->
            <div class="product-gallery-zoom">
              <div class="product-detail-main-image" id="detailMainImage" onclick="openImageZoom()">
                <button class="detail-carousel-control prev">&#10094;</button>
                <button class="detail-carousel-control next">&#10095;</button>
                <div class="detail-carousel-dots" id="detailCarouselDots"></div>
                <div class="zoom-indicator">Click to zoom</div>
              </div>
            </div>
            <div class="product-detail-thumbnails" id="detailThumbnails"></div>
          </div>
          
          <div class="product-detail-info">
            <h1 class="product-detail-title" id="detailTitle"></h1>
            <!-- NEW: Product SKU -->
            <div class="product-sku" id="detailSku"></div>
            <div class="product-detail-price" id="detailPrice"></div>
            <!-- NEW: Stock Status -->
            <div class="stock-status in-stock" id="detailStockStatus">In Stock</div>
            <div class="product-detail-desc" id="detailDesc"></div>
            <div class="product-detail-full-desc" id="detailFullDesc"></div>
            
            <!-- NEW: Quick Actions -->
            <div class="quick-actions">
              <button class="quick-action-btn" id="detailShareBtn" onclick="copyProductLink()">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-1.61L23 6H6"></path>
                  <polyline points="16 6 12 2 8 6"></polyline>
                  <line x1="12" y1="2" x2="12" y2="15"></line>
                </svg>
                Copy Link
              </button>
            </div>
            
            <div class="product-detail-meta">
              <h4>Product Details</h4>
              <div id="detailMeta"></div>
            </div>
            
            <!-- NEW: Social Sharing Buttons -->
            <div class="social-sharing">
              <button class="share-btn facebook" data-platform="facebook" onclick="shareProduct('facebook')">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
                Share
              </button>
              <button class="share-btn twitter" data-platform="twitter" onclick="shareProduct('twitter')">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                </svg>
                Tweet
              </button>
              <button class="share-btn whatsapp" data-platform="whatsapp" onclick="shareProduct('whatsapp')">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                </svg>
                Share
              </button>
            </div>
            
            <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:20px;">
              <button class="btn" id="detailOrderBtn">Order Now</button>
              <button class="btn secondary" id="detailWishlistBtn">Add to Wishlist</button>
              <button class="btn secondary" onclick="showPage('productsPage')">Continue Shopping</button>
            </div>
          </div>
        </div>

        <!-- Similar Products Section -->
        <div class="similar-products">
          <h2 class="similar-title">Similar Products</h2>
          <div class="slider-container">
            <div class="slider-track" id="similarProductsSlider"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Order Details Page -->
    <section class="page" id="orderPage">
      <div class="card-panel">
        <h3 style="margin-top:0">Order Details</h3>
        <p style="color:var(--muted)">Choose size/quantity and confirm product before entering contact or payment details.</p>

        <div id="selectedProductCard" class="card" style="margin-bottom:16px">
          <div style="display:flex;gap:16px;flex-direction:column">
            <div id="galleryMain" class="gallery-main">
              <button class="carousel-control prev">&#10094;</button>
              <button class="carousel-control next">&#10095;</button>
              <div class="carousel-dots"></div>
            </div>
          </div>
          <div class="card-body">
            <div class="title" id="spTitle"></div>
            <div class="price" id="spPrice"></div>
            <div class="badge" id="spDesc"></div>
            
            <!-- Product Details Section -->
            <div class="product-details">
              <h4>Product Details</h4>
              <p id="spFullDesc"></p>
            </div>

            <div style="margin-top:auto">
              <!-- Updated: Size/Color Selection -->
              <label>Select size / colour</label>
              <div class="size-color-options">
                <div class="size-option selected" data-value="S">S</div>
                <div class="size-option" data-value="M">M</div>
                <div class="size-option" data-value="L">L</div>
                <div class="size-option" data-value="XL">XL</div>
              </div>
              <div class="size-validation-error" id="sizeValidationError">Please select a size to continue</div>

            <div style="height:12px"></div>
              <label>Quantity</label>
              <!-- Replaced with plus/minus quantity control -->
              <div class="quantity-control">
                <button class="qty-minus">-</button>
                <input type="number" id="qtySelect" min="1" value="1" readonly>
                <button class="qty-plus">+</button>
              </div>

              <div style="height:16px"></div>
              <div style="display:flex;gap:10px;flex-wrap:wrap">
                <button id="toUserInfo" class="btn" style="flex:1">Continue → Provide Your Info</button>
                <button id="backToProducts" class="btn secondary" style="flex:1">Back to Products</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- User Info Page -->
    <section class="page" id="userPage">
      <div class="card-panel">
        <h3 style="margin-top:0">Your Contact & Delivery Address</h3>
        <p style="color:var(--muted)">We do not use saved addresses. Please provide a fresh delivery address for this order.</p>

        <div style="display:flex;gap:16px;flex-direction:column">
          <div>
            <label>Full Name *</label>
            <input id="fullname" placeholder="Enter full name" />
          </div>
          <div class="row">
            <div class="col"><label>Mobile Number *</label><input id="mobile" placeholder="10-digit mobile number" /></div>
            <div class="col"><label>Pincode *</label><input id="pincode" placeholder="Pincode" /></div>
          </div>
          <div class="row">
            <div class="col"><label>City *</label><input id="city" /></div>
            <div class="col"><label>State *</label><input id="state" /></div>
          </div>
          <div>
            <label>House / Street *</label>
            <input id="house" />
          </div>
          <div style="display:flex;gap:10px;margin-top:16px;flex-wrap:wrap">
            <button id="toPayment" class="btn" style="flex:1">Continue to Payment</button>
            <button id="editOrder" class="btn secondary" style="flex:1">Edit Order Details</button>
            <button id="saveUserInfo" class="btn secondary" style="flex:1">Save Information</button>
          </div>
          <div style="margin-top:16px;color:var(--muted);font-size:14px">
            <strong>Note:</strong> If you prefer to change products, click "Edit Order Details" or use "Products" to go back.
          </div>
        </div>
      </div>
    </section>

    <!-- Payment Page -->
    <section class="page" id="paymentPage">
      <div class="card-panel">
        <h3 style="margin-top:0">Payment Method</h3>
        <div style="display:flex;gap:12px;flex-wrap:wrap;margin-bottom:16px">
          <label style="flex:1;display:flex;align-items:center;gap:8px;padding:12px;border:1px solid var(--border);border-radius:var(--radius);cursor:pointer;">
            <input type="radio" name="pay" value="prepaid" checked /> Prepaid (UPI / Card)
          </label>
          <label style="flex:1;display:flex;align-items:center;gap:8px;padding:12px;border:1px solid var(--border);border-radius:var(--radius);cursor:pointer;">
            <input type="radio" name="pay" value="cod" /> Cash on Delivery (Note: may increase processing time)
          </label>
        </div>
        
        <div class="summary">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px"><div>Product</div><div id="sumProduct">-</div></div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px"><div>Qty</div><div id="sumQty">-</div></div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px"><div>Price</div><div id="sumPrice">-</div></div>
          <div style="display:flex;justify-content:space-between;margin-bottom:12px;padding-bottom:8px;border-bottom:1px dashed var(--border)"><div>Delivery</div><div id="sumDel">₹50</div></div>
          <div style="display:flex;justify-content:space-between;font-weight:700;margin-top:8px;font-size:18px"><div>Total</div><div id="sumTotal">-</div></div>
        </div>
        
        <div style="height:16px"></div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <button id="confirmOrder" class="btn" style="flex:1">Confirm & Place Order</button>
          <button id="payBack" class="btn secondary" style="flex:1">Back</button>
        </div>
      </div>
    </section>

    <!-- Order Success (hidden) -->
    <section class="page center" id="successPage">
      <div class="card-panel" style="max-width:520px;margin:32px auto;padding:32px">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin:0 auto 16px">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <div style="font-size:24px;font-weight:700;color:var(--success);margin-bottom:8px">Thank You for Your Order!</div>
        <div style="margin-top:10px;color:var(--muted)">Your order has been placed successfully! We will confirm and process your order. Tracking will be shared once supplier ships it.</div>
        <div style="margin-top:24px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
          <button id="goHome" class="btn">Back to Home</button>
          <button id="viewOrders" class="btn secondary">View My Orders</button>
        </div>
      </div>
    </section>

    <!-- My Orders Page -->
    <section class="page" id="myOrdersPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        
        <div class="orders-container">
          <h2>My Orders</h2>
          <p style="color:var(--muted);margin-bottom:24px">View and manage your recent orders</p>
          
          <div id="ordersList">
            <!-- Orders will be dynamically inserted here -->
          </div>
          
          <div id="noOrders" class="card-panel center" style="display:none">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--muted-light)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <h3 style="margin:16px 0 8px;color:var(--muted)">No orders yet</h3>
            <p style="color:var(--muted-light)">You haven't placed any orders yet. Start shopping to see your orders here.</p>
            <button class="btn" style="margin-top:16px" onclick="showPage('productsPage')">Start Shopping</button>
            </div>
        </div>
      </div>
    </section>

    <!-- Order Detail Page -->
    <section class="page" id="orderDetailPage">
      <div class="policy-page">
        <div class="back-button" onclick="showMyOrders(); showPage('myOrdersPage');">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to My Orders
        </div>
        
        <div class="orders-container">
          <h2>Order Details</h2>
          
          <div class="order-detail-page" id="orderDetailContent">
            <!-- Order details will be dynamically inserted here -->
          </div>
        </div>
      </div>
    </section>

    <!-- Wishlist Page -->
    <section class="page" id="wishlistPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        
        <div class="orders-container">
          <h2>My Wishlist</h2>
          <p style="color:var(--muted);margin-bottom:24px">Your favorite products</p>
          
          <div id="wishlistGrid" class="grid">
            <!-- Wishlist items will be dynamically inserted here -->
          </div>
          
          <div id="noWishlist" class="card-panel center" style="display:none">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--muted-light)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            <h3 style="margin:16px 0 8px;color:var(--muted)">Your wishlist is empty</h3>
            <p style="color:var(--muted-light)">Start adding products to your wishlist to see them here.</p>
            <button class="btn" style="margin-top:16px" onclick="showPage('productsPage')">Start Shopping</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Policy Pages -->
    <section class="page" id="contactPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Contact Us</h2>
          <p>We're here to help with any questions or concerns about your order or our products.</p>
          
          <h3>Our Address</h3>
          <p>Jwalapur, Haridwar, Uttarakhand - 249401<br>India</p>
          
          <h3>Customer Support Hours</h3>
          <p>Monday to Saturday: 10:00 AM to 7:00 PM IST<br>
          Sunday: Closed</p>
          
          <h3>Email</h3>
          <p>For order-related queries: <a href="mailto:buyzocartshop@gmail.com">buyzocartshop@gmail.com</a></p>

          <h3>Telegram Support</h3>
          <p>For quick assistance: <a href="https://t.me/Buyzocartsupport" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M9.999 15.17 9.95 20c.64 0 .92-.27 1.26-.59l3.02-2.88 6.25 4.55c1.15.63 1.97.3 2.26-1.06L23.95 3.47c.37-1.48-.54-2.06-1.65-1.7L1.62 9.63c-1.45.57-1.43 1.36-.25 1.72l5.91 1.84 13.69-8.65c.65-.4 1.25-.18.76.25"/></svg></a></p>
          
          <h3>Response Time</h3>
          <p>We strive to respond to all emails within <strong>24 business hours</strong>.</p>
          
          <h3>Order Issues</h3>
          <p>When contacting us about an order, please include your order ID for faster resolution.</p>
        </div>
      </div>
    </section>

    <section class="page" id="cancellationPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin" round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Refund & Cancellation Policy</h2>
          <p>At Buyzo, we value our customers and aim to provide a smooth shopping experience.</p>

          <h3>Order Cancellation</h3>
          <p>Orders can be cancelled within <strong>24 hours</strong> of placing them. Once the order is processed/shipped, cancellation requests will not be accepted.</p>

          <h3>Refunds</h3>
          <p>If you cancel your order within the allowed time, the amount will be refunded to your original payment method within <strong>5–7 working days</strong>.</p>

          <h3>Payment Gateway Charges</h3>
          <p>Please note that payment gateway charges (approx <strong>2–3% of the order value</strong>) are non-refundable. For example, if you placed an order of ₹100 and cancelled it, the refund amount will be ₹97–₹98. This deduction is due to Razorpay's non-refundable transaction fee.</p>

          <h3>Contact Us</h3>
  <p>
          For refund or cancellation requests, please contact us at:<br>
          Email: <strong>buyzocartshop@gmail.com</strong><br>
          Telegram: <a href="https://t.me/Buyzocartsupport" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M9.999 15.17 9.95 20c.64 0 .92-.27 1.26-.59l3.02-2.88 6.25 4.55c1.15.63 1.97.3 2.26-1.06L23.95 3.47c.37-1.48-.54-2.06-1.65-1.7L1.62 9.63c-1.45.57-1.43 1.36-.25 1.72l5.91 1.84 13.69-8.65c.65-.4 1.25-.18.76.25"/></svg></a>
          </p>
        </div>
      </div>
    </section>

    <section class="page" id="termsPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Terms & Conditions</h2>
          <p>Welcome to <strong>Buyzo Cart</strong>. By placing an order on our website, you agree to the terms below.</p>
          
          <h3>1. Service Model</h3>
          <p>We operate a <strong>dropshipping</strong> model. Products are sourced from third‑party suppliers and shipped directly to you. Images shown are for representation and minor variations may occur.</p>
          
          <h3>2. Orders & Pricing</h3>
          <p>All prices are in INR and inclusive of applicable taxes unless stated. An order is confirmed only after successful payment authorization. We reserve the right to cancel and refund any order due to stock, pricing, or verification issues.</p>
          
          <h3>3. Delivery</h3>
          <p>Estimated delivery time is displayed at checkout. Delays may occur due to courier logistics or festivals. We are not liable for delays once the order is handed over to the courier.</p>
          
          <h3>4. Customer Responsibilities</h3>
          <p>Please provide accurate contact details and delivery address. Incorrect information may cause delays or non‑delivery.</p>
          
          <h3>5. Prohibited Use</h3>
          <p>Do not misuse the website, attempt unauthorized access, or submit fraudulent orders.</p>
          
          <h3>6. Liability</h3>
          <p>To the maximum extent permitted by law, our liability is limited to the order value paid by you.</p>
          
          <h3>7. Contact</h3>
          <p>For any support, email us at <a href="mailto:buyzocartshop@gmail.com">buyzocartshop@gmail.com</a></p>
        </div>
      </div>
    </section>

    <section class="page" id="shippingPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height:20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Shipping Policy</h2>
          
          <h3>1. Processing Time</h3>
          <p>Orders are processed within <strong>1-2 business days</strong> after payment confirmation. Business days are Monday to Saturday, excluding public holidays.</p>
          
          <h3>2. Shipping Timeline</h3>
          <p>Delivery usually takes 5–10 working days depending on location.</p>
          
          <h3>3. Shipping Methods</h3>
          <ul>
            <li><strong>Standard Shipping</strong>: 5-7 business days (₹50)</li>
            <li><strong>Express Shipping</strong>: 2-4 business days (₹150)</li>
          </ul>
          
          <h3>4. Shipping Areas</h3>
          <p>We currently ship to all major cities and towns across India. For remote locations, additional delivery time may be required.</p>
          
          <h3>5. Order Tracking</h3>
          <p>Once your order is shipped, you will receive a confirmation email with tracking information. You can track your order using the provided tracking number.</p>
          
          <h3>6. Undeliverable Orders</h3>
          <p>If a delivery attempt fails due to incorrect address or recipient unavailable, the package will be returned to us. Additional shipping charges will apply for redelivery.</p>
          
          <h3>7. International Shipping</h3>
          <p>Currently, we only ship within India. International shipping is not available.</p>
        </div>
      </div>
    </section>

    <section class="page" id="privacyPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Privacy Policy</h2>
          <p>At Buyzo Cart, we are committed to protecting your privacy and ensuring the security of your personal information.</p>
          
          <h3>1. Information We Collect</h3>
          <p>We collect information that you provide directly to us, including:</p>
          <ul>
            <li>Name, email address, phone number, and shipping address</li>
            <li>Payment information (processed securely by our payment partners)</li>
            <li>Order history and preferences</li>
          </ul>
          
          <h3>2. How We Use Your Information</h3>
          <p>We use your information to:</p>
          <ul>
            <li>Process and fulfill your orders</li>
            <li>Communicate with you about orders, products, and promotions</li>
            <li>Improve our website and customer experience</li>
            <li>Prevent fraud and enhance security</li>
          </ul>
          
          <h3>3. Information Sharing</h3>
          <p>We do not sell your personal information to third parties. We may share your information with:</p>
          <ul>
            <li>Shipping partners to deliver your orders</li>
            <li>Payment processors to complete transactions</li>
            <li>Service providers who assist our operations</li>
          </ul>
          
          <h3>4. Data Security</h3>
          <p>We implement appropriate security measures to protect your personal information against unauthorized access, alteration, or destruction.</p>
          
          <h3>5. Your Rights</h3>
          <p>You have the right to access, correct, or delete your personal information. You can also opt-out of marketing communications at any time.</p>
          
          <h3>6. Cookies</h3>
          <p>Our website uses cookies to enhance your shopping experience and analyze site traffic. You can adjust your browser settings to refuse cookies.</p>
          
          <h3>7. Policy Updates</h3>
          <p>We may update this policy periodically. The updated version will be posted on our website with the effective date.</p>
          
          <h3>8. Contact Us</h3>
          <p>For privacy-related questions, contact us at <a href="mailto:buyzocartshop@gmail.com">buyzocartshop@gmail.com</a></p>
        </div>
      </div>
    </section>

    <footer>
      <div style="max-width:900px;margin:0 auto;color:var(--muted)">
        <div style="font-weight:700;color:var(--accent);font-size:18px">Buyzo Cart</div>
        
        <!-- About Us Section -->
        <div class="about-us">
          <h3>About Us</h3>
          <p>Buyzo is a dropshipping platform from Haridwar, Uttarakhand. We provide affordable and trendy clothing directly to your doorstep.</p>
        </div>
        
        <div style="font-size:14px;margin-top:16px">We perform dropshipping using third‑party suppliers. This site does not impersonate any marketplace.</div>
        
        <!-- Social Media Links - Updated with official icons -->
        <div class="social-links">
          <a href="https://www.instagram.com/buyzo.cart?igsh=MW5lMmpqcnYwOXduaA==" target="_blank" class="social-icon" title="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2ZM12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm0 1.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7Zm5.25-.75a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5Z"/></svg></a>
          <a href="https://www.facebook.com/share/1ErTUZySbt/" target="_blank" class="social-icon" title="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2v-3h2v-2.3c0-2 1.2-3.2 3-3.2.9 0 1.8.1 1.8.1v2h-1c-1 0-1.3.6-1.3 1.2V12h2.6l-.4 3h-2.2v7A10 10 0 0 0 22 12"/></svg></a>
          <a href="https://t.me/buyzocartshop" target="_blank" class="social-icon" title="Telegram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M9.999 15.17 9.95 20c.64 0 .92-.27 1.26-.59l3.02-2.88 6.25 4.55c1.15.63 1.97.3 2.26-1.06L23.95 3.47c.37-1.48-.54-2.06-1.65-1.7L1.62 9.63c-1.45.57-1.43 1.36-.25 1.72l5.91 1.84 13.69-8.65c.65-.4 1.25-.18.76.25"/></svg></a>
          <a href="https://www.youtube.com/@BuyzoCart" target="_blank" class="social-icon" title="YouTube"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg></a>
        </div>
        
        <div style="margin-top:16px;font-size:14px">
          <a href="#" onclick="showPage('contactPage'); return false;">Contact Us</a> •
          <a href="#" onclick="showPage('cancellationPage'); return false;">Refund & Cancellation Policy</a> •
          <a href="#" onclick="showPage('termsPage'); return false;">Terms & Conditions</a> •
          <a href="#" onclick="showPage('shippingPage'); return false;">Shipping Policy</a> •
          <a href="#" onclick="showPage('privacyPage'); return false;">Privacy Policy</a>
        </div>
      </div>
    </footer>
  </main>

  <!-- Copyright Section -->
  <div class="copyright">
    © 2023 Buyzo Cart. All rights reserved.
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast">
    <div class="toast-icon">✓</div>
    <div id="toast-message"></div>
  </div>

  <!-- NEW: Login/Signup Modal -->
  <div class="modal-overlay" id="authModal">
    <div class="auth-modal">
      <button class="auth-close" id="authModalClose">×</button>
      <h3>Welcome to Buyzo Cart</h3>
      
      <div class="auth-tabs">
        <div class="auth-tab active" data-tab="login">Login</div>
        <div class="auth-tab" data-tab="signup">Sign Up</div>
      </div>
      
      <form class="auth-form active" id="loginForm">
        <div class="auth-form-group">
          <label>Email</label>
          <input type="email" id="loginEmail" placeholder="Enter your email" required>
        </div>
        <div class="auth-form-group">
          <label>Password</label>
          <input type="password" id="loginPassword" placeholder="Enter your password" required>
        </div>
        <div class="forgot-password">
          <a id="forgotPasswordLink">Forgot Password?</a>
        </div>
        <button type="submit" class="btn" style="width:100%">Login</button>
        <div class="error-message" id="loginError"></div>
        <div class="auth-form-footer">
          Don't have an account? <a onclick="switchAuthTab('signup')">Sign up</a>
        </div>
      </form>
      
      <form class="auth-form" id="signupForm">
        <div class="auth-form-group">
          <label>Full Name</label>
          <input type="text" id="signupName" placeholder="Enter your full name" required>
        </div>
        <div class="auth-form-group">
          <label>Email</label>
          <input type="email" id="signupEmail" placeholder="Enter your email" required>
        </div>
        <div class="auth-form-group">
          <label>Password</label>
          <input type="password" id="signupPassword" placeholder="Create a password" required>
        </div>
        <div class="auth-form-group">
          <label>Confirm Password</label>
          <input type="password" id="signupConfirmPassword" placeholder="Confirm your password" required>
        </div>
        <button type="submit" class="btn" style="width:100%">Create Account</button>
        <div class="error-message" id="signupError"></div>
        <div class="auth-form-footer">
          Already have an account? <a onclick="switchAuthTab('login')">Login</a>
        </div>
      </form>
      
      <div class="divider">
        <span>or continue with</span>
      </div>
      
      <button class="google-signin-btn" id="googleSignInBtn">
        <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google">
        Continue with Google
      </button>
    </div>
  </div>

  <!-- NEW: Forgot Password Modal -->
  <div class="modal-overlay" id="forgotPasswordModal">
    <div class="auth-modal">
      <button class="auth-close" id="forgotPasswordClose">×</button>
      <h3>Reset Password</h3>
      
      <div class="auth-form-group">
        <label>Email Address</label>
        <input type="email" id="forgotPasswordEmail" placeholder="Enter your email" required>
      </div>
      
      <button class="btn" style="width:100%" id="sendResetLinkBtn">Send Reset Link</button>
      <div class="error-message" id="forgotPasswordError"></div>
      <div class="auth-form-footer">
        Remember your password? <a onclick="closeForgotPasswordModal(); switchAuthTab('login')">Back to Login</a>
      </div>
    </div>
  </div>

  <!-- NEW: Image Zoom Modal -->
  <div class="modal-overlay zoom-modal" id="imageZoomModal">
    <div class="zoom-content">
      <button class="zoom-close" id="zoomClose">×</button>
      <img src="" alt="Zoomed product image" class="zoom-image" id="zoomedImage">
      <div class="zoom-controls">
        <button class="zoom-btn" id="zoomInBtn">+</button>
        <button class="zoom-btn" id="zoomOutBtn">-</button>
        <button class="zoom-btn" id="zoomResetBtn">⟳</button>
      </div>
    </div>
  </div>

  <!-- NEW: Cancellation Modal - Updated with Cancel and Yes buttons -->
  <div class="modal-overlay" id="cancellationModal">
    <div class="alert-modal">
      <div class="alert-icon">⚠️</div>
      <h3>Cancel Order</h3>
      <p>Are you sure you want to cancel this order? This action cannot be undone.</p>
      
      <div class="alert-modal-buttons">
        <button class="btn secondary" id="cancelOrderNo">No, Keep Order</button>
        <button class="btn error" id="cancelOrderYes">Yes, Cancel Order</button>
      </div>
    </div>
  </div>

  <!-- NEW: Cancel Order Flow Modal -->
  <div class="modal-overlay" id="cancelOrderFlowModal">
    <div class="cancel-confirm-modal">
      <h3>Cancel Order</h3>
      
      <p>Please select a reason for cancellation:</p>
      
      <div class="cancellation-reason" data-reason="changed-mind">
        <input type="radio" name="cancel-reason" id="reason-changed-mind">
        <label for="reason-changed-mind">Changed my mind</label>
      </div>
      
      <div class="cancellation-reason" data-reason="found-better-price">
        <input type="radio" name="cancel-reason" id="reason-found-better-price">
        <label for="reason-found-better-price">Found better price elsewhere</label>
      </div>
      
      <div class="cancellation-reason" data-reason="shipping-delay">
        <input type="radio" name="cancel-reason" id="reason-shipping-delay">
        <label for="reason-shipping-delay">Shipping takes too long</label>
      </div>
      
      <div class="cancellation-reason" data-reason="ordered-by-mistake">
        <input type="radio" name="cancel-reason" id="reason-ordered-by-mistake">
        <label for="reason-ordered-by-mistake">Ordered by mistake</label>
      </div>
      
      <div class="cancellation-reason" data-reason="other">
        <input type="radio" name="cancel-reason" id="reason-other">
        <label for="reason-other">Other reason</label>
      </div>
      
      <div class="payment-charge-note">
        <strong>Note:</strong> Payment gateway charges (approx 2–3%) are non-refundable as per our policy.
      </div>
      
      <div class="refund-calculation">
        <p><strong>Refund Calculation:</strong></p>
        <p>Order Amount: ₹<span id="refundOrderAmount">0</span></p>
        <p>Payment Gateway Charges: ₹<span id="refundGatewayCharges">0</span></p>
        <p><strong>Refund Amount: ₹<span id="refundTotalAmount">0</span></strong></p>
      </div>
      
      <div class="cancel-confirm-actions">
        <button class="btn secondary" id="cancelOrderFlowCancel">Cancel</button>
        <button class="btn error" id="cancelOrderFlowConfirm">Confirm Cancellation</button>
      </div>
    </div>
  </div>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB5dS8iLf0eH8kS5u9z3v7gN6X1vL2m3n4",
      authDomain: "buyzo-cart.firebaseapp.com",
      databaseURL: "https://buyzo-cart-default-rtdb.firebaseio.com",
      projectId: "buyzo-cart",
      storageBucket: "buyzo-cart.appspot.com",
      messagingSenderId: "123456789012",
      appId: "1:123456789012:web:abcdef123456"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    const rdb = firebase.database();

    // Global Variables
    let currentUser = null;
    let products = [];
    let categories = [];
    let ads = [];
    let currentProductId = null;
    let selectedSize = "S";
    let selectedQuantity = 1;
    let currentOrder = null;
    let userAddresses = [];
    let recentlyViewed = [];

    // Initialize the app
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
      setupEventListeners();
    });

    // Initialize App
    function initializeApp() {
      // Load products from Firebase
      loadProducts();
      
      // Load categories from Firebase
      loadCategories();
      
      // Load ads from Firebase
      loadAds();
      
      // Check if user is logged in
      checkAuthState();
      
      // Setup rotating hero messages
      setupHeroMessages();
      
      // Load recently viewed products from localStorage
      loadRecentlyViewed();
    }

    // Setup Event Listeners
    function setupEventListeners() {
      // Mobile menu
      document.getElementById('menuIcon').addEventListener('click', openMenu);
      document.getElementById('menuClose').addEventListener('click', closeMenu);
      document.getElementById('menuOverlay').addEventListener('click', closeMenu);
      
      // Product search
      document.getElementById('searchInput').addEventListener('input', filterProducts);
      document.getElementById('homeSearchInput').addEventListener('input', filterHomeProducts);
      
      // Price filter
      document.getElementById('applyPriceFilter').addEventListener('click', applyPriceFilter);
      document.getElementById('resetPriceFilter').addEventListener('click', resetPriceFilter);
      
      // Navigation buttons
      document.getElementById('backToProducts').addEventListener('click', () => showPage('productsPage'));
      document.getElementById('toUserInfo').addEventListener('click', validateSizeAndContinue);
      document.getElementById('editOrder').addEventListener('click', () => showPage('orderPage'));
      document.getElementById('toPayment').addEventListener('click', validateUserInfo);
      document.getElementById('payBack').addEventListener('click', () => showPage('userPage'));
      document.getElementById('confirmOrder').addEventListener('click', confirmOrder);
      document.getElementById('goHome').addEventListener('click', () => showPage('homePage'));
      document.getElementById('viewOrders').addEventListener('click', () => { showMyOrders(); showPage('myOrdersPage'); });
      
      // Policy page links
      document.getElementById('openContactTop').addEventListener('click', () => showPage('contactPage'));
      document.getElementById('openMyOrdersTop').addEventListener('click', () => { showMyOrders(); showPage('myOrdersPage'); });
      document.getElementById('openProfileTop').addEventListener('click', showProfileOrLogin);
      
      // Login/Signup
      document.getElementById('openLoginTop').addEventListener('click', showLoginModal);
      document.getElementById('authModalClose').addEventListener('click', closeAuthModal);
      document.getElementById('forgotPasswordClose').addEventListener('click', closeForgotPasswordModal);
      document.getElementById('forgotPasswordLink').addEventListener('click', showForgotPasswordModal);
      document.getElementById('sendResetLinkBtn').addEventListener('click', sendPasswordReset);
      
      // Auth forms
      document.getElementById('loginForm').addEventListener('submit', loginUser);
      document.getElementById('signupForm').addEventListener('submit', signupUser);
      
      // Google sign in
      document.getElementById('googleSignInBtn').addEventListener('click', signInWithGoogle);
      
      // Auth tabs
      document.querySelectorAll('.auth-tab').forEach(tab => {
        tab.addEventListener('click', () => switchAuthTab(tab.dataset.tab));
      });
      
      // User profile
      document.getElementById('saveProfileBtn').addEventListener('click', saveProfile);
      document.getElementById('addAddressBtn').addEventListener('click', addNewAddress);
      
      // Image zoom
      document.getElementById('zoomClose').addEventListener('click', closeImageZoom);
      document.getElementById('zoomInBtn').addEventListener('click', zoomIn);
      document.getElementById('zoomOutBtn').addEventListener('click', zoomOut);
      document.getElementById('zoomResetBtn').addEventListener('click', resetZoom);
      
      // Newsletter
      document.getElementById('subscribeBtn').addEventListener('click', subscribeNewsletter);
      
      // Cancellation flow
      document.getElementById('cancelOrderNo').addEventListener('click', closeCancellationModal);
      document.getElementById('cancelOrderYes').addEventListener('click', showCancelOrderFlow);
      document.getElementById('cancelOrderFlowCancel').addEventListener('click', closeCancelOrderFlowModal);
      document.getElementById('cancelOrderFlowConfirm').addEventListener('click', confirmOrderCancellation);
      
      // Size selection
      document.querySelectorAll('.size-option').forEach(option => {
        option.addEventListener('click', function() {
          selectSize(this);
        });
      });
      
      // Quantity controls
      document.querySelector('.qty-minus').addEventListener('click', decreaseQuantity);
      document.querySelector('.qty-plus').addEventListener('click', increaseQuantity);
      
      // Ad slider controls
      document.querySelector('.ad-slider-arrow.prev').addEventListener('click', () => navigateAdSlider('prev'));
      document.querySelector('.ad-slider-arrow.next').addEventListener('click', () => navigateAdSlider('next'));
      
      // Ad slider dots
      document.getElementById('adSliderNav').addEventListener('click', function(e) {
        if (e.target.classList.contains('ad-slider-dot')) {
          const index = Array.from(this.children).indexOf(e.target);
          goToAdSlide(index);
        }
      });
    }

    // ===== FIREBASE DATA LOADING =====

    // Load products from Firebase
    function loadProducts() {
      db.collection("products").get()
        .then((querySnapshot) => {
          products = [];
          querySnapshot.forEach((doc) => {
            const product = doc.data();
            product.id = doc.id;
            products.push(product);
          });
          renderProducts();
          renderProductSlider();
        })
        .catch((error) => {
          console.error("Error loading products: ", error);
          // Fallback to demo products if Firebase fails
          loadDemoProducts();
        });
    }

    // Load demo products (fallback)
    function loadDemoProducts() {
      products = [
        {
          id: "1",
          title: "Wireless Earbuds",
          price: "₹1,299",
          desc: "Premium sound quality, 20hr battery",
          images: ["https://images.unsplash.com/photo-1590658165737-15a047b8b5e3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8ZWFyYnVkc3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&w=500&q=60"],
          category: "electronics"
        },
        {
          id: "2",
          title: "Casual T-Shirt",
          price: "₹599",
          desc: "100% Cotton, Regular Fit",
          images: ["https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8dHNoaXJ0fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"],
          category: "clothing"
        },
        {
          id: "3",
          title: "Running Shoes",
          price: "₹2,499",
          desc: "Lightweight, Cushioned Sole",
          images: ["https://images.unsplash.com/photo-1542291026-7eec264c27ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8c2hvZXN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"],
          category: "footwear"
        },
        {
          id: "4",
          title: "Smart Watch",
          price: "₹3,999",
          desc: "Fitness tracker, Heart rate monitor",
          images: ["https://images.unsplash.com/photo-1523275335684-37898b6baf30?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8d2F0Y2h8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"],
          category: "electronics"
        }
      ];
      renderProducts();
      renderProductSlider();
    }

    // Load categories from Firebase
    function loadCategories() {
      db.collection("categories").get()
        .then((querySnapshot) => {
          categories = [];
          querySnapshot.forEach((doc) => {
            const category = doc.data();
            category.id = doc.id;
            categories.push(category);
          });
          renderCategories();
          renderCategoryCircles();
        })
        .catch((error) => {
          console.error("Error loading categories: ", error);
        });
    }

    // Load ads from Firebase
    function loadAds() {
      db.collection("ads").where("active", "==", true).get()
        .then((querySnapshot) => {
          ads = [];
          querySnapshot.forEach((doc) => {
            const ad = doc.data();
            ad.id = doc.id;
            ads.push(ad);
          });
          
          if (ads.length > 0) {
            document.getElementById('adBannerSection').style.display = 'block';
            renderAdSlider();
          }
        })
        .catch((error) => {
          console.error("Error loading ads: ", error);
        });
    }

    // ===== RENDERING FUNCTIONS =====

    // Render products in grid
    function renderProducts() {
      const productGrid = document.getElementById('productGrid');
      const homeProductGrid = document.getElementById('homeProductGrid');
      
      if (!productGrid || !homeProductGrid) return;
      
      productGrid.innerHTML = '';
      homeProductGrid.innerHTML = '';
      
      products.forEach(product => {
        const productCard = createProductCard(product);
        productGrid.appendChild(productCard.cloneNode(true));
        homeProductGrid.appendChild(productCard);
      });
    }

    // Create product card element
    function createProductCard(product) {
      const card = document.createElement('div');
      card.className = 'card';
      card.setAttribute('data-id', product.id);
      card.setAttribute('data-category', product.category || '');
      
      // Create image slider container
      const imgContainer = document.createElement('div');
      imgContainer.className = 'product-img-slider-container';
      
      const imgSlider = document.createElement('div');
      imgSlider.className = 'product-img-slider';
      imgSlider.style.backgroundImage = `url('${product.images && product.images.length > 0 ? product.images[0] : 'https://via.placeholder.com/300x200'}')`;
      
      // Add navigation controls if multiple images
      if (product.images && product.images.length > 1) {
        const prevBtn = document.createElement('button');
        prevBtn.className = 'product-card-control prev';
        prevBtn.innerHTML = '&#10094;';
        prevBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          navigateProductImage(card, 'prev');
        });
        
        const nextBtn = document.createElement('button');
        nextBtn.className = 'product-card-control next';
        nextBtn.innerHTML = '&#10095;';
        nextBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          navigateProductImage(card, 'next');
        });
        
        const dotsContainer = document.createElement('div');
        dotsContainer.className = 'product-card-dots';
        
        product.images.forEach((_, index) => {
          const dot = document.createElement('div');
          dot.className = `product-card-dot ${index === 0 ? 'active' : ''}`;
          dot.addEventListener('click', (e) => {
            e.stopPropagation();
            goToProductImage(card, index);
          });
          dotsContainer.appendChild(dot);
        });
        
        imgContainer.appendChild(prevBtn);
        imgContainer.appendChild(nextBtn);
        imgContainer.appendChild(dotsContainer);
        
        // Store current image index
        card.setAttribute('data-current-image', '0');
      }
      
      imgContainer.appendChild(imgSlider);
      card.appendChild(imgContainer);
      
      const cardBody = document.createElement('div');
      cardBody.className = 'card-body';
      
      const title = document.createElement('div');
      title.className = 'title';
      title.textContent = product.title || 'Product';
      
      const price = document.createElement('div');
      price.className = 'price';
      price.textContent = product.price || '₹0';
      
      const badge = document.createElement('div');
      badge.className = 'badge';
      badge.textContent = product.desc || 'Product description';
      
      // NEW: Wishlist button
      const wishlistBtn = document.createElement('button');
      wishlistBtn.className = 'wishlist-btn';
      wishlistBtn.innerHTML = '❤️';
      wishlistBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleWishlist(product.id, wishlistBtn);
      });
      
      // Check if product is in wishlist
      if (currentUser) {
        const wishlist = JSON.parse(localStorage.getItem(`wishlist_${currentUser.uid}`) || '[]');
        if (wishlist.includes(product.id)) {
          wishlistBtn.classList.add('active');
        }
      }
      
      cardBody.appendChild(title);
      cardBody.appendChild(price);
      cardBody.appendChild(badge);
      cardBody.appendChild(wishlistBtn);
      
      card.appendChild(cardBody);
      
      // Add click event to view product details
      card.addEventListener('click', () => {
        viewProductDetails(product.id);
        addToRecentlyViewed(product.id);
      });
      
      return card;
    }

    // Render product slider
    function renderProductSlider() {
      const sliderTrack = document.getElementById('productSlider');
      if (!sliderTrack) return;
      
      sliderTrack.innerHTML = '';
      
      // Get trending products (first 6 products)
      const trendingProducts = products.slice(0, 6);
      
      trendingProducts.forEach(product => {
        const sliderItem = document.createElement('div');
        sliderItem.className = 'slider-item';
        sliderItem.setAttribute('data-id', product.id);
        
        const imgDiv = document.createElement('div');
        imgDiv.className = 'slider-item-img';
        imgDiv.style.backgroundImage = `url('${product.images && product.images.length > 0 ? product.images[0] : 'https://via.placeholder.com/200x150'}')`;
        
        const itemBody = document.createElement('div');
        itemBody.className = 'slider-item-body';
        
        const title = document.createElement('div');
        title.className = 'slider-item-title';
        title.textContent = product.title || 'Product';
        
        const price = document.createElement('div');
        price.className = 'slider-item-price';
        price.textContent = product.price || '₹0';
        
        itemBody.appendChild(title);
        itemBody.appendChild(price);
        
        sliderItem.appendChild(imgDiv);
        sliderItem.appendChild(itemBody);
        
        sliderItem.addEventListener('click', () => {
          viewProductDetails(product.id);
          addToRecentlyViewed(product.id);
        });
        
        sliderTrack.appendChild(sliderItem);
      });
    }

    // Render categories
    function renderCategories() {
      const categoriesContainer = document.getElementById('categoriesContainer');
      if (!categoriesContainer) return;
      
      categoriesContainer.innerHTML = '';
      
      // Add "All" category
      const allCategory = document.createElement('div');
      allCategory.className = 'category-pill active';
      allCategory.textContent = 'All';
      allCategory.addEventListener('click', () => {
        document.querySelectorAll('.category-pill').forEach(pill => pill.classList.remove('active'));
        allCategory.classList.add('active');
        filterProductsByCategory('all');
      });
      
      categoriesContainer.appendChild(allCategory);
      
      // Add other categories
      categories.forEach(category => {
        const categoryPill = document.createElement('div');
        categoryPill.className = 'category-pill';
        categoryPill.textContent = category.name;
        categoryPill.addEventListener('click', () => {
          document.querySelectorAll('.category-pill').forEach(pill => pill.classList.remove('active'));
          categoryPill.classList.add('active');
          filterProductsByCategory(category.id);
        });
        
        categoriesContainer.appendChild(categoryPill);
      });
    }

    // Render category circles
    function renderCategoryCircles() {
      const categoryCircles = document.getElementById('categoryCircles');
      if (!categoryCircles) return;
      
      categoryCircles.innerHTML = '';
      
      categories.forEach(category => {
        const categoryCircle = document.createElement('div');
        categoryCircle.className = 'category-circle';
        
        const categoryIcon = document.createElement('div');
        categoryIcon.className = 'category-icon';
        categoryIcon.style.backgroundImage = `url('${category.image || 'https://via.placeholder.com/70x70'}')`;
        
        const categoryName = document.createElement('div');
        categoryName.className = 'category-name';
        categoryName.textContent = category.name;
        
        categoryCircle.appendChild(categoryIcon);
        categoryCircle.appendChild(categoryName);
        
        categoryCircle.addEventListener('click', () => {
          document.querySelectorAll('.category-pill').forEach(pill => pill.classList.remove('active'));
          const categoryPill = Array.from(document.querySelectorAll('.category-pill')).find(pill => 
            pill.textContent === category.name
          );
          if (categoryPill) {
            categoryPill.classList.add('active');
            filterProductsByCategory(category.id);
            showPage('productsPage');
          }
        });
        
        categoryCircles.appendChild(categoryCircle);
      });
    }

    // Render ad slider
    function renderAdSlider() {
      const adSliderTrack = document.getElementById('adSliderTrack');
      const adSliderNav = document.getElementById('adSliderNav');
      
      if (!adSliderTrack || !adSliderNav) return;
      
      adSliderTrack.innerHTML = '';
      adSliderNav.innerHTML = '';
      
      ads.forEach((ad, index) => {
        const adSlide = document.createElement('div');
        adSlide.className = 'ad-slide';
        adSlide.style.backgroundImage = `url('${ad.image}')`;
        adSlide.addEventListener('click', () => {
          if (ad.link) {
            window.open(ad.link, '_blank');
          }
        });
        
        adSliderTrack.appendChild(adSlide);
        
        const dot = document.createElement('div');
        dot.className = `ad-slider-dot ${index === 0 ? 'active' : ''}`;
        adSliderNav.appendChild(dot);
      });
      
      // Start auto slide
      startAdAutoSlide();
    }

    // ===== PRODUCT NAVIGATION =====

    // Navigate product images in cards
    function navigateProductImage(card, direction) {
      const productId = card.getAttribute('data-id');
      const product = products.find(p => p.id === productId);
      if (!product || !product.images || product.images.length <= 1) return;
      
      let currentIndex = parseInt(card.getAttribute('data-current-image') || 0);
      const totalImages = product.images.length;
      
      if (direction === 'next') {
        currentIndex = (currentIndex + 1) % totalImages;
      } else {
        currentIndex = (currentIndex - 1 + totalImages) % totalImages;
      }
      
      card.setAttribute('data-current-image', currentIndex.toString());
      
      const imgSlider = card.querySelector('.product-img-slider');
      imgSlider.style.backgroundImage = `url('${product.images[currentIndex]}')`;
      
      // Update dots
      const dots = card.querySelectorAll('.product-card-dot');
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentIndex);
      });
    }

    // Go to specific product image
    function goToProductImage(card, index) {
      const productId = card.getAttribute('data-id');
      const product = products.find(p => p.id === productId);
      if (!product || !product.images || product.images.length <= 1) return;
      
      card.setAttribute('data-current-image', index.toString());
      
      const imgSlider = card.querySelector('.product-img-slider');
      imgSlider.style.backgroundImage = `url('${product.images[index]}')`;
      
      // Update dots
      const dots = card.querySelectorAll('.product-card-dot');
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
    }

    // Navigate ad slider
    function navigateAdSlider(direction) {
      const adSliderTrack = document.getElementById('adSliderTrack');
      const dots = document.querySelectorAll('.ad-slider-dot');
      const totalSlides = ads.length;
      
      let currentIndex = Array.from(dots).findIndex(dot => dot.classList.contains('active'));
      if (currentIndex === -1) currentIndex = 0;
      
      if (direction === 'next') {
        currentIndex = (currentIndex + 1) % totalSlides;
      } else {
        currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
      }
      
      goToAdSlide(currentIndex);
    }

    // Go to specific ad slide
    function goToAdSlide(index) {
      const adSliderTrack = document.getElementById('adSliderTrack');
      const dots = document.querySelectorAll('.ad-slider-dot');
      
      adSliderTrack.style.transform = `translateX(-${index * 100}%)`;
      
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
    }

    // Start auto slide for ads
    function startAdAutoSlide() {
      setInterval(() => {
        navigateAdSlider('next');
      }, 5000); // Change slide every 5 seconds
    }

    // ===== PRODUCT DETAILS =====

    // View product details
    function viewProductDetails(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;
      
      currentProductId = productId;
      
      // Update breadcrumb
      document.getElementById('breadcrumbProductName').textContent = product.title;
      
      // Update main image
      const detailMainImage = document.getElementById('detailMainImage');
      if (product.images && product.images.length > 0) {
        detailMainImage.style.backgroundImage = `url('${product.images[0]}')`;
        
        // Add zoom data
        detailMainImage.setAttribute('data-zoom-image', product.images[0]);
      }
      
      // Update thumbnails
      const detailThumbnails = document.getElementById('detailThumbnails');
      detailThumbnails.innerHTML = '';
      
      if (product.images && product.images.length > 1) {
        product.images.forEach((image, index) => {
          const thumbnail = document.createElement('div');
          thumbnail.className = `product-detail-thumbnail ${index === 0 ? 'active' : ''}`;
          thumbnail.style.backgroundImage = `url('${image}')`;
          thumbnail.addEventListener('click', () => {
            changeDetailImage(image, index);
          });
          detailThumbnails.appendChild(thumbnail);
        });
        
        // Show carousel controls
        document.querySelectorAll('.detail-carousel-control').forEach(control => {
          control.style.display = 'flex';
        });
        document.getElementById('detailCarouselDots').style.display = 'flex';
        
        // Setup carousel controls
        setupDetailCarousel(product.images);
      } else {
        // Hide carousel controls if only one image
        document.querySelectorAll('.detail-carousel-control').forEach(control => {
          control.style.display = 'none';
        });
        document.getElementById('detailCarouselDots').style.display = 'none';
      }
      
      // Update product info
      document.getElementById('detailTitle').textContent = product.title || 'Product';
      document.getElementById('detailPrice').textContent = product.price || '₹0';
      document.getElementById('detailDesc').textContent = product.desc || 'Product description';
      document.getElementById('detailFullDesc').textContent = product.fullDesc || product.desc || 'No description available.';
      
      // Update product SKU
      document.getElementById('detailSku').textContent = `SKU: ${product.sku || product.id}`;
      
      // Update stock status
      const stockStatus = document.getElementById('detailStockStatus');
      if (product.stock > 10) {
        stockStatus.textContent = 'In Stock';
        stockStatus.className = 'stock-status in-stock';
      } else if (product.stock > 0) {
        stockStatus.textContent = 'Low Stock';
        stockStatus.className = 'stock-status low-stock';
      } else {
        stockStatus.textContent = 'Out of Stock';
        stockStatus.className = 'stock-status out-of-stock';
      }
      
      // Update product meta
      const detailMeta = document.getElementById('detailMeta');
      detailMeta.innerHTML = `
        <p><strong>Category:</strong> ${getCategoryName(product.category)}</p>
        <p><strong>Material:</strong> ${product.material || 'Not specified'}</p>
        <p><strong>Care Instructions:</strong> ${product.care || 'Follow standard care instructions'}</p>
      `;
      
      // Update wishlist button
      const wishlistBtn = document.getElementById('detailWishlistBtn');
      if (currentUser) {
        const wishlist = JSON.parse(localStorage.getItem(`wishlist_${currentUser.uid}`) || '[]');
        if (wishlist.includes(productId)) {
          wishlistBtn.textContent = 'Remove from Wishlist';
          wishlistBtn.classList.add('active');
        } else {
          wishlistBtn.textContent = 'Add to Wishlist';
          wishlistBtn.classList.remove('active');
        }
      } else {
        wishlistBtn.textContent = 'Add to Wishlist';
        wishlistBtn.classList.remove('active');
      }
      
      // Setup order button
      document.getElementById('detailOrderBtn').onclick = () => {
        if (!currentUser) {
          showToast('Please login to place an order', 'error');
          showLoginModal();
          return;
        }
        
        if (product.stock <= 0) {
          showToast('This product is out of stock', 'error');
          return;
        }
        
        selectProduct(productId);
        showPage('orderPage');
      };
      
      // Setup wishlist button
      wishlistBtn.onclick = () => {
        if (!currentUser) {
          showToast('Please login to use wishlist', 'error');
          showLoginModal();
          return;
        }
        
        toggleWishlist(productId, wishlistBtn);
      };
      
      // Load similar products
      loadSimilarProducts(product.category, productId);
      
      // Show product detail page
      showPage('productDetailPage');
    }

    // Change detail image
    function changeDetailImage(imageUrl, index) {
      const detailMainImage = document.getElementById('detailMainImage');
      detailMainImage.style.backgroundImage = `url('${imageUrl}')`;
      detailMainImage.setAttribute('data-zoom-image', imageUrl);
      
      // Update active thumbnail
      document.querySelectorAll('.product-detail-thumbnail').forEach((thumb, i) => {
        thumb.classList.toggle('active', i === index);
      });
      
      // Update carousel dots
      document.querySelectorAll('.detail-carousel-dot').forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
    }

    // Setup detail carousel
    function setupDetailCarousel(images) {
      const prevBtn = document.querySelector('.detail-carousel-control.prev');
      const nextBtn = document.querySelector('.detail-carousel-control.next');
      const dotsContainer = document.getElementById('detailCarouselDots');
      
      dotsContainer.innerHTML = '';
      
      images.forEach((_, index) => {
        const dot = document.createElement('div');
        dot.className = `detail-carousel-dot ${index === 0 ? 'active' : ''}`;
        dot.addEventListener('click', () => {
          changeDetailImage(images[index], index);
        });
        dotsContainer.appendChild(dot);
      });
      
      let currentIndex = 0;
      
      prevBtn.onclick = () => {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        changeDetailImage(images[currentIndex], currentIndex);
      };
      
      nextBtn.onclick = () => {
        currentIndex = (currentIndex + 1) % images.length;
        changeDetailImage(images[currentIndex], currentIndex);
      };
    }

    // Load similar products
    function loadSimilarProducts(category, excludeProductId) {
      const similarProducts = products.filter(p => 
        p.category === category && p.id !== excludeProductId
      ).slice(0, 6);
      
      const similarProductsSlider = document.getElementById('similarProductsSlider');
      similarProductsSlider.innerHTML = '';
      
      similarProducts.forEach(product => {
        const sliderItem = document.createElement('div');
        sliderItem.className = 'slider-item';
        sliderItem.setAttribute('data-id', product.id);
        
        const imgDiv = document.createElement('div');
        imgDiv.className = 'slider-item-img';
        imgDiv.style.backgroundImage = `url('${product.images && product.images.length > 0 ? product.images[0] : 'https://via.placeholder.com/200x150'}')`;
        
        const itemBody = document.createElement('div');
        itemBody.className = 'slider-item-body';
        
        const title = document.createElement('div');
        title.className = 'slider-item-title';
        title.textContent = product.title || 'Product';
        
        const price = document.createElement('div');
        price.className = 'slider-item-price';
        price.textContent = product.price || '₹0';
        
        itemBody.appendChild(title);
        itemBody.appendChild(price);
        
        sliderItem.appendChild(imgDiv);
        sliderItem.appendChild(itemBody);
        
        sliderItem.addEventListener('click', () => {
          viewProductDetails(product.id);
          addToRecentlyViewed(product.id);
        });
        
        similarProductsSlider.appendChild(sliderItem);
      });
    }

    // Get category name by ID
    function getCategoryName(categoryId) {
      const category = categories.find(c => c.id === categoryId);
      return category ? category.name : 'Uncategorized';
    }

    // ===== WISHLIST FUNCTIONALITY =====

    // Toggle wishlist
    function toggleWishlist(productId, button) {
      if (!currentUser) {
        showToast('Please login to use wishlist', 'error');
        showLoginModal();
        return;
      }
      
      const wishlist = JSON.parse(localStorage.getItem(`wishlist_${currentUser.uid}`) || '[]');
      const isInWishlist = wishlist.includes(productId);
      
      if (isInWishlist) {
        // Remove from wishlist
        const index = wishlist.indexOf(productId);
        wishlist.splice(index, 1);
        button.classList.remove('active');
        
        if (button.id === 'detailWishlistBtn') {
          button.textContent = 'Add to Wishlist';
        }
        
        showToast('Removed from wishlist');
      } else {
        // Add to wishlist
        wishlist.push(productId);
        button.classList.add('active');
        
        if (button.id === 'detailWishlistBtn') {
          button.textContent = 'Remove from Wishlist';
        }
        
        showToast('Added to wishlist');
      }
      
      localStorage.setItem(`wishlist_${currentUser.uid}`, JSON.stringify(wishlist));
      
      // Update wishlist page if open
      if (document.getElementById('wishlistPage').classList.contains('active')) {
        loadWishlist();
      }
    }

    // Load wishlist
    function loadWishlist() {
      if (!currentUser) {
        document.getElementById('noWishlist').style.display = 'block';
        document.getElementById('wishlistGrid').style.display = 'none';
        return;
      }
      
      const wishlist = JSON.parse(localStorage.getItem(`wishlist_${currentUser.uid}`) || '[]');
      const wishlistGrid = document.getElementById('wishlistGrid');
      const noWishlist = document.getElementById('noWishlist');
      
      if (wishlist.length === 0) {
        wishlistGrid.style.display = 'none';
        noWishlist.style.display = 'block';
        return;
      }
      
      wishlistGrid.style.display = 'grid';
      noWishlist.style.display = 'none';
      wishlistGrid.innerHTML = '';
      
      wishlist.forEach(productId => {
        const product = products.find(p => p.id === productId);
        if (product) {
          const productCard = createProductCard(product);
          wishlistGrid.appendChild(productCard);
        }
      });
    }

    // ===== RECENTLY VIEWED =====

    // Add to recently viewed
    function addToRecentlyViewed(productId) {
      if (!currentUser) return;
      
      let recentlyViewed = JSON.parse(localStorage.getItem(`recentlyViewed_${currentUser.uid}`) || '[]');
      
      // Remove if already exists
      const index = recentlyViewed.indexOf(productId);
      if (index !== -1) {
        recentlyViewed.splice(index, 1);
      }
      
      // Add to beginning
      recentlyViewed.unshift(productId);
      
      // Keep only last 10 items
      if (recentlyViewed.length > 10) {
        recentlyViewed = recentlyViewed.slice(0, 10);
      }
      
      localStorage.setItem(`recentlyViewed_${currentUser.uid}`, JSON.stringify(recentlyViewed));
      
      // Update recently viewed section
      loadRecentlyViewed();
    }

    // Load recently viewed
    function loadRecentlyViewed() {
      if (!currentUser) {
        document.getElementById('recentlyViewedSection').style.display = 'none';
        return;
      }
      
      const recentlyViewed = JSON.parse(localStorage.getItem(`recentlyViewed_${currentUser.uid}`) || '[]');
      const recentlyViewedSlider = document.getElementById('recentlyViewedSlider');
      const recentlyViewedSection = document.getElementById('recentlyViewedSection');
      
      if (recentlyViewed.length === 0) {
        recentlyViewedSection.style.display = 'none';
        return;
      }
      
      recentlyViewedSection.style.display = 'block';
      recentlyViewedSlider.innerHTML = '';
      
      recentlyViewed.forEach(productId => {
        const product = products.find(p => p.id === productId);
        if (product) {
          const sliderItem = document.createElement('div');
          sliderItem.className = 'slider-item';
          sliderItem.setAttribute('data-id', product.id);
          
          const imgDiv = document.createElement('div');
          imgDiv.className = 'slider-item-img';
          imgDiv.style.backgroundImage = `url('${product.images && product.images.length > 0 ? product.images[0] : 'https://via.placeholder.com/200x150'}')`;
          
          const itemBody = document.createElement('div');
          itemBody.className = 'slider-item-body';
          
          const title = document.createElement('div');
          title.className = 'slider-item-title';
          title.textContent = product.title || 'Product';
          
          const price = document.createElement('div');
          price.className = 'slider-item-price';
          price.textContent = product.price || '₹0';
          
          itemBody.appendChild(title);
          itemBody.appendChild(price);
          
          sliderItem.appendChild(imgDiv);
          sliderItem.appendChild(itemBody);
          
          sliderItem.addEventListener('click', () => {
            viewProductDetails(product.id);
          });
          
          recentlyViewedSlider.appendChild(sliderItem);
        }
      });
    }

    // ===== PRODUCT FILTERING =====

    // Filter products by category
    function filterProductsByCategory(categoryId) {
      const productGrid = document.getElementById('productGrid');
      const allProducts = productGrid.querySelectorAll('.card');
      
      allProducts.forEach(card => {
        if (categoryId === 'all' || card.getAttribute('data-category') === categoryId) {
          card.style.display = 'flex';
        } else {
          card.style.display = 'none';
        }
      });
    }

    // Filter products by search
    function filterProducts() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const productGrid = document.getElementById('productGrid');
      const allProducts = productGrid.querySelectorAll('.card');
      
      allProducts.forEach(card => {
        const title = card.querySelector('.title').textContent.toLowerCase();
        const desc = card.querySelector('.badge').textContent.toLowerCase();
        
        if (title.includes(searchTerm) || desc.includes(searchTerm)) {
          card.style.display = 'flex';
        } else {
          card.style.display = 'none';
        }
      });
    }

    // Filter home products by search
    function filterHomeProducts() {
      const searchTerm = document.getElementById('homeSearchInput').value.toLowerCase();
      const searchResults = document.getElementById('homeSearchResults');
      const homeProductGrid = document.getElementById('homeProductGrid');
      
      if (searchTerm.length === 0) {
        searchResults.style.display = 'none';
        homeProductGrid.style.display = 'grid';
        return;
      }
      
      searchResults.style.display = 'grid';
      homeProductGrid.style.display = 'none';
      searchResults.innerHTML = '';
      
      const filteredProducts = products.filter(product => {
        const title = product.title.toLowerCase();
        const desc = product.desc.toLowerCase();
        return title.includes(searchTerm) || desc.includes(searchTerm);
      });
      
      filteredProducts.forEach(product => {
        const productCard = createProductCard(product);
        searchResults.appendChild(productCard);
      });
    }

    // Apply price filter
    function applyPriceFilter() {
      const minPrice = parseInt(document.getElementById('minPrice').value) || 0;
      const maxPrice = parseInt(document.getElementById('maxPrice').value) || 5000;
      
      const productGrid = document.getElementById('productGrid');
      const allProducts = productGrid.querySelectorAll('.card');
      
      allProducts.forEach(card => {
        const priceText = card.querySelector('.price').textContent;
        const price = parseInt(priceText.replace(/[^0-9]/g, '')) || 0;
        
        if (price >= minPrice && price <= maxPrice) {
          card.style.display = 'flex';
        } else {
          card.style.display = 'none';
        }
      });
    }

    // Reset price filter
    function resetPriceFilter() {
      document.getElementById('minPrice').value = '';
      document.getElementById('maxPrice').value = '';
      document.getElementById('minPriceSlider').value = 0;
      document.getElementById('maxPriceSlider').value = 5000;
      document.getElementById('minPriceValue').textContent = '₹0';
      document.getElementById('maxPriceValue').textContent = '₹5000';
      
      const productGrid = document.getElementById('productGrid');
      const allProducts = productGrid.querySelectorAll('.card');
      
      allProducts.forEach(card => {
        card.style.display = 'flex';
      });
    }

    // ===== ORDER MANAGEMENT =====

    // Select product for ordering
    function selectProduct(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;
      
      currentProductId = productId;
      
      // Update order page
      document.getElementById('spTitle').textContent = product.title || 'Product';
      document.getElementById('spPrice').textContent = product.price || '₹0';
      document.getElementById('spDesc').textContent = product.desc || 'Product description';
      document.getElementById('spFullDesc').textContent = product.fullDesc || product.desc || 'No description available.';
      
      // Update gallery
      const galleryMain = document.getElementById('galleryMain');
      galleryMain.innerHTML = '';
      
      if (product.images && product.images.length > 0) {
        galleryMain.style.backgroundImage = `url('${product.images[0]}')`;
        
        // Add carousel controls if multiple images
        if (product.images.length > 1) {
          const prevBtn = document.createElement('button');
          prevBtn.className = 'carousel-control prev';
          prevBtn.innerHTML = '&#10094;';
          prevBtn.addEventListener('click', () => navigateOrderImage('prev'));
          
          const nextBtn = document.createElement('button');
          nextBtn.className = 'carousel-control next';
          nextBtn.innerHTML = '&#10095;';
          nextBtn.addEventListener('click', () => navigateOrderImage('next'));
          
          const dotsContainer = document.createElement('div');
          dotsContainer.className = 'carousel-dots';
          
          product.images.forEach((_, index) => {
            const dot = document.createElement('div');
            dot.className = `carousel-dot ${index === 0 ? 'active' : ''}`;
            dot.addEventListener('click', () => goToOrderImage(index));
            dotsContainer.appendChild(dot);
          });
          
          galleryMain.appendChild(prevBtn);
          galleryMain.appendChild(nextBtn);
          galleryMain.appendChild(dotsContainer);
          
          // Store current image index
          galleryMain.setAttribute('data-current-image', '0');
        }
      }
      
      // Reset size and quantity
      selectedSize = "S";
      selectedQuantity = 1;
      document.getElementById('qtySelect').value = '1';
      
      // Update size selection
      document.querySelectorAll('.size-option').forEach(option => {
        option.classList.remove('selected');
        if (option.getAttribute('data-value') === 'S') {
          option.classList.add('selected');
        }
      });
      
      // Update step pills
      document.getElementById('pill-products').classList.remove('disabled');
      document.getElementById('pill-order').classList.remove('disabled');
      document.getElementById('pill-user').classList.add('disabled');
      document.getElementById('pill-pay').classList.add('disabled');
    }

    // Navigate order image
    function navigateOrderImage(direction) {
      const galleryMain = document.getElementById('galleryMain');
      const product = products.find(p => p.id === currentProductId);
      if (!product || !product.images || product.images.length <= 1) return;
      
      let currentIndex = parseInt(galleryMain.getAttribute('data-current-image') || 0);
      const totalImages = product.images.length;
      
      if (direction === 'next') {
        currentIndex = (currentIndex + 1) % totalImages;
      } else {
        currentIndex = (currentIndex - 1 + totalImages) % totalImages;
      }
      
      galleryMain.setAttribute('data-current-image', currentIndex.toString());
      galleryMain.style.backgroundImage = `url('${product.images[currentIndex]}')`;
      
      // Update dots
      const dots = galleryMain.querySelectorAll('.carousel-dot');
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentIndex);
      });
    }

    // Go to specific order image
    function goToOrderImage(index) {
      const galleryMain = document.getElementById('galleryMain');
      const product = products.find(p => p.id === currentProductId);
      if (!product || !product.images || product.images.length <= 1) return;
      
      galleryMain.setAttribute('data-current-image', index.toString());
      galleryMain.style.backgroundImage = `url('${product.images[index]}')`;
      
      // Update dots
      const dots = galleryMain.querySelectorAll('.carousel-dot');
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
    }

    // Select size
    function selectSize(element) {
      document.querySelectorAll('.size-option').forEach(option => {
        option.classList.remove('selected');
      });
      
      element.classList.add('selected');
      selectedSize = element.getAttribute('data-value');
      
      // Hide size validation error
      document.getElementById('sizeValidationError').classList.remove('show');
    }

    // Validate size and continue
    function validateSizeAndContinue() {
      if (!selectedSize) {
        document.getElementById('sizeValidationError').classList.add('show');
        return;
      }
      
      showPage('userPage');
      
      // Update step pills
      document.getElementById('pill-user').classList.remove('disabled');
    }

    // Decrease quantity
    function decreaseQuantity() {
      if (selectedQuantity > 1) {
        selectedQuantity--;
        document.getElementById('qtySelect').value = selectedQuantity;
      }
    }

    // Increase quantity
    function increaseQuantity() {
      selectedQuantity++;
      document.getElementById('qtySelect').value = selectedQuantity;
    }

    // Validate user info
    function validateUserInfo() {
      const fullname = document.getElementById('fullname').value.trim();
      const mobile = document.getElementById('mobile').value.trim();
      const pincode = document.getElementById('pincode').value.trim();
      const city = document.getElementById('city').value.trim();
      const state = document.getElementById('state').value.trim();
      const house = document.getElementById('house').value.trim();
      
      if (!fullname || !mobile || !pincode || !city || !state || !house) {
        showToast('Please fill all required fields', 'error');
        return;
      }
      
      if (mobile.length !== 10 || isNaN(mobile)) {
        showToast('Please enter a valid 10-digit mobile number', 'error');
        return;
      }
      
      if (pincode.length !== 6 || isNaN(pincode)) {
        showToast('Please enter a valid 6-digit pincode', 'error');
        return;
      }
      
      showPage('paymentPage');
      updateOrderSummary();
      
      // Update step pills
      document.getElementById('pill-pay').classList.remove('disabled');
    }

    // Update order summary
    function updateOrderSummary() {
      const product = products.find(p => p.id === currentProductId);
      if (!product) return;
      
      const price = parseInt(product.price.replace(/[^0-9]/g, '')) || 0;
      const delivery = 50;
      const total = (price * selectedQuantity) + delivery;
      
      document.getElementById('sumProduct').textContent = product.title;
      document.getElementById('sumQty').textContent = selectedQuantity;
      document.getElementById('sumPrice').textContent = `₹${price * selectedQuantity}`;
      document.getElementById('sumDel').textContent = `₹${delivery}`;
      document.getElementById('sumTotal').textContent = `₹${total}`;
    }

    // Confirm order
    function confirmOrder() {
      if (!currentUser) {
        showToast('Please login to place an order', 'error');
        showLoginModal();
        return;
      }
      
      const product = products.find(p => p.id === currentProductId);
      if (!product) return;
      
      const fullname = document.getElementById('fullname').value.trim();
      const mobile = document.getElementById('mobile').value.trim();
      const pincode = document.getElementById('pincode').value.trim();
      const city = document.getElementById('city').value.trim();
      const state = document.getElementById('state').value.trim();
      const house = document.getElementById('house').value.trim();
      const paymentMethod = document.querySelector('input[name="pay"]:checked').value;
      
      const price = parseInt(product.price.replace(/[^0-9]/g, '')) || 0;
      const delivery = 50;
      const total = (price * selectedQuantity) + delivery;
      
      // Create order object
      const order = {
        id: 'ORD' + Date.now(),
        productId: currentProductId,
        productTitle: product.title,
        productPrice: product.price,
        productImage: product.images && product.images.length > 0 ? product.images[0] : '',
        size: selectedSize,
        quantity: selectedQuantity,
        total: total,
        paymentMethod: paymentMethod,
        customer: {
          name: fullname,
          mobile: mobile,
          address: {
            house: house,
            city: city,
            state: state,
            pincode: pincode
          }
        },
        status: 'confirmed',
        orderDate: new Date().toISOString(),
        estimatedDelivery: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString() // 7 days from now
      };
      
      // Save order to Firebase
      db.collection("orders").doc(order.id).set(order)
        .then(() => {
          currentOrder = order;
          showPage('successPage');
          
          // Clear form
          document.getElementById('fullname').value = '';
          document.getElementById('mobile').value = '';
          document.getElementById('pincode').value = '';
          document.getElementById('city').value = '';
          document.getElementById('state').value = '';
          document.getElementById('house').value = '';
          
          // Show success toast
          showToast('Order placed successfully!', 'success');
          
          // Update orders notification
          updateOrdersNotification();
        })
        .catch((error) => {
          console.error("Error saving order: ", error);
          showToast('Failed to place order. Please try again.', 'error');
        });
    }

    // Save user info
    function saveUserInfo() {
      const fullname = document.getElementById('fullname').value.trim();
      const mobile = document.getElementById('mobile').value.trim();
      const pincode = document.getElementById('pincode').value.trim();
      const city = document.getElementById('city').value.trim();
      const state = document.getElementById('state').value.trim();
      const house = document.getElementById('house').value.trim();
      
      if (!fullname || !mobile || !pincode || !city || !state || !house) {
        showToast('Please fill all fields', 'error');
        return;
      }
      
      if (mobile.length !== 10 || isNaN(mobile)) {
        showToast('Please enter a valid 10-digit mobile number', 'error');
        return;
      }
      
      if (pincode.length !== 6 || isNaN(pincode)) {
        showToast('Please enter a valid 6-digit pincode', 'error');
        return;
      }
      
      // Save to user profile if logged in
      if (currentUser) {
        const address = {
          id: 'addr' + Date.now(),
          name: fullname,
          mobile: mobile,
          house: house,
          city: city,
          state: state,
          pincode: pincode,
          isDefault: userAddresses.length === 0
        };
        
        userAddresses.push(address);
        localStorage.setItem(`addresses_${currentUser.uid}`, JSON.stringify(userAddresses));
        
        showToast('Address saved successfully');
      } else {
        showToast('Information saved for this order only');
      }
    }

    // ===== ORDER HISTORY =====

    // Show my orders
    function showMyOrders() {
      if (!currentUser) {
        showToast('Please login to view your orders', 'error');
        showLoginModal();
        return;
      }
      
      loadOrders();
    }

    // Load orders
    function loadOrders() {
      if (!currentUser) return;
      
      db.collection("orders")
        .where("customer.name", ">", "") // Simple filter to get user's orders
        .orderBy("orderDate", "desc")
        .get()
        .then((querySnapshot) => {
          const ordersList = document.getElementById('ordersList');
          const noOrders = document.getElementById('noOrders');
          
          ordersList.innerHTML = '';
          
          if (querySnapshot.empty) {
            noOrders.style.display = 'block';
            return;
          }
          
          noOrders.style.display = 'none';
          
          querySnapshot.forEach((doc) => {
            const order = doc.data();
            const orderCard = createOrderCard(order);
            ordersList.appendChild(orderCard);
          });
        })
        .catch((error) => {
          console.error("Error loading orders: ", error);
          document.getElementById('noOrders').style.display = 'block';
        });
    }

    // Create order card
    function createOrderCard(order) {
      const orderCard = document.createElement('div');
      orderCard.className = 'order-card';
      orderCard.setAttribute('data-order-id', order.id);
      
      const orderHeader = document.createElement('div');
      orderHeader.className = 'order-header';
      
      const orderId = document.createElement('div');
      orderId.className = 'order-id';
      orderId.textContent = `Order #${order.id}`;
      
      const orderDate = document.createElement('div');
      orderDate.className = 'order-date';
      orderDate.textContent = new Date(order.orderDate).toLocaleDateString();
      
      const orderStatus = document.createElement('div');
      orderStatus.className = `order-status status-${order.status}`;
      orderStatus.textContent = order.status.charAt(0).toUpperCase() + order.status.slice(1);
      
      orderHeader.appendChild(orderId);
      orderHeader.appendChild(orderDate);
      orderHeader.appendChild(orderStatus);
      
      const orderDetails = document.createElement('div');
      orderDetails.className = 'order-details';
      
      const orderProductImage = document.createElement('div');
      orderProductImage.className = 'order-product-image';
      orderProductImage.style.backgroundImage = `url('${order.productImage}')`;
      
      const orderProductInfo = document.createElement('div');
      orderProductInfo.className = 'order-product-info';
      
      const orderProductTitle = document.createElement('div');
      orderProductTitle.className = 'order-product-title';
      orderProductTitle.textContent = order.productTitle;
      
      const orderProductPrice = document.createElement('div');
      orderProductPrice.className = 'order-product-price';
      orderProductPrice.textContent = order.productPrice;
      
      const orderProductMeta = document.createElement('div');
      orderProductMeta.className = 'order-product-meta';
      orderProductMeta.textContent = `Size: ${order.size} • Qty: ${order.quantity}`;
      
      const orderEstimated = document.createElement('div');
      orderEstimated.className = 'order-estimated';
      orderEstimated.textContent = `Estimated delivery: ${new Date(order.estimatedDelivery).toLocaleDateString()}`;
      
      orderProductInfo.appendChild(orderProductTitle);
      orderProductInfo.appendChild(orderProductPrice);
      orderProductInfo.appendChild(orderProductMeta);
      orderProductInfo.appendChild(orderEstimated);
      
      orderDetails.appendChild(orderProductImage);
      orderDetails.appendChild(orderProductInfo);
      
      const orderActions = document.createElement('div');
      orderActions.className = 'order-actions';
      
      const viewDetailsBtn = document.createElement('button');
      viewDetailsBtn.className = 'btn secondary';
      viewDetailsBtn.textContent = 'View Details';
      viewDetailsBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        viewOrderDetails(order.id);
      });
      
      // Only show cancel button for confirmed orders
      if (order.status === 'confirmed') {
        const cancelOrderBtn = document.createElement('button');
        cancelOrderBtn.className = 'btn error';
        cancelOrderBtn.textContent = 'Cancel Order';
        cancelOrderBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          initiateOrderCancellation(order);
        });
        
        orderActions.appendChild(cancelOrderBtn);
      }
      
      orderActions.appendChild(viewDetailsBtn);
      
      orderCard.appendChild(orderHeader);
      orderCard.appendChild(orderDetails);
      orderCard.appendChild(orderActions);
      
      orderCard.addEventListener('click', () => {
        viewOrderDetails(order.id);
      });
      
      return orderCard;
    }

    // View order details
    function viewOrderDetails(orderId) {
      db.collection("orders").doc(orderId).get()
        .then((doc) => {
          if (doc.exists) {
            const order = doc.data();
            displayOrderDetails(order);
            showPage('orderDetailPage');
          } else {
            showToast('Order not found', 'error');
          }
        })
        .catch((error) => {
          console.error("Error loading order details: ", error);
          showToast('Failed to load order details', 'error');
        });
    }

    // Display order details
    function displayOrderDetails(order) {
      const orderDetailContent = document.getElementById('orderDetailContent');
      
      orderDetailContent.innerHTML = `
        <div class="order-detail-section">
          <div class="order-detail-label">Order ID</div>
          <div class="order-detail-value">${order.id}</div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Order Date</div>
          <div class="order-detail-value">${new Date(order.orderDate).toLocaleDateString()}</div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Status</div>
          <div class="order-detail-value">
            <span class="order-status status-${order.status}">
              ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
            </span>
          </div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Product</div>
          <div class="order-detail-product">
            <div class="order-detail-image" style="background-image: url('${order.productImage}')"></div>
            <div class="order-detail-product-info">
              <div class="order-detail-value" style="font-weight: 600;">${order.productTitle}</div>
              <div class="order-detail-value">${order.productPrice}</div>
              <div class="order-detail-value">Size: ${order.size} • Quantity: ${order.quantity}</div>
            </div>
          </div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Delivery Address</div>
          <div class="order-detail-value">
            ${order.customer.name}<br>
            ${order.customer.address.house}<br>
            ${order.customer.address.city}, ${order.customer.address.state} - ${order.customer.address.pincode}<br>
            Mobile: ${order.customer.mobile}
          </div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Payment Method</div>
          <div class="order-detail-value">${order.paymentMethod === 'cod' ? 'Cash on Delivery' : 'Prepaid'}</div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Order Summary</div>
          <div class="order-detail-value">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span>Product Price:</span>
              <span>${order.productPrice}</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span>Delivery:</span>
              <span>₹50</span>
            </div>
            <div style="display: flex; justify-content: space-between; font-weight: 600; font-size: 18px; margin-top: 8px;">
              <span>Total:</span>
              <span>₹${order.total}</span>
            </div>
          </div>
        </div>
        
        ${order.status === 'confirmed' ? `
          <div class="order-detail-section">
            <button class="btn error" id="cancelOrderDetailBtn">Cancel Order</button>
          </div>
        ` : ''}
      `;
      
      if (order.status === 'confirmed') {
        document.getElementById('cancelOrderDetailBtn').addEventListener('click', () => {
          initiateOrderCancellation(order);
        });
      }
    }

    // Initiate order cancellation
    function initiateOrderCancellation(order) {
      currentOrder = order;
      document.getElementById('cancellationModal').classList.add('active');
    }

    // Close cancellation modal
    function closeCancellationModal() {
      document.getElementById('cancellationModal').classList.remove('active');
    }

    // Show cancel order flow
    function showCancelOrderFlow() {
      closeCancellationModal();
      
      // Calculate refund amount
      const orderAmount = currentOrder.total;
      const gatewayCharges = Math.round(orderAmount * 0.03); // 3% gateway charges
      const refundAmount = orderAmount - gatewayCharges;
      
      document.getElementById('refundOrderAmount').textContent = orderAmount;
      document.getElementById('refundGatewayCharges').textContent = gatewayCharges;
      document.getElementById('refundTotalAmount').textContent = refundAmount;
      
      document.getElementById('cancelOrderFlowModal').classList.add('active');
    }

    // Close cancel order flow modal
    function closeCancelOrderFlowModal() {
      document.getElementById('cancelOrderFlowModal').classList.remove('active');
    }

    // Confirm order cancellation
    function confirmOrderCancellation() {
      const selectedReason = document.querySelector('input[name="cancel-reason"]:checked');
      
      if (!selectedReason) {
        showToast('Please select a cancellation reason', 'error');
        return;
      }
      
      // Update order status in Firebase
      db.collection("orders").doc(currentOrder.id).update({
        status: 'cancelled',
        cancellationReason: selectedReason.value,
        cancelledAt: new Date().toISOString()
      })
      .then(() => {
        closeCancelOrderFlowModal();
        showToast('Order cancelled successfully');
        
        // Refresh orders list
        if (document.getElementById('myOrdersPage').classList.contains('active')) {
          loadOrders();
        }
        
        // If on order detail page, go back to orders
        if (document.getElementById('orderDetailPage').classList.contains('active')) {
          showMyOrders();
          showPage('myOrdersPage');
        }
      })
      .catch((error) => {
        console.error("Error cancelling order: ", error);
        showToast('Failed to cancel order. Please try again.', 'error');
      });
    }

    // Update orders notification
    function updateOrdersNotification() {
      if (!currentUser) return;
      
      db.collection("orders")
        .where("customer.name", ">", "") // Simple filter to get user's orders
        .get()
        .then((querySnapshot) => {
          const ordersNotification = document.getElementById('ordersNotification');
          
          if (querySnapshot.size > 0) {
            ordersNotification.style.display = 'flex';
            ordersNotification.textContent = querySnapshot.size;
          } else {
            ordersNotification.style.display = 'none';
          }
        })
        .catch((error) => {
          console.error("Error counting orders: ", error);
        });
    }

    // ===== USER AUTHENTICATION =====

    // Check auth state
    function checkAuthState() {
      auth.onAuthStateChanged((user) => {
        if (user) {
          currentUser = user;
          document.getElementById('openLoginTop').style.display = 'none';
          document.getElementById('userProfile').style.display = 'flex';
          document.getElementById('mobileLoginBtn').style.display = 'none';
          document.getElementById('mobileUserProfile').style.display = 'flex';
          
          // Update user info
          document.getElementById('userName').textContent = user.displayName || 'User';
          document.getElementById('mobileUserName').textContent = user.displayName || 'User';
          document.getElementById('userAvatar').textContent = (user.displayName || 'U').charAt(0).toUpperCase();
          
          // Load user data
          loadUserProfile();
          loadUserAddresses();
          loadWishlist();
          updateOrdersNotification();
        } else {
          currentUser = null;
          document.getElementById('openLoginTop').style.display = 'inline-flex';
          document.getElementById('userProfile').style.display = 'none';
          document.getElementById('mobileLoginBtn').style.display = 'flex';
          document.getElementById('mobileUserProfile').style.display = 'none';
        }
      });
    }

    // Show login modal
    function showLoginModal() {
      document.getElementById('authModal').classList.add('active');
    }

    // Close auth modal
    function closeAuthModal() {
      document.getElementById('authModal').classList.remove('active');
    }

    // Switch auth tab
    function switchAuthTab(tab) {
      document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
      
      document.querySelector(`.auth-tab[data-tab="${tab}"]`).classList.add('active');
      document.getElementById(`${tab}Form`).classList.add('active');
    }

    // Login user
    function loginUser(e) {
      e.preventDefault();
      
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      const errorElement = document.getElementById('loginError');
      
      errorElement.classList.remove('show');
      
      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          closeAuthModal();
          showToast('Login successful!');
        })
        .catch((error) => {
          errorElement.textContent = error.message;
          errorElement.classList.add('show');
        });
    }

    // Signup user
    function signupUser(e) {
      e.preventDefault();
      
      const name = document.getElementById('signupName').value;
      const email = document.getElementById('signupEmail').value;
      const password = document.getElementById('signupPassword').value;
      const confirmPassword = document.getElementById('signupConfirmPassword').value;
      const errorElement = document.getElementById('signupError');
      
      errorElement.classList.remove('show');
      
      if (password !== confirmPassword) {
        errorElement.textContent = 'Passwords do not match';
        errorElement.classList.add('show');
        return;
      }
      
      auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Update profile
          return userCredential.user.updateProfile({
            displayName: name
          });
        })
        .then(() => {
          closeAuthModal();
          showToast('Account created successfully!');
        })
        .catch((error) => {
          errorElement.textContent = error.message;
          errorElement.classList.add('show');
        });
    }

    // Sign in with Google
    function signInWithGoogle() {
      // This would require additional Firebase Auth setup
      showToast('Google sign-in will be implemented with proper Firebase setup');
    }

    // Show forgot password modal
    function showForgotPasswordModal() {
      document.getElementById('authModal').classList.remove('active');
      document.getElementById('forgotPasswordModal').classList.add('active');
    }

    // Close forgot password modal
    function closeForgotPasswordModal() {
      document.getElementById('forgotPasswordModal').classList.remove('active');
    }

    // Send password reset
    function sendPasswordReset() {
      const email = document.getElementById('forgotPasswordEmail').value;
      const errorElement = document.getElementById('forgotPasswordError');
      
      errorElement.classList.remove('show');
      
      auth.sendPasswordResetEmail(email)
        .then(() => {
          showToast('Password reset email sent!');
          closeForgotPasswordModal();
        })
        .catch((error) => {
          errorElement.textContent = error.message;
          errorElement.classList.add('show');
        });
    }

    // Logout user
    function logoutUser() {
      auth.signOut()
        .then(() => {
          showToast('Logged out successfully');
          showPage('homePage');
        })
        .catch((error) => {
          console.error("Error signing out: ", error);
        });
    }

    // Show profile or login
    function showProfileOrLogin() {
      if (currentUser) {
        showPage('profilePage');
      } else {
        showLoginModal();
      }
    }

    // ===== USER PROFILE =====

    // Load user profile
    function loadUserProfile() {
      if (!currentUser) return;
      
      document.getElementById('profileName').textContent = currentUser.displayName || 'User';
      document.getElementById('profileEmail').textContent = currentUser.email;
      document.getElementById('profileFullName').value = currentUser.displayName || '';
      document.getElementById('profilePhone').value = '';
      
      // Set profile avatar
      const profileAvatar = document.getElementById('profileAvatar');
      if (currentUser.photoURL) {
        profileAvatar.style.backgroundImage = `url('${currentUser.photoURL}')`;
        profileAvatar.textContent = '';
      } else {
        profileAvatar.style.backgroundImage = '';
        profileAvatar.textContent = (currentUser.displayName || 'U').charAt(0).toUpperCase();
      }
    }

    // Save profile
    function saveProfile() {
      if (!currentUser) return;
      
      const fullName = document.getElementById('profileFullName').value;
      const phone = document.getElementById('profilePhone').value;
      
      currentUser.updateProfile({
        displayName: fullName
      })
      .then(() => {
        showToast('Profile updated successfully');
        
        // Update UI
        document.getElementById('userName').textContent = fullName;
        document.getElementById('mobileUserName').textContent = fullName;
        document.getElementById('userAvatar').textContent = fullName.charAt(0).toUpperCase();
        document.getElementById('profileName').textContent = fullName;
      })
      .catch((error) => {
        console.error("Error updating profile: ", error);
        showToast('Failed to update profile', 'error');
      });
    }

    // Load user addresses
    function loadUserAddresses() {
      if (!currentUser) return;
      
      userAddresses = JSON.parse(localStorage.getItem(`addresses_${currentUser.uid}`) || '[]');
      renderAddresses();
    }

    // Render addresses
    function renderAddresses() {
      const addressList = document.getElementById('addressList');
      addressList.innerHTML = '';
      
      userAddresses.forEach(address => {
        const addressItem = document.createElement('div');
        addressItem.className = `address-item ${address.isDefault ? 'active' : ''}`;
        
        addressItem.innerHTML = `
          <div style="font-weight: 600;">${address.name}</div>
          <div>${address.house}</div>
          <div>${address.city}, ${address.state} - ${address.pincode}</div>
          <div>Mobile: ${address.mobile}</div>
          ${address.isDefault ? '<div style="color: var(--success); font-size: 14px; margin-top: 8px;">Default Address</div>' : ''}
          <div class="address-actions">
            <button class="btn secondary" onclick="setDefaultAddress('${address.id}')">Set as Default</button>
            <button class="btn error" onclick="deleteAddress('${address.id}')">Delete</button>
          </div>
        `;
        
        addressList.appendChild(addressItem);
      });
    }

    // Add new address
    function addNewAddress() {
      const address = {
        id: 'addr' + Date.now(),
        name: 'New Address',
        mobile: '',
        house: '',
        city: '',
        state: '',
        pincode: '',
        isDefault: userAddresses.length === 0
      };
      
      userAddresses.push(address);
      localStorage.setItem(`addresses_${currentUser.uid}`, JSON.stringify(userAddresses));
      renderAddresses();
      
      showToast('New address added');
    }

    // Set default address
    function setDefaultAddress(addressId) {
      userAddresses.forEach(address => {
        address.isDefault = address.id === addressId;
      });
      
      localStorage.setItem(`addresses_${currentUser.uid}`, JSON.stringify(userAddresses));
      renderAddresses();
      
      showToast('Default address updated');
    }

    // Delete address
    function deleteAddress(addressId) {
      userAddresses = userAddresses.filter(address => address.id !== addressId);
      
      // If we deleted the default address, set a new one
      if (userAddresses.length > 0 && !userAddresses.some(address => address.isDefault)) {
        userAddresses[0].isDefault = true;
      }
      
      localStorage.setItem(`addresses_${currentUser.uid}`, JSON.stringify(userAddresses));
      renderAddresses();
      
      showToast('Address deleted');
    }

    // ===== IMAGE ZOOM =====

    // Open image zoom
    function openImageZoom() {
      const zoomedImage = document.getElementById('zoomedImage');
      const detailMainImage = document.getElementById('detailMainImage');
      const zoomImageUrl = detailMainImage.getAttribute('data-zoom-image');
      
      if (!zoomImageUrl) return;
      
      zoomedImage.src = zoomImageUrl;
      zoomedImage.style.transform = 'scale(1)';
      
      document.getElementById('imageZoomModal').classList.add('active');
    }

    // Close image zoom
    function closeImageZoom() {
      document.getElementById('imageZoomModal').classList.remove('active');
    }

    // Zoom in
    function zoomIn() {
      const zoomedImage = document.getElementById('zoomedImage');
      const currentScale = parseFloat(zoomedImage.style.transform.replace('scale(', '').replace(')', '')) || 1;
      zoomedImage.style.transform = `scale(${currentScale + 0.2})`;
    }

    // Zoom out
    function zoomOut() {
      const zoomedImage = document.getElementById('zoomedImage');
      const currentScale = parseFloat(zoomedImage.style.transform.replace('scale(', '').replace(')', '')) || 1;
      if (currentScale > 0.4) {
        zoomedImage.style.transform = `scale(${currentScale - 0.2})`;
      }
    }

    // Reset zoom
    function resetZoom() {
      const zoomedImage = document.getElementById('zoomedImage');
      zoomedImage.style.transform = 'scale(1)';
    }

    // ===== PRODUCT SHARING =====

    // Copy product link
    function copyProductLink() {
      if (!currentProductId) return;
      
      const productLink = `${window.location.origin}${window.location.pathname}?product=${currentProductId}`;
      
      navigator.clipboard.writeText(productLink)
        .then(() => {
          showToast('Product link copied to clipboard');
        })
        .catch(() => {
          // Fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = productLink;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          showToast('Product link copied to clipboard');
        });
    }

    // Share product on social media
    function shareProduct(platform) {
      if (!currentProductId) return;
      
      const product = products.find(p => p.id === currentProductId);
      if (!product) return;
      
      const productLink = `${window.location.origin}${window.location.pathname}?product=${currentProductId}`;
      const text = `Check out this product: ${product.title}`;
      
      let shareUrl = '';
      
      switch (platform) {
        case 'facebook':
          shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(productLink)}`;
          break;
        case 'twitter':
          shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(productLink)}`;
          break;
        case 'whatsapp':
          shareUrl = `https://wa.me/?text=${encodeURIComponent(text + ' ' + productLink)}`;
          break;
      }
      
      if (shareUrl) {
        window.open(shareUrl, '_blank', 'width=600,height=400');
      }
    }

    // ===== UTILITY FUNCTIONS =====

    // Show page
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      
      document.getElementById(pageId).classList.add('active');
      
      // Scroll to top
      window.scrollTo(0, 0);
      
      // Load specific page data
      if (pageId === 'wishlistPage') {
        loadWishlist();
      } else if (pageId === 'myOrdersPage') {
        loadOrders();
      }
    }

    // Show toast notification
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toast-message');
      
      toastMessage.textContent = message;
      toast.className = `toast ${type}`;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Setup hero messages
    function setupHeroMessages() {
      const heroMessages = document.getElementById('heroMessages');
      const messages = heroMessages.querySelectorAll('span');
      let currentIndex = 0;
      
      setInterval(() => {
        messages.forEach(msg => msg.classList.remove('active'));
        currentIndex = (currentIndex + 1) % messages.length;
        messages[currentIndex].classList.add('active');
      }, 3000);
    }

    // Open mobile menu
    function openMenu() {
      document.getElementById('mobileMenu').classList.add('active');
      document.getElementById('menuOverlay').classList.add('active');
    }

    // Close mobile menu
    function closeMenu() {
      document.getElementById('mobileMenu').classList.remove('active');
      document.getElementById('menuOverlay').classList.remove('active');
    }

    // Subscribe to newsletter
    function subscribeNewsletter() {
      const email = document.getElementById('newsletterEmail').value;
      
      if (!email) {
        showToast('Please enter your email', 'error');
        return;
      }
      
      // Simple email validation
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        showToast('Please enter a valid email', 'error');
        return;
      }
      
      // Save to Firebase
      db.collection("newsletter").add({
        email: email,
        subscribedAt: new Date().toISOString()
      })
      .then(() => {
        showToast('Subscribed to newsletter!');
        document.getElementById('newsletterEmail').value = '';
      })
      .catch((error) => {
        console.error("Error subscribing: ", error);
        showToast('Subscription failed. Please try again.', 'error');
      });
    }

    // Handle URL parameters for product sharing
    function handleUrlParameters() {
      const urlParams = new URLSearchParams(window.location.search);
      const productId = urlParams.get('product');
      
      if (productId) {
        viewProductDetails(productId);
      }
    }

    // Initialize URL parameter handling
    handleUrlParameters();
  </script>
</body>
</html>