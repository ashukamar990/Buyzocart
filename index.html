<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Buyzo Cart — Modern Shop</title>
  <meta name="description" content="Buyzo Cart — clean, mobile‑first shop template with product cards, step checkout, and policy modals."/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://images.unsplash.com"/>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <!-- EmailJS SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <style>
    :root {
      --bg: #ffffff;
      --card: #ffffff;
      --accent: #2563eb;
      --accent-hover: #1d4ed8;
      --muted: #64748b;
      --muted-light: #94a3b8;
      --success: #22c55e;
      --error: #ef4444;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      --shadow-hover: 0 6px 16px rgba(0, 0, 0, 0.08);
      --ring: #dbeafe;
      --ink: #0f172a;
      --ink-2: #334155;
      --border: #e2e8f0;
      --radius: 12px;
      --transition: all 0.3s ease;
    }

    [data-theme="dark"] {
      --bg: #0f172a;
      --card: #1e293b;
      --accent: #3b82f6;
      --accent-hover: #2563eb;
      --muted: #94a3b8;
      --muted-light: #64748b;
      --success: #22c55e;
      --error: #ef4444;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      --shadow-hover: 0 6px 16px rgba(0, 0, 0, 0.3);
      --ring: #1e3a8a;
      --ink: #f1f5f9;
      --ink-2: #cbd5e1;
      --border: #334155;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--ink);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      transition: var(--transition);
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* Header */
    header {
      background: var(--card);
      box-shadow: var(--shadow);
      padding: 16px 24px;
      position: sticky;
      top: 0;
      z-index: 50;
      border-bottom: 1px solid var(--border);
      transition: var(--transition);
    }

    .header-inner {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 16px;
      justify-content: space-between;
    }

    .brand {
      font-weight: 800;
      color: var(--ink);
      font-size: 20px;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .brand .chip {
      background: var(--accent);
      color: #fff;
      font-weight: 700;
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 14px;
    }

    .search-wrap {
      flex: 1;
      display: flex;
      max-width: 500px;
      margin: 16px 0;
    }

    .search-wrap input {
      flex: 1;
      padding: 12px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      font-family: inherit;
      font-size: 14px;
      transition: all 0.2s ease;
      background: var(--card);
      color: var(--ink);
    }

    .search-wrap input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--ring);
    }

    .cta {
      display: flex;
      gap: 10px;
      position: relative;
      align-items: center;
    }

    .btn {
      background: var(--accent);
      color: #fff;
      border: 0;
      padding: 10px 16px;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .btn:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
    }

    .btn.secondary {
      background: #f1f5f9;
      color: var(--ink-2);
    }

    .btn.secondary:hover {
      background: #e2e8f0;
      transform: translateY(-1px);
    }

    .btn.error {
      background: var(--error);
    }

    .btn.error:hover {
      background: #dc2626;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Theme Toggle Button */
    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.2s ease;
      color: var(--ink);
    }

    .theme-toggle:hover {
      background: var(--border);
    }

    .theme-toggle svg {
      width: 20px;
      height: 20px;
    }

    .theme-toggle .moon-icon {
      display: none;
    }

    [data-theme="dark"] .theme-toggle .sun-icon {
      display: none;
    }

    [data-theme="dark"] .theme-toggle .moon-icon {
      display: block;
    }

    /* Notification Badge */
    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: var(--error);
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: bold;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    /* Container */
    .container {
      max-width: 1100px;
      margin: 28px auto;
      padding: 0 20px;
      min-height: 70vh;
    }

    /* Hero */
    .hero {
      background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 24px;
      margin-bottom: 24px;
      transition: var(--transition);
    }

    [data-theme="dark"] .hero {
      background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
    }

    .hero h1 {
      margin: 0 0 8px 0;
      font-size: 24px;
      font-weight: 700;
    }

    .hero p {
      margin: 0;
      color: var(--muted);
      font-size: 16px;
    }

    /* Steps */
    .steps {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin: 24px 0;
      flex-wrap: wrap;
    }

    .step-pill {
      background: #fff;
      padding: 10px 16px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-weight: 600;
      color: var(--ink-2);
      cursor: pointer;
      user-select: none;
      transition: all 0.2s ease;
      font-size: 14px;
    }

    .step-pill:hover {
      border-color: var(--accent);
    }

    .step-pill.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .step-pill.disabled:hover {
      border-color: var(--border);
    }

    /* NEW: Enhanced Product Grid */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    .product-card {
      background: var(--card);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
    }

    .product-card-image {
      height: 180px;
      background-position: center;
      background-size: cover;
      position: relative;
    }

    .product-card-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      background: #ff4444;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 700;
      z-index: 2;
    }

    .product-card-body {
      padding: 16px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .product-card-title {
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 16px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .product-card-rating {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .product-card-stars {
      color: #ffc107;
      margin-right: 4px;
    }

    .product-card-review-count {
      color: var(--muted);
    }

    .product-card-price {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .product-card-current-price {
      font-weight: 700;
      color: var(--ink);
      font-size: 18px;
    }

    .product-card-original-price {
      text-decoration: line-through;
      color: var(--muted);
      font-size: 14px;
    }

    .product-card-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 12px;
    }

    .action-btn {
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    .action-btn:hover {
      background: #f1f5f9;
    }

    .wishlist-btn {
      color: var(--muted);
    }

    .wishlist-btn.active {
      color: var(--error);
    }

    .share-btn {
      color: var(--muted);
    }

    /* Pages */
    .page {
      display: none;
    }

    .page.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card-panel {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
      margin-bottom: 16px;
      border: 1px solid var(--border);
      transition: var(--transition);
    }

    .card-panel h3 {
      margin-top: 0;
      margin-bottom: 12px;
      font-size: 18px;
      font-weight: 600;
    }

    label {
      display: block;
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 6px;
      font-weight: 500;
    }

    input, select, textarea {
      width: 100%;
      padding: 12px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--card);
      outline: none;
      font-family: inherit;
      font-size: 14px;
      transition: all 0.2s ease;
      color: var(--ink);
    }

    input:focus, select:focus, textarea:focus {
      box-shadow: 0 0 0 3px var(--ring);
      border-color: var(--accent);
    }

    .row {
      display: flex;
      gap: 16px;
    }

    .col {
      flex: 1;
    }

    .summary {
      background: #f8fafc;
      padding: 16px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    [data-theme="dark"] .summary {
      background: #1e293b;
    }

    .center {
      text-align: center;
    }

    footer {
      margin-top: 48px;
      text-align: center;
      color: var(--muted);
      padding: 28px 0;
      border-top: 1px solid var(--border);
      transition: var(--transition);
    }

    /* Thumbnails */
    .thumbs {
      display: flex;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .thumb {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      border: 2px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .thumb:hover {
      transform: scale(1.05);
    }

    .thumb.selected {
      border-color: var(--accent);
    }

    /* FIX FOR PROBLEM 1: Remove blue background from order page slider */
    #orderPage .gallery-main {
      background-color: transparent !important;
    }

    .gallery-main {
      height: 340px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      position: relative;
      overflow: hidden;
    }

    /* Product Detail Page */
    .product-detail-page {
      padding: 20px;
    }
    
    .product-detail-container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }
    
    .product-detail-gallery {
      flex: 1;
      min-width: 300px;
      position: relative;
    }
    
    .product-detail-info {
      flex: 1;
      min-width: 300px;
    }
    
    .product-detail-main-image {
      width: 100%;
      height: 400px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      margin-bottom: 16px;
      position: relative;
      overflow: hidden;
      cursor: zoom-in;
    }
    
    .product-detail-thumbnails {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .product-detail-thumbnail {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      border: 2px solid var(--border);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .product-detail-thumbnail:hover,
    .product-detail-thumbnail.active {
      border-color: var(--accent);
      transform: scale(1.05);
    }
    
    .product-detail-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .product-detail-price {
      font-size: 28px;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 12px;
    }
    
    .product-detail-desc {
      color: var(--muted);
      margin-bottom: 20px;
      font-size: 16px;
    }
    
    .product-detail-full-desc {
      margin-bottom: 24px;
      line-height: 1.6;
      color: var(--ink-2);
    }
    
    .product-detail-meta {
      background: #f8fafc;
      padding: 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      margin-bottom: 24px;
    }

    [data-theme="dark"] .product-detail-meta {
      background: #1e293b;
    }
    
    .product-detail-meta h4 {
      margin: 0 0 12px 0;
      color: var(--accent);
      font-size: 16px;
    }
    
    .back-to-products {
      display: inline-flex;
      align-items: center;
      margin-bottom: 20px;
      color: var(--accent);
      font-weight: 600;
      cursor: pointer;
      padding: 8px 16px;
      border-radius: var(--radius);
      background: #f1f5f9;
      transition: all 0.2s ease;
    }

    [data-theme="dark"] .back-to-products {
      background: #1e293b;
    }
    
    .back-to-products:hover {
      background: #e2e8f0;
      color: var(--accent-hover);
    }

    /* Similar Products Section */
    .similar-products {
      margin-top: 40px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }
    
    .similar-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--ink);
    }

    /* Carousel Controls for Product Detail */
    .detail-carousel-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      color: var(--ink);
      transition: all 0.2s ease;
      z-index: 10;
    }

    .detail-carousel-control:hover {
      background: rgba(255, 255, 255, 1);
    }

    .detail-carousel-control.prev {
      left: 10px;
    }

    .detail-carousel-control.next {
      right: 10px;
    }

    .detail-carousel-dots {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }

    .detail-carousel-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .detail-carousel-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }

    /* Policy Pages */
    .policy-page {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .policy-content {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      border: 1px solid var(--border);
    }
    
    .policy-content h2 {
      margin-top: 0;
      color: var(--accent);
      border-bottom: 2px solid var(--border);
      padding-bottom: 12px;
      margin-bottom: 20px;
    }
    
    .policy-content h3 {
      margin: 24px 0 12px;
      color: var(--ink);
    }
    
    .policy-content p {
      margin-bottom: 16px;
      line-height: 1.6;
    }
    
    .policy-content ul, .policy-content ol {
      margin: 16px 0;
      padding-left: 24px;
    }
    
    .policy-content li {
      margin-bottom: 8px;
    }
    
    .back-button {
      display: inline-flex;
      align-items: center;
      margin-bottom: 20px;
      color: var(--accent);
      font-weight: 600;
      cursor: pointer;
    }
    
    .back-button:hover {
      color: var(--accent-hover);
    }

    /* Category Navigation */
    .categories {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 16px 0 24px;
      justify-content: center;
    }
    
    .category-pill {
      background: #fff;
      padding: 8px 16px;
      border-radius: 20px;
      border: 1px solid var(--border);
      font-weight: 500;
      color: var(--ink-2);
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
      white-space: nowrap;
    }
    
    .category-pill:hover, .category-pill.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    .category-pill.active {
      font-weight: 600;
    }

    /* Carousel Controls */
    .carousel-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      color: var(--ink);
      transition: all 0.2s ease;
      z-index: 10;
    }

    .carousel-control:hover {
      background: rgba(255, 255, 255, 1);
    }

    .carousel-control.prev {
      left: 10px;
    }

    .carousel-control.next {
      right: 10px;
    }

    .carousel-dots {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }

    .carousel-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .carousel-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }

    /* About Us Section */
    .about-us {
      margin-top: 40px;
      padding: 20px;
      background: #f8fafc;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      text-align: center;
    }

    [data-theme="dark"] .about-us {
      background: #1e293b;
    }

    .about-us h3 {
      margin-bottom: 12px;
      color: var(--accent);
    }

    .about-us p {
      color: var(--ink-2);
      max-width: 600px;
      margin: 0 auto;
    }

    /* My Orders Page */
    .orders-container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .order-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
      margin-bottom: 20px;
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
    }
    
    .order-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-hover);
    }
    
    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }
    
    .order-id {
      font-weight: 600;
      color: var(--accent);
    }
    
    .order-date {
      color: var(--muted);
      font-size: 14px;
    }
    
    .order-estimated {
      color: var(--success);
      font-size: 14px;
      font-weight: 500;
      margin-top: 4px;
    }
    
    .order-status {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .status-confirmed {
      background: #dcfce7;
      color: #166534;
    }
    
    .status-shipped {
      background: #dbeafe;
      color: #1e40af;
    }
    
    .status-delivered {
      background: #dcfce7;
      color: #166534;
    }
    
    .status-cancelled {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .order-details {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }
    
    .order-product-image {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border: 1px solid var(--border);
    }
    
    .order-product-info {
      flex: 1;
    }
    
    .order-product-title {
      font-weight: 600;
      margin-bottom: 6px;
    }
    
    .order-product-price {
      color: var(--accent);
      font-weight: 700;
      margin-bottom: 6px;
    }
    
    .order-product-meta {
      color: var(--muted);
      font-size: 14px;
    }
    
    .order-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    /* Order Detail Page */
    .order-detail-page {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      margin-bottom: 24px;
    }
    
    .order-detail-section {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }
    
    .order-detail-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    
    .order-detail-label {
      font-weight: 600;
      color: var(--muted);
      margin-bottom: 6px;
      font-size: 14px;
    }
    
    .order-detail-value {
      font-size: 16px;
      color: var(--ink);
    }
    
    .order-detail-image {
      width: 120px;
      height: 120px;
      border-radius: 8px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      border: 1px solid var(--border);
      margin-right: 16px;
    }
    
    .order-detail-product {
      display: flex;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .order-detail-product-info {
      flex: 1;
    }

    /* Horizontal Product Slider */
    .product-slider {
      margin: 30px 0;
      position: relative;
    }
    
    .slider-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .slider-title {
      font-size: 20px;
      font-weight: 700;
    }
    
    .slider-controls {
      display: flex;
      gap: 8px;
    }
    
    .slider-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--card);
      border: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .slider-btn:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    .slider-container {
      overflow-x: auto;
      scroll-behavior: smooth;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
      user-select: none;
    }
    
    .slider-container::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }
    
    .slider-track {
      display: flex;
      gap: 16px;
      padding: 4px;
      user-select: none;
    }
    
    .slider-item {
      flex: 0 0 auto;
      width: 200px;
      background: var(--card);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      transition: all 0.3s ease;
      cursor: pointer;
      user-select: none;
    }
    
    .slider-item:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
    }
    
    .slider-item-img {
      height: 150px;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .slider-item-body {
      padding: 12px;
    }
    
    .slider-item-title {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .slider-item-price {
      font-weight: 700;
      color: var(--accent);
      font-size: 16px;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--card);
      color: var(--ink);
      padding: 16px 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow-hover);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
      transform: translateX(-50%) translateY(-100px);
      opacity: 0;
      transition: all 0.3s ease;
      max-width: 90%;
      text-align: center;
    }
    
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    
    .toast.success {
      border-left: 4px solid var(--success);
    }
    
    .toast.error {
      border-left: 4px solid var(--error);
    }
    
    .toast-icon {
      font-size: 20px;
    }
    
    .toast.success .toast-icon {
      color: var(--success);
    }
    
    .toast.error .toast-icon {
      color: var(--error);
    }

    /* Cancellation Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .cancellation-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow-hover);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }
    
    .cancellation-modal h3 {
      margin-top: 0;
      margin-bottom: 16px;
      color: var(--ink);
    }
    
    .cancellation-reason {
      margin-bottom: 12px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .cancellation-reason:hover {
      border-color: var(--accent);
      background: #f8fafc;
    }
    
    .cancellation-reason.selected {
      border-color: var(--accent);
      background: var(--ring);
    }
    
    .cancellation-reason input {
      margin-right: 8px;
      width: auto;
    }
    
    .cancellation-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      justify-content: flex-end;
    }

    /* Alert Modal - Updated with Cancel and Yes buttons */
    .alert-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow-hover);
      max-width: 500px;
      width: 90%;
      text-align: center;
    }
    
    .alert-modal h3 {
      margin-top: 0;
      margin-bottom: 16px;
      color: var(--ink);
    }
    
    .alert-modal p {
      margin-bottom: 20px;
      line-height: 1.6;
    }
    
    .alert-modal .alert-icon {
      font-size: 48px;
      color: var(--error);
      margin-bottom: 16px;
    }
    
    /* New styles for alert modal buttons */
    .alert-modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 20px;
    }

    /* Quantity Input Controls */
    .quantity-control {
      display: flex;
      align-items: center;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      width: 100%;
    }
    
    .quantity-control button {
      background: #f1f5f9;
      border: none;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s ease;
    }
    
    .quantity-control button:hover {
      background: #e2e8f0;
    }
    
    .quantity-control input {
      flex: 1;
      text-align: center;
      border: none;
      border-left: 1px solid var(--border);
      border-right: 1px solid var(--border);
      border-radius: 0;
      padding: 10px;
      margin: 0;
      background: var(--card);
      color: var(--ink);
    }

    /* Delivery Congratulations */
    .delivery-congrats {
      background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
      border: 1px solid #22c55e;
      border-radius: var(--radius);
      padding: 16px;
      margin-top: 16px;
      text-align: center;
      color: #166534;
      font-weight: 600;
    }
    
    .delivery-congrats-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }

    /* Refund Request Section */
    .refund-section {
      background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
      border: 1px solid #f59e0b;
      border-radius: var(--radius);
      padding: 16px;
      margin-top: 16px;
    }
    
    .refund-title {
      font-size: 16px;
      font-weight: 600;
      color: #92400e;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .refund-note {
      color: #92400e;
      font-size: 14px;
      margin-bottom: 12px;
    }
    
    .refund-time-left {
      background: #fef3c7;
      border: 1px solid #f59e0b;
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 12px;
      font-weight: 600;
      color: #92400e;
      display: inline-block;
      margin-bottom: 12px;
    }

    /* Mobile Menu Icon */
    .menu-icon {
      display: none;
      flex-direction: column;
      justify-content: space-between;
      width: 24px;
      height: 18px;
      cursor: pointer;
    }
    
    .menu-icon span {
      height: 2px;
      width: 100%;
      background-color: var(--ink);
      border-radius: 2px;
      transition: all 0.3s ease;
    }
    
    /* Mobile Menu */
    .mobile-menu {
      position: fixed;
      top: 0;
      left: -280px;
      width: 280px;
      height: 100vh;
      background: var(--card);
      box-shadow: var(--shadow-hover);
      z-index: 1000;
      transition: left 0.3s ease;
      overflow-y: auto;
    }
    
    .mobile-menu.active {
      left: 0;
    }
    
    .menu-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
    }
    
    .menu-close {
      font-size: 24px;
      cursor: pointer;
      color: var(--muted);
    }
    
    .menu-items {
      padding: 16px 0;
    }
    
    .menu-item {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: var(--ink);
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .menu-item:hover {
      background: #f1f5f9;
      color: var(--accent);
    }
    
    .menu-item svg {
      margin-right: 12px;
      width: 18px;
      height: 18px;
    }
    
    .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .menu-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* NEW FEATURES STYLES */

    /* Recently Viewed Products */
    .recently-viewed {
      margin: 40px 0;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }

    .recently-viewed-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--ink);
    }

    /* Newsletter Section */
    .newsletter-section {
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      border-radius: var(--radius);
      padding: 32px 24px;
      text-align: center;
      margin: 40px 0;
      border: 1px solid var(--border);
    }

    [data-theme="dark"] .newsletter-section {
      background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
    }

    .newsletter-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
      color: var(--ink);
    }

    .newsletter-desc {
      color: var(--muted);
      margin-bottom: 20px;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    .newsletter-form {
      display: flex;
      max-width: 400px;
      margin: 0 auto;
      gap: 10px;
    }

    .newsletter-input {
      flex: 1;
      padding: 12px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      font-family: inherit;
      font-size: 14px;
      background: var(--card);
      color: var(--ink);
    }

    .newsletter-btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .newsletter-btn:hover {
      background: var(--accent-hover);
    }

    /* Social Sharing */
    .social-sharing {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .share-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: var(--radius);
      background: #f1f5f9;
      color: var(--ink);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .share-btn:hover {
      background: #e2e8f0;
      transform: translateY(-1px);
    }

    .share-btn.facebook { background: #f0f7ff; color: #1877f2; }
    .share-btn.twitter { background: #f0f9ff; color: #1da1f2; }
    .share-btn.whatsapp { background: #f0fff4; color: #25d366; }

    /* Stock Status */
    .stock-status {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .in-stock {
      background: #dcfce7;
      color: #166534;
    }

    .low-stock {
      background: #fef3c7;
      color: #92400e;
    }

    .out-of-stock {
      background: #fee2e2;
      color: #991b1b;
    }

    /* Product SKU */
    .product-sku {
      color: var(--muted);
      font-size: 14px;
      margin-bottom: 8px;
    }

    /* Breadcrumb Navigation */
    .breadcrumb {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      color: var(--muted);
    }

    .breadcrumb a {
      color: var(--accent);
    }

    .breadcrumb span {
      color: var(--muted-light);
    }

    /* Loading Spinner */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Price Filter */
    .price-filter {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 20px;
      border: 1px solid var(--border);
    }

    .price-filter-title {
      font-weight: 600;
      margin-bottom: 12px;
      font-size: 16px;
    }

    .price-range {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .price-input {
      flex: 1;
      background: var(--card);
      color: var(--ink);
    }

    /* Wishlist Button Active State - UPDATED TO RED */
    .wishlist-btn.active {
      color: var(--error) !important;
      background: #fee2e2 !important;
      border-color: var(--error) !important;
    }

    .wishlist-btn.active:hover {
      background: #fecaca !important;
    }

    /* Product Detail Page Wishlist Button - UPDATED TO RED */
    #detailWishlistBtn.active {
      background: var(--error) !important;
      color: white !important;
      border-color: var(--error) !important;
    }

    #detailWishlistBtn.active:hover {
      background: #dc2626 !important;
    }

    /* Size and Color Selection */
    .size-color-options {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }

    .size-option, .color-option {
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card);
      color: var(--ink);
    }

    .size-option:hover, .color-option:hover {
      border-color: var(--accent);
    }

    .size-option.selected, .color-option.selected {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* Simple Price Range Slider */
    .price-range-slider {
      margin: 16px 0;
    }

    .price-slider {
      width: 100%;
      height: 5px;
      border-radius: 5px;
      background: #ddd;
      outline: none;
      -webkit-appearance: none;
    }

    .price-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
    }

    .price-slider::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      border: none;
    }

    .price-range-values {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      font-size: 14px;
      color: var(--muted);
    }

    /* Remove blue overlay from product images */
    .product-img-slider:focus,
    .product-detail-main-image:focus,
    .gallery-main:focus {
      outline: none;
      box-shadow: none;
    }

    /* Product image container fixes */
    .product-img-slider-container,
    .product-detail-gallery,
    .gallery-main {
      background-color: transparent !important;
    }

    /* NEW: Remove blue highlight from product and order pages */
    .card,
    .card-body,
    .product-img-slider-container,
    .gallery-main,
    .product-detail-main-image,
    .product-detail-thumbnail,
    .slider-item,
    .order-card,
    .order-detail-page {
      -webkit-tap-highlight-color: transparent;
      outline: none;
    }

    /* Keep blue highlight only for menu items */
    .menu-item {
      -webkit-tap-highlight-color: rgba(37, 99, 235, 0.1);
    }

    /* Size validation error styling */
    .size-validation-error {
      color: var(--error);
      font-size: 14px;
      margin-top: 8px;
      display: none;
    }

    .size-validation-error.show {
      display: block;
    }

    /* Cancel Order Flow Modal */
    .cancel-confirm-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow-hover);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .cancel-confirm-modal h3 {
      margin-top: 0;
      margin-bottom: 16px;
      color: var(--ink);
    }

    .cancel-confirm-modal .payment-charge-note {
      background: #fef3c7;
      border: 1px solid #f59e0b;
      border-radius: var(--radius);
      padding: 16px;
      margin: 16px 0;
      color: #92400e;
    }

    .cancel-confirm-modal .refund-calculation {
      background: #f8fafc;
      border-radius: var(--radius);
      padding: 16px;
      margin: 16px 0;
    }

    [data-theme="dark"] .cancel-confirm-modal .refund-calculation {
      background: #1e293b;
    }

    .cancel-confirm-modal .refund-calculation p {
      margin: 8px 0;
    }

    .cancel-confirm-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      justify-content: flex-end;
    }

    /* NEW: Login/Signup Modal Styles */
    .auth-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 32px;
      box-shadow: var(--shadow-hover);
      max-width: 450px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }
    
    .auth-modal h3 {
      margin-top: 0;
      margin-bottom: 24px;
      color: var(--ink);
      text-align: center;
      font-size: 24px;
    }
    
    .auth-tabs {
      display: flex;
      margin-bottom: 24px;
      border-bottom: 1px solid var(--border);
    }
    
    .auth-tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      font-weight: 600;
      color: var(--muted);
      transition: all 0.2s ease;
      border-bottom: 2px solid transparent;
    }
    
    .auth-tab.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }
    
    .auth-form {
      display: none;
    }
    
    .auth-form.active {
      display: block;
    }
    
    .auth-form-group {
      margin-bottom: 16px;
    }
    
    .auth-form-footer {
      margin-top: 24px;
      text-align: center;
      font-size: 14px;
      color: var(--muted);
    }
    
    .auth-form-footer a {
      color: var(--accent);
      cursor: pointer;
    }
    
    .user-profile {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      position: relative;
    }
    
    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--accent);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
    }
    
    .user-name {
      font-weight: 600;
      color: var(--ink);
    }
    
    /* Account Dropdown Menu */
    .account-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow-hover);
      min-width: 200px;
      padding: 8px 0;
      margin-top: 8px;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.2s ease;
    }
    
    .account-dropdown.active {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .account-dropdown-item {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      color: var(--ink);
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .account-dropdown-item:hover {
      background: #f1f5f9;
    }
    
    .account-dropdown-item svg {
      margin-right: 12px;
      width: 16px;
      height: 16px;
    }
    
    /* NEW: Close button for auth modal */
    .auth-close {
      position: absolute;
      top: 16px;
      right: 16px;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--muted);
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s ease;
    }
    
    .auth-close:hover {
      background: #f1f5f9;
      color: var(--ink);
    }
    
    /* NEW: Google Sign-In Button */
    .google-signin-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
      padding: 12px 16px;
      background: white;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 16px;
    }
    
    .google-signin-btn:hover {
      background: #f8fafc;
      border-color: var(--accent);
    }
    
    .google-signin-btn img {
      width: 18px;
      height: 18px;
    }
    
    .divider {
      display: flex;
      align-items: center;
      margin: 20px 0;
      color: var(--muted);
      font-size: 14px;
    }
    
    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid var(--border);
    }
    
    .divider span {
      padding: 0 12px;
    }

    /* NEW: Image Zoom Modal */
    .zoom-modal {
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .zoom-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
    }
    
    .zoom-image {
      max-width: 100%;
      max-height: 90vh;
      object-fit: contain;
    }
    
    .zoom-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 20px;
      transition: all 0.2s ease;
    }
    
    .zoom-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .zoom-controls {
      position: absolute;
      bottom: 20px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    
    .zoom-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.2s ease;
    }
    
    .zoom-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* NEW: Enhanced Product Gallery */
    .product-gallery-zoom {
      position: relative;
      cursor: zoom-in;
    }
    
    .zoom-indicator {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .product-gallery-zoom:hover .zoom-indicator {
      opacity: 1;
    }

    /* NEW: Forgot Password Form Styles */
    .forgot-password-form {
      display: none;
    }
    
    .forgot-password-form.active {
      display: block;
    }
    
    .back-to-login {
      color: var(--accent);
      cursor: pointer;
      font-weight: 600;
      margin-top: 16px;
      text-align: center;
    }
    
    .back-to-login:hover {
      color: var(--accent-hover);
    }

    /* === Clean Animated Banners CSS === */
    .hero-messages {
      margin-top: 10px;
      font-size: 16px;
      color: var(--muted);
      font-weight: 600;
      display: flex;
      justify-content: center;
      gap: 24px;
      overflow: hidden;
      position: relative;
    }
    .hero-messages span {
      opacity: 0;
      position: absolute;
      transition: opacity 0.6s ease;
    }
    .hero-messages span.active {
      opacity: 1;
      position: relative;
    }

    .highlight-strip {
      margin-top: 16px;
      padding: 10px 16px;
      border-radius: 8px;
      background: linear-gradient(90deg,#2563eb,#1d4ed8);
      color: white;
      font-weight: 600;
      text-align: center;
      animation: pulseStrip 4s infinite;
      cursor: pointer;
    }
    @keyframes pulseStrip {
      0%,100% { box-shadow: 0 0 0 rgba(37,99,235,0); }
      50% { box-shadow: 0 0 16px rgba(37,99,235,0.35); }
    }

    /* Search Results Grid */
    #homeSearchResults {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      margin-top: 20px;
    }

    /* Trending Now Section */
    .trending-section {
      margin: 30px 0;
    }

    .trending-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .trending-title {
      font-size: 20px;
      font-weight: 700;
    }

    /* NEW: Banner Carousel Styles */
    .banner-carousel {
      position: relative;
      width: 100%;
      height: 200px;
      border-radius: var(--radius);
      overflow: hidden;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
    }

    .banner-track {
      display: flex;
      width: 100%;
      height: 100%;
      transition: transform 0.5s ease;
    }

    .banner-slide {
      min-width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .banner-controls {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }

    .banner-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .banner-dot.active {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.2);
    }

    /* NEW: Category Circles Styles */
    .category-circles {
      margin: 30px 0;
    }

    .category-circles-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      text-align: center;
    }

    .category-circles-container {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding: 10px 0;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .category-circles-container::-webkit-scrollbar {
      display: none;
    }

    .category-circle {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      min-width: 80px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .category-circle:hover {
      transform: translateY(-5px);
    }

    .category-circle-image {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      border: 2px solid var(--border);
      transition: all 0.2s ease;
    }

    .category-circle:hover .category-circle-image {
      border-color: var(--accent);
    }

    .category-circle-name {
      font-size: 12px;
      font-weight: 600;
      text-align: center;
      color: var(--ink);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header-inner {
        flex-wrap: wrap;
      }
      
      .search-wrap {
        margin-left: 0;
        order: 3;
        width: 100%;
        max-width: 100%;
      }
      
      .row {
        flex-direction: column;
      }
      
      /* Keep 2 columns on mobile */
      .product-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      
      .steps {
        gap: 6px;
      }
      
      .step-pill {
        font-size: 12px;
        padding: 8px 12px;
      }
      
      .policy-content {
        padding: 16px;
      }
      
      .categories {
        overflow-x: auto;
        padding-bottom: 8px;
        justify-content: flex-start;
      }

      .carousel-control {
        width: 32px;
        height: 32px;
        font-size: 14px;
      }
      
      .product-detail-container {
        flex-direction: column;
      }
      
      .product-detail-main-image {
        height: 300px;
      }
      
      .order-details {
        flex-direction: column;
      }
      
      .order-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      
      .order-actions {
        justify-content: flex-start;
      }
      
      .cancellation-modal {
        padding: 16px;
      }
      
      .cancellation-actions {
        flex-direction: column;
      }
      
      .alert-modal {
        padding: 16px;
      }
      
      .alert-modal-buttons {
        flex-direction: column;
      }
      
      .quantity-control button {
        width: 36px;
        height: 36px;
      }
      
      /* Show menu icon on mobile */
      .menu-icon {
        display: flex;
      }
      
      /* Hide some CTA buttons on mobile to make space */
      .cta .btn:not(:last-child) {
        display: none;
      }
      
      /* Banner carousel mobile */
      .banner-carousel {
        height: 150px;
      }
      
      /* Category circles mobile */
      .category-circles-container {
        gap: 15px;
      }
      
      .category-circle {
        min-width: 70px;
      }
      
      .category-circle-image {
        width: 60px;
        height: 60px;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 0 16px;
      }
      
      .hero {
        padding: 20px;
      }
      
      .card-panel {
        padding: 16px;
      }
      
      .product-detail-main-image {
        height: 250px;
      }
      
      .product-detail-thumbnail {
        width: 60px;
        height: 60px;
      }
      
      /* Keep 2 columns on very small screens */
      .product-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      
      /* Banner carousel mobile */
      .banner-carousel {
        height: 120px;
      }
    }

    /* Copyright Section */
    .copyright {
      text-align: center;
      padding: 20px;
      background-color: var(--card);
      color: var(--muted);
      font-size: 14px;
      border-top: 1px solid var(--border);
      transition: var(--transition);
    }
  </style>

</head>
<body>
  <!-- Mobile Menu Overlay -->
  <div class="menu-overlay" id="menuOverlay"></div>
  
  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <div class="menu-header">
      <div class="brand">
        <span class="chip">BUYZO</span>
        <span>Cart</span>
      </div>
      <div class="menu-close" id="menuClose">×</div>
    </div>
    <div class="menu-items">
      <div class="menu-item" onclick="showPage('homePage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
        Home
      </div>
      <div class="menu-item" onclick="showPage('productsPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        Products
      </div>
      <div class="menu-item" onclick="showMyOrders(); showPage('myOrdersPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="20" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
        My Orders
      </div>
      <div class="menu-item" onclick="showPage('wishlistPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>
        Wishlist
      </div>
      <div class="menu-item" onclick="showPage('cancellationPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="15" y1="9" x2="9" y2="15"></line>
          <line x1="9" y1="9" x2="15" y2="15"></line>
        </svg>
        Refund & Cancellation
      </div>
      <div class="menu-item" onclick="showPage('termsPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        Terms & Conditions
      </div>
      <div class="menu-item" onclick="showPage('shippingPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 15a5 5 0 0 1 5-5h8a5 5 0 0 1 5 5v0a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5v0z"></path>
          <path d="M3 15V9a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v6"></path>
          <path d="M9 19h6"></path>
        </svg>
        Shipping Policy
      </div>
      <div class="menu-item" onclick="showPage('privacyPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
        </svg>
        Privacy Policy
      </div>
      <div class="menu-item" onclick="showPage('contactPage'); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
          <polyline points="22,6 12,13 2,6"></polyline>
        </svg>
        Contact Us
      </div>
      
      <!-- Login/Signup at the bottom of mobile menu -->
      <div class="menu-item" id="mobileLoginBtn" onclick="showLoginModal(); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        Login / Sign Up
      </div>
      <div class="menu-item" id="mobileUserProfile" style="display:none;" onclick="toggleUserMenu(); closeMenu();">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        <span id="mobileUserName">User</span>
      </div>
    </div>
  </div>

  <header>
    <div class="header-inner">
      <div class="menu-icon" id="menuIcon">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div class="brand" aria-label="Buyzo Cart brand" onclick="showPage('homePage')">
        <span class="chip">BUYZO</span>
        <span>Cart</span>
      </div>
      <div class="cta">
        <!-- Theme Toggle Button -->
        <button class="theme-toggle" id="themeToggle" title="Toggle Light/Dark Mode">
          <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
        
        <button class="btn secondary" id="openContactTop" title="Contact">Contact</button>
        <button class="btn secondary" id="openMyOrdersTop" title="My Orders">My Orders
          <span id="ordersNotification" class="notification-badge" style="display:none"></span>
        </button>
        <!-- Login/Signup buttons -->
        <button class="btn secondary" id="openLoginTop" title="Login">Login</button>
        <div class="user-profile" id="userProfile" style="display:none;">
          <div class="user-avatar" id="userAvatar">U</div>
          <div class="user-name" id="userName">User</div>
          <div class="account-dropdown" id="accountDropdown">
            <div class="account-dropdown-item" id="accountEmail">user@example.com</div>
            <div class="account-dropdown-item" onclick="logout()">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
              </svg>
              Logout
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Home Page -->
    <section class="page active" id="homePage">
      
      <section class="hero">
        <h1>Welcome to <span style="color:var(--accent)">Buyzo Cart</span></h1>
        <p>Clean, fast checkout. Hand‑picked products. Fully responsive UI.</p>

        <!-- Rotating subtle messages -->
        <div class="hero-messages" id="heroMessages">
          <span class="active">🔥 Big Sale Today</span>
          <span>🚚 Free Shipping over ₹999</span>
          <span>✨ New Arrivals Just Dropped</span>
        </div>

        <!-- Highlight CTA strip -->
        <div class="highlight-strip" onclick="showPage('productsPage')">
          Limited Time Offer: Flat 40% OFF on all Fashion Items — <u>Shop Now →</u>
        </div>
      </section>

      <!-- NEW: Banner Carousel -->
      <div class="banner-carousel" id="bannerCarousel">
        <div class="banner-track" id="bannerTrack"></div>
        <div class="banner-controls" id="bannerControls"></div>
      </div>

      <!-- TRENDING NOW SECTION -->
      <div class="trending-section">
        <div class="trending-header">
          <h2 class="trending-title">Trending Now</h2>
        </div>
        <div class="slider-container">
          <div class="slider-track" id="productSlider"></div>
        </div>
      </div>

      <!-- NEW: Category Circles Section -->
      <div class="category-circles">
        <h2 class="category-circles-title">Shop by Category</h2>
        <div class="category-circles-container" id="categoryCirclesContainer"></div>
      </div>

      <!-- SEARCH BAR -->
      <div class="search-wrap">
        <input id="homeSearchInput" placeholder="Search products (e.g. 'Sneakers', 'T-shirt', 'Earbuds')" />
      </div>

      <!-- Search Results Grid -->
      <div id="homeSearchResults" style="display:none;"></div>

      <div class="steps center">
        <div class="step-pill" id="pill-products">1 • Products</div>
        <div class="step-pill disabled" id="pill-order">2 • Order Details</div>
        <div class="step-pill disabled" id="pill-user">3 • Your Info</div>
        <div class="step-pill disabled" id="pill-pay">4 • Payment</div>
      </div>

      <div class="card-panel" style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
        <h2 style="margin:0">Featured Products</h2>
      </div>

      <!-- Featured Products Grid -->
      <div class="product-grid" id="homeProductGrid">
        <!-- Product cards will be loaded here -->
      </div>

      <!-- Recently Viewed Products Section -->
      <div class="recently-viewed" id="recentlyViewedSection" style="display:none;">
        <h2 class="recently-viewed-title">Recently Viewed</h2>
        <div class="slider-container">
          <div class="slider-track" id="recentlyViewedSlider"></div>
        </div>
      </div>

      <!-- Newsletter Subscription Section -->
      <div class="newsletter-section">
        <h2 class="newsletter-title">Stay Updated</h2>
        <p class="newsletter-desc">Subscribe to our newsletter for exclusive deals, new arrivals, and special offers delivered to your inbox.</p>
        <div class="newsletter-form">
          <input type="email" class="newsletter-input" placeholder="Enter your email" id="newsletterEmail" />
          <button class="newsletter-btn" id="subscribeBtn">Subscribe</button>
        </div>
      </div>
    </section>

    <!-- Products Page -->
    <section class="page" id="productsPage">
      <div class="card-panel" style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
        <h2 style="margin:0">All Products</h2>
      </div>

      <!-- Price Filter - Simplified -->
      <div class="price-filter">
        <div class="price-filter-title">Filter by Price</div>
        <div class="price-range-slider">
          <input type="range" min="0" max="5000" value="0" class="price-slider" id="minPriceSlider">
          <input type="range" min="0" max="5000" value="5000" class="price-slider" id="maxPriceSlider">
          <div class="price-range-values">
            <span id="minPriceValue">₹0</span>
            <span id="maxPriceValue">₹5000</span>
          </div>
        </div>
        <div class="price-range" style="margin-top: 12px;">
          <input type="number" class="price-input" id="minPrice" placeholder="Min" min="0" />
          <span>to</span>
          <input type="number" class="price-input" id="maxPrice" placeholder="Max" min="0" />
          <button class="btn secondary" id="applyPriceFilter">Apply</button>
          <button class="btn secondary" id="resetPriceFilter">Reset</button>
        </div>
      </div>

      <!-- Search bar -->
      <div class="search-wrap">
        <input id="searchInput" placeholder="Search products (e.g. 'Sneakers', 'T-shirt', 'Earbuds')" />
      </div>

      <!-- Category Navigation -->
      <div class="categories" id="categoriesContainer">
        <!-- Categories will be loaded from Firebase by admin -->
      </div>

      <div class="product-grid" id="productGrid">
        <!-- Product cards will be loaded here -->
      </div>
    </section>

    <!-- Product Detail Page -->
    <section class="page" id="productDetailPage">
      <div class="product-detail-page">
        <!-- Breadcrumb Navigation -->
        <div class="breadcrumb">
          <a href="#" onclick="showPage('homePage')">Home</a>
          <span>></span>
          <a href="#" onclick="showPage('productsPage')">Products</a>
          <span>></span>
          <span id="breadcrumbProductName">Product Details</span>
        </div>
        
        <div class="back-to-products" onclick="showPage('productsPage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Products
        </div>
        
        <div class="product-detail-container">
          <div class="product-detail-gallery">
            <!-- Enhanced gallery with zoom -->
            <div class="product-gallery-zoom">
              <div class="product-detail-main-image" id="detailMainImage" onclick="openImageZoom()">
                <button class="detail-carousel-control prev">&#10094;</button>
                <button class="detail-carousel-control next">&#10095;</button>
                <div class="detail-carousel-dots" id="detailCarouselDots"></div>
                <div class="zoom-indicator">Click to zoom</div>
              </div>
            </div>
            <div class="product-detail-thumbnails" id="detailThumbnails"></div>
          </div>
          
          <div class="product-detail-info">
            <h1 class="product-detail-title" id="detailTitle"></h1>
            <!-- Product SKU -->
            <div class="product-sku" id="detailSku"></div>
            <div class="product-detail-price" id="detailPrice"></div>
            <!-- Stock Status -->
            <div class="stock-status in-stock" id="detailStockStatus">In Stock</div>
            <div class="product-detail-desc" id="detailDesc"></div>
            <div class="product-detail-full-desc" id="detailFullDesc"></div>
            
            <!-- NEW: Share Link Section -->
            <div class="product-detail-meta" style="margin-top: 20px;">
              <h4>Share This Product</h4>
              <div style="display: flex; gap: 10px; margin-top: 10px;">
                <input type="text" id="productShareLink" readonly style="flex: 1; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius); background: #f8fafc;">
                <button class="btn secondary" id="copyShareLink">Copy Link</button>
              </div>
            </div>
            
            <!-- Social Sharing Buttons -->
            <div class="social-sharing">
              <button class="share-btn facebook" data-platform="facebook">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
                Share
              </button>
              <button class="share-btn twitter" data-platform="twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                </svg>
                Tweet
              </button>
              <button class="share-btn whatsapp" data-platform="whatsapp">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                </svg>
                Share
              </button>
            </div>
            
            <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:20px;">
              <button class="btn" id="detailOrderBtn">Order Now</button>
              <button class="btn secondary" id="detailWishlistBtn">Add to Wishlist</button>
              <button class="btn secondary" onclick="showPage('productsPage')">Continue Shopping</button>
            </div>
          </div>
        </div>

        <!-- Similar Products Section -->
        <div class="similar-products">
          <h2 class="similar-title">Similar Products</h2>
          <div class="slider-container">
            <div class="slider-track" id="similarProductsSlider"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Order Details Page -->
    <section class="page" id="orderPage">
      <div class="card-panel">
        <h3 style="margin-top:0">Order Details</h3>
        <p style="color:var(--muted)">Choose size/quantity and confirm product before entering contact or payment details.</p>

        <div id="selectedProductCard" class="card" style="margin-bottom:16px">
          <div style="display:flex;gap:16px;flex-direction:column">
            <div id="galleryMain" class="gallery-main">
              <button class="carousel-control prev">&#10094;</button>
              <button class="carousel-control next">&#10095;</button>
              <div class="carousel-dots"></div>
            </div>
          </div>
          <div class="card-body">
            <div class="title" id="spTitle"></div>
            <div class="price" id="spPrice"></div>
            <div class="badge" id="spDesc"></div>
            
            <!-- Product Details Section -->
            <div class="product-details">
              <h4>Product Details</h4>
              <p id="spFullDesc"></p>
            </div>

            <div style="margin-top:auto">
              <!-- Updated: Size/Color Selection -->
              <label>Select size / colour</label>
              <div class="size-color-options">
                <div class="size-option selected" data-value="S">S</div>
                <div class="size-option" data-value="M">M</div>
                <div class="size-option" data-value="L">L</div>
                <div class="size-option" data-value="XL">XL</div>
              </div>
              <div class="size-validation-error" id="sizeValidationError">Please select a size to continue</div>

            <div style="height:12px"></div>
              <label>Quantity</label>
              <!-- Replaced with plus/minus quantity control -->
              <div class="quantity-control">
                <button class="qty-minus">-</button>
                <input type="number" id="qtySelect" min="1" value="1" readonly>
                <button class="qty-plus">+</button>
              </div>

              <div style="height:16px"></div>
              <div style="display:flex;gap:10px;flex-wrap:wrap">
                <button id="toUserInfo" class="btn" style="flex:1">Continue → Provide Your Info</button>
                <button id="backToProducts" class="btn secondary" style="flex:1">Back to Products</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- User Info Page -->
    <section class="page" id="userPage">
      <div class="card-panel">
        <h3 style="margin-top:0">Your Contact & Delivery Address</h3>
        <p style="color:var(--muted)">We do not use saved addresses. Please provide a fresh delivery address for this order.</p>

        <div style="display:flex;gap:16px;flex-direction:column">
          <div>
            <label>Full Name *</label>
            <input id="fullname" placeholder="Enter full name" />
          </div>
          <div class="row">
            <div class="col"><label>Mobile Number *</label><input id="mobile" placeholder="10-digit mobile number" /></div>
            <div class="col"><label>Pincode *</label><input id="pincode" placeholder="Pincode" /></div>
          </div>
          <div class="row">
            <div class="col"><label>City *</label><input id="city" /></div>
            <div class="col"><label>State *</label><input id="state" /></div>
          </div>
          <div>
            <label>House / Street *</label>
            <input id="house" />
          </div>
          <div style="display:flex;gap:10px;margin-top:16px;flex-wrap:wrap">
            <button id="toPayment" class="btn" style="flex:1">Continue to Payment</button>
            <button id="editOrder" class="btn secondary" style="flex:1">Edit Order Details</button>
            <button id="saveUserInfo" class="btn secondary" style="flex:1">Save Information</button>
          </div>
          <div style="margin-top:16px;color:var(--muted);font-size:14px">
            <strong>Note:</strong> If you prefer to change products, click "Edit Order Details" or use "Products" to go back.
          </div>
        </div>
      </div>
    </section>

    <!-- Payment Page -->
    <section class="page" id="paymentPage">
      <div class="card-panel">
        <h3 style="margin-top:0">Payment Method</h3>
        <div style="display:flex;gap:12px;flex-wrap:wrap;margin-bottom:16px">
          <label style="flex:1;display:flex;align-items:center;gap:8px;padding:12px;border:1px solid var(--border);border-radius:var(--radius);cursor:pointer;">
            <input type="radio" name="pay" value="prepaid" checked /> Prepaid (UPI / Card)
          </label>
          <label style="flex:1;display:flex;align-items:center;gap:8px;padding:12px;border:1px solid var(--border);border-radius:var(--radius);cursor:pointer;">
            <input type="radio" name="pay" value="cod" /> Cash on Delivery (Note: may increase processing time)
          </label>
        </div>
        
        <div class="summary">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px"><div>Product</div><div id="sumProduct">-</div></div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px"><div>Qty</div><div id="sumQty">-</div></div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px"><div>Price</div><div id="sumPrice">-</div></div>
          <div style="display:flex;justify-content:space-between;margin-bottom:12px;padding-bottom:8px;border-bottom:1px dashed var(--border)"><div>Delivery</div><div id="sumDel">₹50</div></div>
          <div style="display:flex;justify-content:space-between;font-weight:700;margin-top:8px;font-size:18px"><div>Total</div><div id="sumTotal">-</div></div>
        </div>
        
        <div style="height:16px"></div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <button id="confirmOrder" class="btn" style="flex:1">Confirm & Place Order</button>
          <button id="payBack" class="btn secondary" style="flex:1">Back</button>
        </div>
      </div>
    </section>

    <!-- Order Success (hidden) -->
    <section class="page center" id="successPage">
      <div class="card-panel" style="max-width:520px;margin:32px auto;padding:32px">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin:0 auto 16px">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <div style="font-size:24px;font-weight:700;color:var(--success);margin-bottom:8px">Thank You for Your Order!</div>
        <div style="margin-top:10px;color:var(--muted)">Your order has been placed successfully! We will confirm and process your order. Tracking will be shared once supplier ships it.</div>
        <div style="margin-top:24px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
          <button id="goHome" class="btn">Back to Home</button>
          <button id="viewOrders" class="btn secondary">View My Orders</button>
        </div>
      </div>
    </section>

    <!-- My Orders Page -->
    <section class="page" id="myOrdersPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        
        <div class="orders-container">
          <h2>My Orders</h2>
          <p style="color:var(--muted);margin-bottom:24px">View and manage your recent orders</p>
          
          <div id="ordersList">
            <!-- Orders will be dynamically inserted here -->
          </div>
          
          <div id="noOrders" class="card-panel center" style="display:none">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--muted-light)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <h3 style="margin:16px 0 8px;color:var(--muted)">No orders yet</h3>
            <p style="color:var(--muted-light)">You haven't placed any orders yet. Start shopping to see your orders here.</p>
            <button class="btn" style="margin-top:16px" onclick="showPage('productsPage')">Start Shopping</button>
            </div>
        </div>
      </div>
    </section>

    <!-- Order Detail Page -->
    <section class="page" id="orderDetailPage">
      <div class="policy-page">
        <div class="back-button" onclick="showMyOrders(); showPage('myOrdersPage');">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to My Orders
        </div>
        
        <div class="orders-container">
          <h2>Order Details</h2>
          
          <div class="order-detail-page" id="orderDetailContent">
            <!-- Order details will be dynamically inserted here -->
          </div>
        </div>
      </div>
    </section>

    <!-- Wishlist Page -->
    <section class="page" id="wishlistPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        
        <div class="orders-container">
          <h2>My Wishlist</h2>
          <p style="color:var(--muted);margin-bottom:24px">Your favorite products</p>
          
          <div id="wishlistGrid" class="product-grid">
            <!-- Wishlist items will be dynamically inserted here -->
          </div>
          
          <div id="noWishlist" class="card-panel center" style="display:none">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--muted-light)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            <h3 style="margin:16px 0 8px;color:var(--muted)">Your wishlist is empty</h3>
            <p style="color:var(--muted-light)">Start adding products to your wishlist to see them here.</p>
            <button class="btn" style="margin-top:16px" onclick="showPage('productsPage')">Start Shopping</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Policy Pages -->
    <section class="page" id="contactPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Contact Us</h2>
          <p>We're here to help with any questions or concerns about your order or our products.</p>
          
          <h3>Our Address</h3>
          <p>Jwalapur, Haridwar, Uttarakhand - 249401<br>India</p>
          
          <h3>Customer Support Hours</h3>
          <p>Monday to Saturday: 10:00 AM to 7:00 PM IST<br>
          Sunday: Closed</p>
          
          <h3>Email</h3>
          <p>For order-related queries: <a href="mailto:buyzocartshop@gmail.com">buyzocartshop@gmail.com</a></p>

          <h3>Telegram Support</h3>
          <p>For quick assistance: <a href="https://t.me/Buyzocartsupport" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M9.999 15.17 9.95 20c.64 0 .92-.27 1.26-.59l3.02-2.88 6.25 4.55c1.15.63 1.97.3 2.26-1.06L23.95 3.47c.37-1.48-.54-2.06-1.65-1.7L1.62 9.63c-1.45.57-1.43 1.36-.25 1.72l5.91 1.84 13.69-8.65c.65-.4 1.25-.18.76.25"/></svg></a></p>
          
          <h3>Response Time</h3>
          <p>We strive to respond to all emails within <strong>24 business hours</strong>.</p>
          
          <h3>Order Issues</h3>
          <p>When contacting us about an order, please include your order ID for faster resolution.</p>
        </div>
      </div>
    </section>

    <section class="page" id="cancellationPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin" round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Refund & Cancellation Policy</h2>
          <p>At Buyzo, we value our customers and aim to provide a smooth shopping experience.</p>

          <h3>Order Cancellation</h3>
          <p>Orders can be cancelled within <strong>24 hours</strong> of placing them. Once the order is processed/shipped, cancellation requests will not be accepted.</p>

          <h3>Refunds</h3>
          <p>If you cancel your order within the allowed time, the amount will be refunded to your original payment method within <strong>5–7 working days</strong>.</p>

          <h3>Payment Gateway Charges</h3>
          <p>Please note that payment gateway charges (approx <strong>2–3% of the order value</strong>) are non-refundable. For example, if you placed an order of ₹100 and cancelled it, the refund amount will be ₹97–₹98. This deduction is due to Razorpay's non-refundable transaction fee.</p>

          <h3>Contact Us</h3>
  <p>
          For refund or cancellation requests, please contact us at:<br>
          Email: <strong>buyzocartshop@gmail.com</strong><br>
          Telegram: <a href="https://t.me/Buyzocartsupport" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M9.999 15.17 9.95 20c.64 0 .92-.27 1.26-.59l3.02-2.88 6.25 4.55c1.15.63 1.97.3 2.26-1.06L23.95 3.47c.37-1.48-.54-2.06-1.65-1.7L1.62 9.63c-1.45.57-1.43 1.36-.25 1.72l5.91 1.84 13.69-8.65c.65-.4 1.25-.18.76.25"/></svg></a>
          </p>
        </div>
      </div>
    </section>

    <section class="page" id="termsPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Terms & Conditions</h2>
          <p>Welcome to <strong>Buyzo Cart</strong>. By placing an order on our website, you agree to the terms below.</p>
          
          <h3>1. Service Model</h3>
          <p>We operate a <strong>dropshipping</strong> model. Products are sourced from third‑party suppliers and shipped directly to you. Images shown are for representation and minor variations may occur.</p>
          
          <h3>2. Orders & Pricing</h3>
          <p>All prices are in INR and inclusive of applicable taxes unless stated. An order is confirmed only after successful payment authorization. We reserve the right to cancel and refund any order due to stock, pricing, or verification issues.</p>
          
          <h3>3. Delivery</h3>
          <p>Estimated delivery time is displayed at checkout. Delays may occur due to courier logistics or festivals. We are not liable for delays once the order is handed over to the courier.</p>
          
          <h3>4. Customer Responsibilities</h3>
          <p>Please provide accurate contact details and delivery address. Incorrect information may cause delays or non‑delivery.</p>
          
          <h3>5. Prohibited Use</h3>
          <p>Do not misuse the website, attempt unauthorized access, or submit fraudulent orders.</p>
          
          <h3>6. Liability</h3>
          <p>To the maximum extent permitted by law, our liability is limited to the order value paid by you.</p>
          
          <h3>7. Contact</h3>
          <p>For any support, email us at <a href="mailto:buyzocartshop@gmail.com">buyzocartshop@gmail.com</a></p>
        </div>
      </div>
    </section>

    <section class="page" id="shippingPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height:20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Shipping Policy</h2>
          
          <h3>1. Processing Time</h3>
          <p>Orders are processed within <strong>1-2 business days</strong> after payment confirmation. Business days are Monday to Saturday, excluding public holidays.</p>
          
          <h3>2. Shipping Timeline</h3>
          <p>Delivery usually takes 5–10 working days depending on location.</p>
          
          <h3>3. Shipping Methods</h3>
          <ul>
            <li><strong>Standard Shipping</strong>: 5-7 business days (₹50)</li>
            <li><strong>Express Shipping</strong>: 2-4 business days (₹150)</li>
          </ul>
          
          <h3>4. Shipping Areas</h3>
          <p>We currently ship to all major cities and towns across India. For remote locations, additional delivery time may be required.</p>
          
          <h3>5. Order Tracking</h3>
          <p>Once your order is shipped, you will receive a confirmation email with tracking information. You can track your order using the provided tracking number.</p>
          
          <h3>6. Undeliverable Orders</h3>
          <p>If a delivery attempt fails due to incorrect address or recipient unavailable, the package will be returned to us. Additional shipping charges will apply for redelivery.</p>
          
          <h3>7. International Shipping</h3>
          <p>Currently, we only ship within India. International shipping is not available.</p>
        </div>
      </div>
    </section>

    <section class="page" id="privacyPage">
      <div class="policy-page">
        <div class="back-button" onclick="showPage('homePage')">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back to Home
        </div>
        <div class="policy-content">
          <h2>Privacy Policy</h2>
          
          <h3>1. Information We Collect</h3>
          <p>We collect information you provide during checkout: name, contact number, email (if provided), shipping address, and payment details. We do not store payment card details.</p>
          
          <h3>2. Use of Information</h3>
          <p>Your information is used solely to process and deliver your order, provide customer support, and send order updates.</p>
          
          <h3>3. Data Sharing</h3>
          <p>We share your name, address, and contact number with our shipping partners to deliver your order. We do not sell or rent your personal data to third parties.</p>
          
          <h3>4. Data Security</h3>
          <p>We implement reasonable security measures to protect your personal information.</p>
          
          <h3>5. Cookies</h3>
          <p>We use cookies to enhance your browsing experience and remember items in your cart.</p>
          
          <h3>6. Your Rights</h3>
          <p>You can request details of your personal data we hold or request deletion by contacting us.</p>
          
          <h3>7. Changes to Policy</h3>
          <p>We may update this policy periodically. Continued use of our services implies acceptance of the updated policy.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- About Us Section -->
  <div class="about-us">
    <h3>About Buyzo Cart</h3>
    <p>Buyzo Cart is a modern e-commerce platform offering carefully curated products at competitive prices. We focus on providing an exceptional shopping experience with fast delivery and excellent customer service.</p>
  </div>

  <footer>
    <div style="display:flex;justify-content:center;gap:16px;margin-bottom:16px;flex-wrap:wrap">
      <a href="#" onclick="showPage('contactPage')">Contact</a>
      <a href="#" onclick="showPage('cancellationPage')">Refund & Cancellation</a>
      <a href="#" onclick="showPage('termsPage')">Terms & Conditions</a>
      <a href="#" onclick="showPage('shippingPage')">Shipping Policy</a>
      <a href="#" onclick="showPage('privacyPage')">Privacy Policy</a>
    </div>
    <div>© 2025 Buyzo Cart — Made with ♥ in India</div>
  </footer>

  <!-- Copyright Section -->
  <div class="copyright">
    <p>© 2025 Buyzo Cart. All rights reserved.</p>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast">
    <div class="toast-icon">✓</div>
    <div class="toast-message">Operation completed successfully</div>
  </div>

  <!-- Cancellation Modal -->
  <div class="modal-overlay" id="cancellationModal">
    <div class="cancellation-modal">
      <h3>Select Cancellation Reason</h3>
      <div class="cancellation-reason selected">
        <input type="radio" name="cancelReason" value="change-of-mind" checked> Change of mind / Ordered by mistake
      </div>
      <div class="cancellation-reason">
        <input type="radio" name="cancelReason" value="shipping-delay"> Shipping takes too long
      </div>
      <div class="cancellation-reason">
        <input type="radio" name="cancelReason" value="found-better-price"> Found better price elsewhere
      </div>
      <div class="cancellation-reason">
        <input type="radio" name="cancelReason" value="other"> Other reason
      </div>
      <div class="cancellation-actions">
        <button class="btn secondary" id="cancelCancellation">Cancel</button>
        <button class="btn error" id="confirmCancellation">Confirm Cancellation</button>
      </div>
    </div>
  </div>

  <!-- Cancel Order Flow Modal -->
  <div class="modal-overlay" id="cancelConfirmModal">
    <div class="cancel-confirm-modal">
      <h3>Cancel Order</h3>
      <p>Are you sure you want to cancel this order? This action cannot be undone.</p>
      
      <div class="payment-charge-note">
        <strong>Note:</strong> Payment gateway charges (2-3% of order value) are non-refundable as per our policy.
      </div>
      
      <div class="refund-calculation">
        <p><strong>Refund Calculation:</strong></p>
        <p>Order Amount: <span id="refundOrderAmount">₹0</span></p>
        <p>Payment Gateway Charges: <span id="refundCharges">₹0</span></p>
        <p><strong>Refund Amount: <span id="refundAmount">₹0</span></strong></p>
      </div>
      
      <div class="cancel-confirm-actions">
        <button class="btn secondary" id="cancelCancel">Cancel</button>
        <button class="btn error" id="confirmCancel">Yes, Cancel Order</button>
      </div>
    </div>
  </div>

  <!-- Alert Modal -->
  <div class="modal-overlay" id="alertModal">
    <div class="alert-modal">
      <div class="alert-icon">⚠️</div>
      <h3>Are you sure?</h3>
      <p id="alertMessage">This action cannot be undone.</p>
      <div class="alert-modal-buttons">
        <button class="btn secondary" id="alertCancel">Cancel</button>
        <button class="btn error" id="alertConfirm">Yes</button>
      </div>
    </div>
  </div>

  <!-- Login/Signup Modal -->
  <div class="modal-overlay" id="authModal">
    <div class="auth-modal">
      <button class="auth-close" id="authClose">×</button>
      <h3 id="authModalTitle">Welcome to Buyzo Cart</h3>
      
      <div class="auth-tabs">
        <div class="auth-tab active" id="loginTab">Login</div>
        <div class="auth-tab" id="signupTab">Sign Up</div>
      </div>
      
      <!-- Login Form -->
      <form class="auth-form active" id="loginForm">
        <div class="auth-form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" placeholder="Enter your email" required>
        </div>
        <div class="auth-form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" placeholder="Enter your password" required>
        </div>
        <button type="submit" class="btn" style="width: 100%; margin-top: 16px;">Login</button>
        <div class="auth-form-footer">
          <a id="showForgotPassword">Forgot Password?</a>
        </div>
      </form>
      
      <!-- Forgot Password Form -->
      <form class="forgot-password-form" id="forgotPasswordForm">
        <div class="auth-form-group">
          <label for="forgotEmail">Email</label>
          <input type="email" id="forgotEmail" placeholder="Enter your email" required>
        </div>
        <button type="submit" class="btn" style="width: 100%; margin-top: 16px;">Reset Password</button>
        <div class="back-to-login" id="backToLogin">Back to Login</div>
      </form>
      
      <!-- Signup Form -->
      <form class="auth-form" id="signupForm">
        <div class="auth-form-group">
          <label for="signupName">Full Name</label>
          <input type="text" id="signupName" placeholder="Enter your full name" required>
        </div>
        <div class="auth-form-group">
          <label for="signupEmail">Email</label>
          <input type="email" id="signupEmail" placeholder="Enter your email" required>
        </div>
        <div class="auth-form-group">
          <label for="signupPassword">Password</label>
          <input type="password" id="signupPassword" placeholder="Create a password" required>
        </div>
        <div class="auth-form-group">
          <label for="signupConfirmPassword">Confirm Password</label>
          <input type="password" id="signupConfirmPassword" placeholder="Confirm your password" required>
        </div>
        <button type="submit" class="btn" style="width: 100%; margin-top: 16px;">Sign Up</button>
      </form>
      
      <div class="divider">
        <span>or</span>
      </div>
      
      <button class="google-signin-btn" id="googleSignIn">
        <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google">
        Continue with Google
      </button>
    </div>
  </div>

  <!-- Image Zoom Modal -->
  <div class="modal-overlay zoom-modal" id="zoomModal">
    <div class="zoom-content">
      <button class="zoom-close" id="zoomClose">×</button>
      <img class="zoom-image" id="zoomImage" src="" alt="Zoomed Product Image">
      <div class="zoom-controls">
        <button class="zoom-btn" id="zoomOut">-</button>
        <button class="zoom-btn" id="zoomIn">+</button>
      </div>
    </div>
  </div>

  <script>
    // =============================================
    // EMAILJS + FIREBASE REALTIME DATABASE INTEGRATION
    // =============================================
    
    // EmailJS Configuration
    (function() {
      emailjs.init("JvkKRLBYjYK-hmB-G");
      console.log("✅ EmailJS initialized successfully");
    })();
    
    // Firebase Realtime Database Configuration
    const orderFirebaseConfig = {
      apiKey: "AIzaSyAeB7VzIxJaNYagUPoKd-kN5HXmLbS2-Vw",
      authDomain: "videomanager-23d98.firebaseapp.com",
      databaseURL: "https://videomanager-23d98-default-rtdb.firebaseio.com",
      projectId: "videomanager-23d98",
      storageBucket: "videomanager-23d98.firebasestorage.app",
      messagingSenderId: "847321523576",
      appId: "1:847321523576:web:bda3f5026e3e163603548d",
      measurementId: "G-YBSJ1KMPV4"
    };
    
    // Initialize Order Firebase App (separate from existing Firebase)
    let orderDatabase;
    try {
      const orderFirebaseApp = firebase.initializeApp(orderFirebaseConfig, "OrderFirebase");
      orderDatabase = orderFirebaseApp.database();
      console.log("✅ Order Firebase initialized successfully");
    } catch (error) {
      console.log("ℹ️ Order Firebase already initialized");
      orderDatabase = firebase.app("OrderFirebase").database();
    }
    
    // Function to send order confirmation email
    function sendOrderEmail(orderData) {
      const templateParams = {
        user_name: orderData.name,
        order_id: orderData.orderId,
        user_email: orderData.email,
        item_list: orderData.items,
        delivery_date: orderData.deliveryDate
      };
      
      emailjs.send('service_m70ov9i', 'template_91ixptn', templateParams)
        .then(function(response) {
          console.log("✅ Order Email Sent Successfully!", response.status, response.text);
        }, function(error) {
          console.log("❌ Failed to send email.", error);
        });
    }
    
    // Listen for new orders in Firebase Realtime Database
    function setupOrderListener() {
      const ordersRef = orderDatabase.ref('orders');
      
      ordersRef.on('child_added', function(snapshot) {
        const orderData = snapshot.val();
        console.log('New order detected:', orderData);
        
        // Send email for the new order
        sendOrderEmail(orderData);
      });
      
      console.log("🎯 Firebase listener activated. Monitoring for new orders...");
    }
    
    // Initialize the order monitoring system
    function initializeOrderSystem() {
      console.log("🛒 Initializing Buyzo Cart Order Email System...");
      setupOrderListener();
      console.log("✅ Order email system ready! Emails will be sent automatically for new orders.");
    }
    
    // Start the order system when page loads
    window.addEventListener('load', function() {
      // Small delay to ensure everything else is loaded
      setTimeout(initializeOrderSystem, 1000);
    });
    
    // =============================================
    // EXISTING CODE (KEEPING ALL ORIGINAL FUNCTIONALITY)
    // =============================================
    
    // Firebase Configuration for existing app
    const firebaseConfig = {
      apiKey: "AIzaSyDxW9Xc8y5X5Z5Q5X5Q5X5Q5X5Q5X5Q5X5Q",
      authDomain: "buyzo-cart.firebaseapp.com",
      databaseURL: "https://buyzo-cart-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "buyzo-cart",
      storageBucket: "buyzo-cart.appspot.com",
      messagingSenderId: "123456789",
      appId: "1:123456789:web:abcdef123456"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    const database = firebase.database();

    // Global variables
    let products = [];
    let categories = [];
    let banners = [];
    let selectedProduct = null;
    let selectedSize = 'S';
    let selectedQuantity = 1;
    let userInfo = {};
    let currentUser = null;
    let currentOrderId = null;
    let wishlist = [];
    let recentlyViewed = [];
    let zoomLevel = 1;
    let currentBannerIndex = 0;
    let bannerInterval;

    // Local Cache Keys
    const CACHE_KEYS = {
      PRODUCTS: 'products_cache',
      CATEGORIES: 'categories_cache',
      BANNERS: 'banners_cache',
      WISHLIST: 'wishlist_cache',
      RECENTLY_VIEWED: 'recently_viewed_cache',
      ORDERS: 'guest_orders_cache'
    };

    // Local Cache Functions
    function saveToCache(key, data) {
      try {
        localStorage.setItem(key, JSON.stringify(data));
      } catch (error) {
        console.error('Error saving to cache:', error);
      }
    }

    function loadFromCache(key) {
      try {
        const cached = localStorage.getItem(key);
        return cached ? JSON.parse(cached) : null;
      } catch (error) {
        console.error('Error loading from cache:', error);
        return null;
      }
    }

    function clearCache(key) {
      try {
        localStorage.removeItem(key);
      } catch (error) {
        console.error('Error clearing cache:', error);
      }
    }

    // DOM Elements
    const pages = document.querySelectorAll('.page');
    const homePage = document.getElementById('homePage');
    const productsPage = document.getElementById('productsPage');
    const productDetailPage = document.getElementById('productDetailPage');
    const orderPage = document.getElementById('orderPage');
    const userPage = document.getElementById('userPage');
    const paymentPage = document.getElementById('paymentPage');
    const successPage = document.getElementById('successPage');
    const myOrdersPage = document.getElementById('myOrdersPage');
    const orderDetailPage = document.getElementById('orderDetailPage');
    const wishlistPage = document.getElementById('wishlistPage');
    const contactPage = document.getElementById('contactPage');
    const cancellationPage = document.getElementById('cancellationPage');
    const termsPage = document.getElementById('termsPage');
    const shippingPage = document.getElementById('shippingPage');
    const privacyPage = document.getElementById('privacyPage');

    // Theme Toggle
    const themeToggle = document.getElementById('themeToggle');
    const currentTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', currentTheme);

    themeToggle.addEventListener('click', () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    });

    // Mobile Menu
    const menuIcon = document.getElementById('menuIcon');
    const mobileMenu = document.getElementById('mobileMenu');
    const menuOverlay = document.getElementById('menuOverlay');
    const menuClose = document.getElementById('menuClose');

    menuIcon.addEventListener('click', openMenu);
    menuClose.addEventListener('click', closeMenu);
    menuOverlay.addEventListener('click', closeMenu);

    function openMenu() {
      mobileMenu.classList.add('active');
      menuOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeMenu() {
      mobileMenu.classList.remove('active');
      menuOverlay.classList.remove('active');
      document.body.style.overflow = '';
    }

    // Page Navigation
    function showPage(pageId) {
      pages.forEach(page => page.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
      
      // Update step pills based on current page
      updateStepPills(pageId);
      
      // Close mobile menu when navigating
      closeMenu();
    }

    function updateStepPills(pageId) {
      const pills = ['pill-products', 'pill-order', 'pill-user', 'pill-pay'];
      const pageIndex = {
        'homePage': 0, 'productsPage': 0, 'productDetailPage': 0,
        'orderPage': 1, 'userPage': 2, 'paymentPage': 3, 'successPage': 3
      }[pageId] || 0;

      pills.forEach((pillId, index) => {
        const pill = document.getElementById(pillId);
        if (index <= pageIndex) {
          pill.classList.remove('disabled');
        } else {
          pill.classList.add('disabled');
        }
      });
    }

    // Toast Notification
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastMessage = toast.querySelector('.toast-message');
      
      toastMessage.textContent = message;
      toast.className = `toast ${type}`;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Product Card Creation
    function createProductCard(product) {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.onclick = () => showProductDetail(product);
      
      // Generate random discount between 10% and 50%
      const discount = Math.floor(Math.random() * 41) + 10;
      
      // Calculate original price
      const originalPrice = Math.round(product.price * (100 + discount) / 100);
      
      // Generate random rating between 3.5 and 5.0
      const rating = (Math.random() * 1.5 + 3.5).toFixed(1);
      
      // Generate random review count between 100 and 2000
      const reviewCount = Math.floor(Math.random() * 1901) + 100;
      
      // Get first image for display
      const firstImage = product.images && product.images.length > 0 ? product.images[0] : 'https://images.unsplash.com/photo-1560769629-975ec94e6a86?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60';
      
      card.innerHTML = `
        <div class="product-card-image" style="background-image: url('${firstImage}')">
          <div class="product-card-badge">${discount}% OFF</div>
        </div>
        <div class="product-card-body">
          <div class="product-card-title">${product.name}</div>
          <div class="product-card-rating">
            <span class="product-card-stars">${generateStarRating(rating)}</span>
            <span class="product-card-review-count">(${reviewCount})</span>
          </div>
          <div class="product-card-price">
            <span class="product-card-current-price">₹${product.price}</span>
            <span class="product-card-original-price">₹${originalPrice}</span>
          </div>
          <div class="product-card-actions">
            <button class="action-btn wishlist-btn ${isInWishlist(product.id) ? 'active' : ''}" onclick="event.stopPropagation(); toggleWishlist('${product.id}')">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="${isInWishlist(product.id) ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
              </svg>
            </button>
            <button class="action-btn share-btn" onclick="event.stopPropagation(); shareProduct('${product.id}')">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="18" cy="5" r="3"></circle>
                <circle cx="6" cy="12" r="3"></circle>
                <circle cx="18" cy="19" r="3"></circle>
                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
              </svg>
            </button>
          </div>
        </div>
      `;
      
      return card;
    }

    function generateStarRating(rating) {
      const fullStars = Math.floor(rating);
      const hasHalfStar = rating % 1 >= 0.5;
      let stars = '';
      
      for (let i = 0; i < fullStars; i++) {
        stars += '★';
      }
      
      if (hasHalfStar) {
        stars += '½';
      }
      
      return stars;
    }

    // Load Products with Cache
    function loadProducts() {
      // First try to load from cache
      const cachedProducts = loadFromCache(CACHE_KEYS.PRODUCTS);
      if (cachedProducts) {
        products = cachedProducts;
        renderProducts();
        showToast('Products loaded from cache', 'success');
      }
      
      // Then load from Firebase
      db.collection('products').get()
        .then(querySnapshot => {
          const firebaseProducts = [];
          querySnapshot.forEach(doc => {
            firebaseProducts.push({ id: doc.id, ...doc.data() });
          });
          
          products = firebaseProducts;
          saveToCache(CACHE_KEYS.PRODUCTS, products);
          renderProducts();
          
          // Only show toast if cache was not available
          if (!cachedProducts) {
            showToast('Products loaded successfully', 'success');
          }
        })
        .catch(error => {
          console.error('Error loading products:', error);
          if (!cachedProducts) {
            showToast('Error loading products', 'error');
          }
        });
    }

    function renderProducts() {
      const homeGrid = document.getElementById('homeProductGrid');
      const productGrid = document.getElementById('productGrid');
      
      if (homeGrid) {
        homeGrid.innerHTML = '';
        products.slice(0, 8).forEach(product => {
          homeGrid.appendChild(createProductCard(product));
        });
      }
      
      if (productGrid) {
        productGrid.innerHTML = '';
        products.forEach(product => {
          productGrid.appendChild(createProductCard(product));
        });
      }
    }

    // Load Categories with Cache
    function loadCategories() {
      // First try to load from cache
      const cachedCategories = loadFromCache(CACHE_KEYS.CATEGORIES);
      if (cachedCategories) {
        categories = cachedCategories;
        renderCategories();
      }
      
      // Then load from Firebase
      db.collection('categories').get()
        .then(querySnapshot => {
          const firebaseCategories = [];
          querySnapshot.forEach(doc => {
            firebaseCategories.push({ id: doc.id, ...doc.data() });
          });
          
          categories = firebaseCategories;
          saveToCache(CACHE_KEYS.CATEGORIES, categories);
          renderCategories();
        })
        .catch(error => {
          console.error('Error loading categories:', error);
        });
    }

    function renderCategories() {
      const categoriesContainer = document.getElementById('categoriesContainer');
      if (!categoriesContainer) return;
      
      categoriesContainer.innerHTML = '';
      
      // Add "All" category
      const allPill = document.createElement('div');
      allPill.className = 'category-pill active';
      allPill.textContent = 'All';
      allPill.onclick = () => filterProductsByCategory('all');
      categoriesContainer.appendChild(allPill);
      
      // Add other categories
      categories.forEach(category => {
        const pill = document.createElement('div');
        pill.className = 'category-pill';
        pill.textContent = category.name;
        pill.onclick = () => filterProductsByCategory(category.id);
        categoriesContainer.appendChild(pill);
      });
    }

    function filterProductsByCategory(categoryId) {
      const pills = document.querySelectorAll('.category-pill');
      pills.forEach(pill => pill.classList.remove('active'));
      
      if (categoryId === 'all') {
        pills[0].classList.add('active');
        renderProducts();
      } else {
        const activePill = Array.from(pills).find(pill => 
          pill.textContent === categories.find(cat => cat.id === categoryId)?.name
        );
        if (activePill) activePill.classList.add('active');
        
        const filteredProducts = products.filter(product => product.category === categoryId);
        const productGrid = document.getElementById('productGrid');
        if (productGrid) {
          productGrid.innerHTML = '';
          filteredProducts.forEach(product => {
            productGrid.appendChild(createProductCard(product));
          });
        }
      }
    }

    // Load Banners with Cache
    function loadBanners() {
      // First try to load from cache
      const cachedBanners = loadFromCache(CACHE_KEYS.BANNERS);
      if (cachedBanners) {
        banners = cachedBanners;
        renderBanners();
      }
      
      // Then load from Firebase
      db.collection('banners').get()
        .then(querySnapshot => {
          const firebaseBanners = [];
          querySnapshot.forEach(doc => {
            firebaseBanners.push({ id: doc.id, ...doc.data() });
          });
          
          banners = firebaseBanners;
          saveToCache(CACHE_KEYS.BANNERS, banners);
          renderBanners();
        })
        .catch(error => {
          console.error('Error loading banners:', error);
        });
    }

    function renderBanners() {
      const bannerTrack = document.getElementById('bannerTrack');
      const bannerControls = document.getElementById('bannerControls');
      
      if (!bannerTrack || !bannerControls || banners.length === 0) return;
      
      bannerTrack.innerHTML = '';
      bannerControls.innerHTML = '';
      
      banners.forEach((banner, index) => {
        // Banner slide
        const slide = document.createElement('div');
        slide.className = 'banner-slide';
        slide.style.backgroundImage = `url('${banner.image}')`;
        slide.onclick = () => {
          if (banner.link) {
            window.open(banner.link, '_blank');
          }
        };
        bannerTrack.appendChild(slide);
        
        // Banner dot
        const dot = document.createElement('div');
        dot.className = `banner-dot ${index === 0 ? 'active' : ''}`;
        dot.onclick = () => showBanner(index);
        bannerControls.appendChild(dot);
      });
      
      // Start banner rotation
      startBannerRotation();
    }

    function showBanner(index) {
      const bannerTrack = document.getElementById('bannerTrack');
      const dots = document.querySelectorAll('.banner-dot');
      
      if (!bannerTrack || !dots.length) return;
      
      currentBannerIndex = index;
      bannerTrack.style.transform = `translateX(-${index * 100}%)`;
      
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
    }

    function startBannerRotation() {
      if (bannerInterval) clearInterval(bannerInterval);
      
      bannerInterval = setInterval(() => {
        const nextIndex = (currentBannerIndex + 1) % banners.length;
        showBanner(nextIndex);
      }, 5000); // Change banner every 5 seconds
    }

    // Product Detail Functions
    function showProductDetail(product) {
      selectedProduct = product;
      
      // Add to recently viewed
      addToRecentlyViewed(product);
      
      // Update breadcrumb
      document.getElementById('breadcrumbProductName').textContent = product.name;
      
      // Update main content
      document.getElementById('detailTitle').textContent = product.name;
      document.getElementById('detailSku').textContent = `SKU: ${product.sku || 'N/A'}`;
      document.getElementById('detailPrice').textContent = `₹${product.price}`;
      document.getElementById('detailDesc').textContent = product.description;
      document.getElementById('detailFullDesc').textContent = product.fullDescription || product.description;
      
      // Update stock status
      const stockStatus = document.getElementById('detailStockStatus');
      stockStatus.textContent = 'In Stock';
      stockStatus.className = 'stock-status in-stock';
      
      // Update wishlist button
      const wishlistBtn = document.getElementById('detailWishlistBtn');
      if (isInWishlist(product.id)) {
        wishlistBtn.textContent = 'Remove from Wishlist';
        wishlistBtn.classList.add('active');
      } else {
        wishlistBtn.textContent = 'Add to Wishlist';
        wishlistBtn.classList.remove('active');
      }
      
      // Update product images
      updateProductImages(product.images);
      
      // Update share link
      document.getElementById('productShareLink').value = `${window.location.origin}${window.location.pathname}?product=${product.id}`;
      
      // Load similar products
      loadSimilarProducts(product);
      
      showPage('productDetailPage');
    }

    function updateProductImages(images) {
      const mainImage = document.getElementById('detailMainImage');
      const thumbnails = document.getElementById('detailThumbnails');
      const carouselDots = document.getElementById('detailCarouselDots');
      
      if (!images || images.length === 0) {
        images = ['https://images.unsplash.com/photo-1560769629-975ec94e6a86?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60'];
      }
      
      // Set main image
      mainImage.style.backgroundImage = `url('${images[0]}')`;
      
      // Clear thumbnails and dots
      thumbnails.innerHTML = '';
      carouselDots.innerHTML = '';
      
      // Create thumbnails and dots
      images.forEach((image, index) => {
        // Thumbnail
        const thumb = document.createElement('div');
        thumb.className = `product-detail-thumbnail ${index === 0 ? 'active' : ''}`;
        thumb.style.backgroundImage = `url('${image}')`;
        thumb.onclick = () => {
          // Update main image
          mainImage.style.backgroundImage = `url('${image}')`;
          
          // Update active thumbnail
          document.querySelectorAll('.product-detail-thumbnail').forEach(t => t.classList.remove('active'));
          thumb.classList.add('active');
          
          // Update active dot
          document.querySelectorAll('.detail-carousel-dot').forEach(d => d.classList.remove('active'));
          document.querySelectorAll('.detail-carousel-dot')[index].classList.add('active');
        };
        thumbnails.appendChild(thumb);
        
        // Carousel dot
        const dot = document.createElement('div');
        dot.className = `detail-carousel-dot ${index === 0 ? 'active' : ''}`;
        dot.onclick = () => {
          mainImage.style.backgroundImage = `url('${image}')`;
          document.querySelectorAll('.product-detail-thumbnail').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.product-detail-thumbnail')[index].classList.add('active');
          document.querySelectorAll('.detail-carousel-dot').forEach(d => d.classList.remove('active'));
          dot.classList.add('active');
        };
        carouselDots.appendChild(dot);
      });
      
      // Add carousel controls
      const prevBtn = mainImage.querySelector('.prev');
      const nextBtn = mainImage.querySelector('.next');
      
      prevBtn.onclick = (e) => {
        e.stopPropagation();
        const currentIndex = Array.from(document.querySelectorAll('.detail-carousel-dot')).findIndex(dot => dot.classList.contains('active'));
        const prevIndex = (currentIndex - 1 + images.length) % images.length;
        document.querySelectorAll('.detail-carousel-dot')[prevIndex].click();
      };
      
      nextBtn.onclick = (e) => {
        e.stopPropagation();
        const currentIndex = Array.from(document.querySelectorAll('.detail-carousel-dot')).findIndex(dot => dot.classList.contains('active'));
        const nextIndex = (currentIndex + 1) % images.length;
        document.querySelectorAll('.detail-carousel-dot')[nextIndex].click();
      };
    }

    function loadSimilarProducts(product) {
      const similarSlider = document.getElementById('similarProductsSlider');
      if (!similarSlider) return;
      
      similarSlider.innerHTML = '';
      
      // Get products from same category (excluding current product)
      const similarProducts = products
        .filter(p => p.category === product.category && p.id !== product.id)
        .slice(0, 10);
      
      if (similarProducts.length === 0) {
        similarSlider.innerHTML = '<p style="text-align:center;color:var(--muted)">No similar products found.</p>';
        return;
      }
      
      similarProducts.forEach(product => {
        const sliderItem = createSliderItem(product);
        similarSlider.appendChild(sliderItem);
      });
    }

    function createSliderItem(product) {
      const item = document.createElement('div');
      item.className = 'slider-item';
      item.onclick = () => showProductDetail(product);
      
      const firstImage = product.images && product.images.length > 0 ? product.images[0] : 'https://images.unsplash.com/photo-1560769629-975ec94e6a86?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60';
      
      item.innerHTML = `
        <div class="slider-item-img" style="background-image: url('${firstImage}')"></div>
        <div class="slider-item-body">
          <div class="slider-item-title">${product.name}</div>
          <div class="slider-item-price">₹${product.price}</div>
        </div>
      `;
      
      return item;
    }

    // Image Zoom Functions
    function openImageZoom() {
      const mainImage = document.getElementById('detailMainImage');
      const zoomImage = document.getElementById('zoomImage');
      const zoomModal = document.getElementById('zoomModal');
      
      const imageUrl = mainImage.style.backgroundImage.replace('url("', '').replace('")', '');
      zoomImage.src = imageUrl;
      zoomImage.style.transform = `scale(${zoomLevel})`;
      
      zoomModal.classList.add('active');
    }

    function closeImageZoom() {
      const zoomModal = document.getElementById('zoomModal');
      zoomModal.classList.remove('active');
      zoomLevel = 1;
    }

    function zoomIn() {
      if (zoomLevel < 3) {
        zoomLevel += 0.1;
        document.getElementById('zoomImage').style.transform = `scale(${zoomLevel})`;
      }
    }

    function zoomOut() {
      if (zoomLevel > 0.5) {
        zoomLevel -= 0.1;
        document.getElementById('zoomImage').style.transform = `scale(${zoomLevel})`;
      }
    }

    // Wishlist Functions with Cache
    function loadWishlist() {
      if (currentUser) {
        // Load from Firebase for logged-in users
        db.collection('wishlists').doc(currentUser.uid).get()
          .then(doc => {
            if (doc.exists) {
              wishlist = doc.data().items || [];
              saveToCache(CACHE_KEYS.WISHLIST, wishlist);
              updateWishlistUI();
            }
          })
          .catch(error => {
            console.error('Error loading wishlist:', error);
            // Fallback to cache
            const cachedWishlist = loadFromCache(CACHE_KEYS.WISHLIST);
            if (cachedWishlist) wishlist = cachedWishlist;
          });
      } else {
        // Load from cache for guest users
        const cachedWishlist = loadFromCache(CACHE_KEYS.WISHLIST);
        if (cachedWishlist) wishlist = cachedWishlist;
      }
    }

    function saveWishlist() {
      if (currentUser) {
        // Save to Firebase for logged-in users
        db.collection('wishlists').doc(currentUser.uid).set({
          items: wishlist,
          updatedAt: new Date()
        })
        .catch(error => {
          console.error('Error saving wishlist:', error);
        });
      }
      // Always save to cache
      saveToCache(CACHE_KEYS.WISHLIST, wishlist);
    }

    function isInWishlist(productId) {
      return wishlist.includes(productId);
    }

    function toggleWishlist(productId) {
      if (isInWishlist(productId)) {
        wishlist = wishlist.filter(id => id !== productId);
        showToast('Removed from wishlist', 'success');
      } else {
        wishlist.push(productId);
        showToast('Added to wishlist', 'success');
      }
      
      saveWishlist();
      updateWishlistUI();
      
      // Update wishlist buttons
      document.querySelectorAll('.wishlist-btn').forEach(btn => {
        const card = btn.closest('.product-card');
        if (card) {
          const productName = card.querySelector('.product-card-title').textContent;
          const product = products.find(p => p.name === productName);
          if (product && product.id === productId) {
            btn.classList.toggle('active', isInWishlist(productId));
          }
        }
      });
      
      // Update detail page wishlist button
      if (selectedProduct && selectedProduct.id === productId) {
        const detailBtn = document.getElementById('detailWishlistBtn');
        if (detailBtn) {
          if (isInWishlist(productId)) {
            detailBtn.textContent = 'Remove from Wishlist';
            detailBtn.classList.add('active');
          } else {
            detailBtn.textContent = 'Add to Wishlist';
            detailBtn.classList.remove('active');
          }
        }
      }
    }

    function updateWishlistUI() {
      // Update wishlist page
      const wishlistGrid = document.getElementById('wishlistGrid');
      const noWishlist = document.getElementById('noWishlist');
      
      if (wishlistGrid && noWishlist) {
        if (wishlist.length === 0) {
          wishlistGrid.style.display = 'none';
          noWishlist.style.display = 'block';
        } else {
          wishlistGrid.style.display = 'grid';
          noWishlist.style.display = 'none';
          wishlistGrid.innerHTML = '';
          
          wishlist.forEach(productId => {
            const product = products.find(p => p.id === productId);
            if (product) {
              wishlistGrid.appendChild(createProductCard(product));
            }
          });
        }
      }
    }

    // Recently Viewed Functions with Cache
    function loadRecentlyViewed() {
      const cachedRecentlyViewed = loadFromCache(CACHE_KEYS.RECENTLY_VIEWED);
      if (cachedRecentlyViewed) {
        recentlyViewed = cachedRecentlyViewed;
        updateRecentlyViewedUI();
      }
    }

    function saveRecentlyViewed() {
      saveToCache(CACHE_KEYS.RECENTLY_VIEWED, recentlyViewed);
    }

    function addToRecentlyViewed(product) {
      // Remove if already exists
      recentlyViewed = recentlyViewed.filter(id => id !== product.id);
      
      // Add to beginning
      recentlyViewed.unshift(product.id);
      
      // Keep only last 10 items
      if (recentlyViewed.length > 10) {
        recentlyViewed = recentlyViewed.slice(0, 10);
      }
      
      saveRecentlyViewed();
      updateRecentlyViewedUI();
    }

    function updateRecentlyViewedUI() {
      const recentlyViewedSection = document.getElementById('recentlyViewedSection');
      const recentlyViewedSlider = document.getElementById('recentlyViewedSlider');
      
      if (!recentlyViewedSection || !recentlyViewedSlider) return;
      
      if (recentlyViewed.length === 0) {
        recentlyViewedSection.style.display = 'none';
        return;
      }
      
      recentlyViewedSection.style.display = 'block';
      recentlyViewedSlider.innerHTML = '';
      
      recentlyViewed.forEach(productId => {
        const product = products.find(p => p.id === productId);
        if (product) {
          recentlyViewedSlider.appendChild(createSliderItem(product));
        }
      });
    }

    // Order Functions
    function startOrder(product) {
      selectedProduct = product;
      selectedSize = 'S';
      selectedQuantity = 1;
      
      // Update order page
      document.getElementById('spTitle').textContent = product.name;
      document.getElementById('spPrice').textContent = `₹${product.price}`;
      document.getElementById('spDesc').textContent = product.description;
      document.getElementById('spFullDesc').textContent = product.fullDescription || product.description;
      
      // Update product images
      const galleryMain = document.getElementById('galleryMain');
      const carouselDots = galleryMain.querySelector('.carousel-dots');
      
      const images = product.images && product.images.length > 0 ? product.images : ['https://images.unsplash.com/photo-1560769629-975ec94e6a86?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60'];
      
      galleryMain.style.backgroundImage = `url('${images[0]}')`;
      carouselDots.innerHTML = '';
      
      images.forEach((image, index) => {
        const dot = document.createElement('div');
        dot.className = `carousel-dot ${index === 0 ? 'active' : ''}`;
        dot.onclick = () => {
          galleryMain.style.backgroundImage = `url('${image}')`;
          document.querySelectorAll('.carousel-dot').forEach(d => d.classList.remove('active'));
          dot.classList.add('active');
        };
        carouselDots.appendChild(dot);
      });
      
      // Add carousel controls
      const prevBtn = galleryMain.querySelector('.prev');
      const nextBtn = galleryMain.querySelector('.next');
      
      prevBtn.onclick = (e) => {
        e.stopPropagation();
        const currentIndex = Array.from(document.querySelectorAll('.carousel-dot')).findIndex(dot => dot.classList.contains('active'));
        const prevIndex = (currentIndex - 1 + images.length) % images.length;
        document.querySelectorAll('.carousel-dot')[prevIndex].click();
      };
      
      nextBtn.onclick = (e) => {
        e.stopPropagation();
        const currentIndex = Array.from(document.querySelectorAll('.carousel-dot')).findIndex(dot => dot.classList.contains('active'));
        const nextIndex = (currentIndex + 1) % images.length;
        document.querySelectorAll('.carousel-dot')[nextIndex].click();
      };
      
      showPage('orderPage');
    }

    // Search Functionality
    function setupSearch() {
      const homeSearchInput = document.getElementById('homeSearchInput');
      const searchInput = document.getElementById('searchInput');
      const homeSearchResults = document.getElementById('homeSearchResults');
      
      if (homeSearchInput) {
        homeSearchInput.addEventListener('input', (e) => {
          const query = e.target.value.toLowerCase().trim();
          if (query.length === 0) {
            homeSearchResults.style.display = 'none';
            return;
          }
          
          const filteredProducts = products.filter(product => 
            product.name.toLowerCase().includes(query) ||
            product.description.toLowerCase().includes(query) ||
            (product.category && categories.find(cat => cat.id === product.category)?.name.toLowerCase().includes(query))
          );
          
          if (filteredProducts.length === 0) {
            homeSearchResults.innerHTML = '<p style="text-align:center;color:var(--muted);grid-column:1/-1">No products found matching your search.</p>';
            homeSearchResults.style.display = 'grid';
          } else {
            homeSearchResults.innerHTML = '';
            filteredProducts.forEach(product => {
              homeSearchResults.appendChild(createProductCard(product));
            });
            homeSearchResults.style.display = 'grid';
          }
        });
      }
      
      if (searchInput) {
        searchInput.addEventListener('input', (e) => {
          const query = e.target.value.toLowerCase().trim();
          const productGrid = document.getElementById('productGrid');
          
          if (query.length === 0) {
            renderProducts();
            return;
          }
          
          const filteredProducts = products.filter(product => 
            product.name.toLowerCase().includes(query) ||
            product.description.toLowerCase().includes(query) ||
            (product.category && categories.find(cat => cat.id === product.category)?.name.toLowerCase().includes(query))
          );
          
          productGrid.innerHTML = '';
          if (filteredProducts.length === 0) {
            productGrid.innerHTML = '<p style="text-align:center;color:var(--muted);grid-column:1/-1">No products found matching your search.</p>';
          } else {
            filteredProducts.forEach(product => {
              productGrid.appendChild(createProductCard(product));
            });
          }
        });
      }
    }

    // Share Product Functionality
    function shareProduct(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;
      
      const shareUrl = `${window.location.origin}${window.location.pathname}?product=${productId}`;
      const shareText = `Check out ${product.name} on Buyzo Cart - ₹${product.price}`;
      
      if (navigator.share) {
        navigator.share({
          title: product.name,
          text: shareText,
          url: shareUrl
        })
        .catch(error => console.log('Error sharing:', error));
      } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(`${shareText} - ${shareUrl}`)
          .then(() => showToast('Product link copied to clipboard', 'success'))
          .catch(() => {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = `${shareText} - ${shareUrl}`;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            showToast('Product link copied to clipboard', 'success');
          });
      }
    }

    // Authentication Functions
    function setupAuth() {
      // Check if user is already logged in
      auth.onAuthStateChanged(user => {
        if (user) {
          currentUser = user;
          showUserProfile(user);
          loadWishlist();
          showToast(`Welcome back, ${user.displayName || user.email}`, 'success');
        } else {
          currentUser = null;
          hideUserProfile();
          // Keep guest wishlist
        }
      });
      
      // Setup auth modal
      const authModal = document.getElementById('authModal');
      const authClose = document.getElementById('authClose');
      const loginTab = document.getElementById('loginTab');
      const signupTab = document.getElementById('signupTab');
      const loginForm = document.getElementById('loginForm');
      const signupForm = document.getElementById('signupForm');
      const showForgotPassword = document.getElementById('showForgotPassword');
      const forgotPasswordForm = document.getElementById('forgotPasswordForm');
      const backToLogin = document.getElementById('backToLogin');
      const googleSignIn = document.getElementById('googleSignIn');
      
      // Open auth modal buttons
      document.getElementById('openLoginTop').addEventListener('click', showLoginModal);
      document.getElementById('mobileLoginBtn').addEventListener('click', showLoginModal);
      
      // Close auth modal
      authClose.addEventListener('click', () => {
        authModal.classList.remove('active');
      });
      
      // Tab switching
      loginTab.addEventListener('click', () => {
        loginTab.classList.add('active');
        signupTab.classList.remove('active');
        loginForm.classList.add('active');
        signupForm.classList.remove('active');
        forgotPasswordForm.classList.remove('active');
      });
      
      signupTab.addEventListener('click', () => {
        signupTab.classList.add('active');
        loginTab.classList.remove('active');
        signupForm.classList.add('active');
        loginForm.classList.remove('active');
        forgotPasswordForm.classList.remove('active');
      });
      
      // Forgot password
      showForgotPassword.addEventListener('click', () => {
        loginForm.classList.remove('active');
        forgotPasswordForm.classList.add('active');
      });
      
      backToLogin.addEventListener('click', () => {
        forgotPasswordForm.classList.remove('active');
        loginForm.classList.add('active');
      });
      
      // Form submissions
      loginForm.addEventListener('submit', handleLogin);
      signupForm.addEventListener('submit', handleSignup);
      forgotPasswordForm.addEventListener('submit', handleForgotPassword);
      
      // Google Sign In
      googleSignIn.addEventListener('click', handleGoogleSignIn);
    }

    function showLoginModal() {
      const authModal = document.getElementById('authModal');
      authModal.classList.add('active');
    }

    function showUserProfile(user) {
      const userProfile = document.getElementById('userProfile');
      const mobileUserProfile = document.getElementById('mobileUserProfile');
      const mobileLoginBtn = document.getElementById('mobileLoginBtn');
      const openLoginTop = document.getElementById('openLoginTop');
      const userAvatar = document.getElementById('userAvatar');
      const userName = document.getElementById('userName');
      const accountEmail = document.getElementById('accountEmail');
      const mobileUserName = document.getElementById('mobileUserName');
      
      if (userProfile) {
        userProfile.style.display = 'flex';
        openLoginTop.style.display = 'none';
        
        // Set user info
        const displayName = user.displayName || user.email.split('@')[0];
        userAvatar.textContent = displayName.charAt(0).toUpperCase();
        userName.textContent = displayName;
        accountEmail.textContent = user.email;
      }
      
      if (mobileUserProfile) {
        mobileUserProfile.style.display = 'flex';
        mobileLoginBtn.style.display = 'none';
        mobileUserName.textContent = user.displayName || user.email.split('@')[0];
      }
    }

    function hideUserProfile() {
      const userProfile = document.getElementById('userProfile');
      const mobileUserProfile = document.getElementById('mobileUserProfile');
      const mobileLoginBtn = document.getElementById('mobileLoginBtn');
      const openLoginTop = document.getElementById('openLoginTop');
      
      if (userProfile) {
        userProfile.style.display = 'none';
        openLoginTop.style.display = 'block';
      }
      
      if (mobileUserProfile) {
        mobileUserProfile.style.display = 'none';
        mobileLoginBtn.style.display = 'flex';
      }
    }

    function toggleUserMenu() {
      const accountDropdown = document.getElementById('accountDropdown');
      accountDropdown.classList.toggle('active');
    }

    function handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      
      auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => {
          document.getElementById('authModal').classList.remove('active');
          showToast('Login successful', 'success');
        })
        .catch(error => {
          showToast(error.message, 'error');
        });
    }

    function handleSignup(e) {
      e.preventDefault();
      const name = document.getElementById('signupName').value;
      const email = document.getElementById('signupEmail').value;
      const password = document.getElementById('signupPassword').value;
      const confirmPassword = document.getElementById('signupConfirmPassword').value;
      
      if (password !== confirmPassword) {
        showToast('Passwords do not match', 'error');
        return;
      }
      
      auth.createUserWithEmailAndPassword(email, password)
        .then(userCredential => {
          // Update user profile
          return userCredential.user.updateProfile({
            displayName: name
          });
        })
        .then(() => {
          document.getElementById('authModal').classList.remove('active');
          showToast('Account created successfully', 'success');
        })
        .catch(error => {
          showToast(error.message, 'error');
        });
    }

    function handleForgotPassword(e) {
      e.preventDefault();
      const email = document.getElementById('forgotEmail').value;
      
      auth.sendPasswordResetEmail(email)
        .then(() => {
          showToast('Password reset email sent', 'success');
          document.getElementById('forgotPasswordForm').classList.remove('active');
          document.getElementById('loginForm').classList.add('active');
        })
        .catch(error => {
          showToast(error.message, 'error');
        });
    }

    function handleGoogleSignIn() {
      const provider = new firebase.auth.GoogleAuthProvider();
      
      auth.signInWithPopup(provider)
        .then(result => {
          document.getElementById('authModal').classList.remove('active');
          showToast('Login successful', 'success');
        })
        .catch(error => {
          showToast(error.message, 'error');
        });
    }

    function logout() {
      auth.signOut()
        .then(() => {
          showToast('Logged out successfully', 'success');
          // Keep guest wishlist in cache
        })
        .catch(error => {
          showToast(error.message, 'error');
        });
    }

    // Initialize the app
    document.addEventListener('DOMContentLoaded', function() {
      // Load data with cache fallback
      loadProducts();
      loadCategories();
      loadBanners();
      loadWishlist();
      loadRecentlyViewed();
      
      // Setup event listeners
      setupSearch();
      setupAuth();
      setupEventListeners();
      
      // Show home page by default
      showPage('homePage');
    });

    function setupEventListeners() {
      // Order flow buttons
      document.getElementById('detailOrderBtn').addEventListener('click', function() {
        if (selectedProduct) {
          startOrder(selectedProduct);
        }
      });
      
      document.getElementById('toUserInfo').addEventListener('click', function() {
        // Validate size selection
        if (!selectedSize) {
          document.getElementById('sizeValidationError').classList.add('show');
          return;
        }
        document.getElementById('sizeValidationError').classList.remove('show');
        showPage('userPage');
      });
      
      document.getElementById('backToProducts').addEventListener('click', function() {
        showPage('productsPage');
      });
      
      document.getElementById('toPayment').addEventListener('click', function() {
        // Validate user info
        const fullname = document.getElementById('fullname').value;
        const mobile = document.getElementById('mobile').value;
        const pincode = document.getElementById('pincode').value;
        const city = document.getElementById('city').value;
        const state = document.getElementById('state').value;
        const house = document.getElementById('house').value;
        
        if (!fullname || !mobile || !pincode || !city || !state || !house) {
          showToast('Please fill all required fields', 'error');
          return;
        }
        
        // Save user info
        userInfo = { fullname, mobile, pincode, city, state, house };
        
        // Update summary
        updateOrderSummary();
        
        showPage('paymentPage');
      });
      
      document.getElementById('editOrder').addEventListener('click', function() {
        showPage('orderPage');
      });
      
      document.getElementById('payBack').addEventListener('click', function() {
        showPage('userPage');
      });
      
      document.getElementById('confirmOrder').addEventListener('click', function() {
        placeOrder();
      });
      
      document.getElementById('goHome').addEventListener('click', function() {
        showPage('homePage');
      });
      
      document.getElementById('viewOrders').addEventListener('click', function() {
        showMyOrders();
        showPage('myOrdersPage');
      });
      
      // Size selection
      document.querySelectorAll('.size-option').forEach(option => {
        option.addEventListener('click', function() {
          document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
          this.classList.add('selected');
          selectedSize = this.getAttribute('data-value');
        });
      });
      
      // Quantity controls
      document.querySelector('.qty-minus').addEventListener('click', function() {
        const qtyInput = document.getElementById('qtySelect');
        let qty = parseInt(qtyInput.value);
        if (qty > 1) {
          qtyInput.value = qty - 1;
          selectedQuantity = qty - 1;
        }
      });
      
      document.querySelector('.qty-plus').addEventListener('click', function() {
        const qtyInput = document.getElementById('qtySelect');
        let qty = parseInt(qtyInput.value);
        qtyInput.value = qty + 1;
        selectedQuantity = qty + 1;
      });
      
      // Contact and My Orders buttons in header
      document.getElementById('openContactTop').addEventListener('click', function() {
        showPage('contactPage');
      });
      
      document.getElementById('openMyOrdersTop').addEventListener('click', function() {
        showMyOrders();
        showPage('myOrdersPage');
      });
      
      // Copy share link
      document.getElementById('copyShareLink').addEventListener('click', function() {
        const shareLink = document.getElementById('productShareLink');
        shareLink.select();
        document.execCommand('copy');
        showToast('Link copied to clipboard', 'success');
      });
      
      // Social sharing
      document.querySelectorAll('.share-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.stopPropagation();
          const platform = this.getAttribute('data-platform');
          shareOnPlatform(platform);
        });
      });
      
      // Image zoom
      document.getElementById('zoomClose').addEventListener('click', closeImageZoom);
      document.getElementById('zoomIn').addEventListener('click', zoomIn);
      document.getElementById('zoomOut').addEventListener('click', zoomOut);
      
      // Newsletter subscription
      document.getElementById('subscribeBtn').addEventListener('click', function() {
        const email = document.getElementById('newsletterEmail').value;
        if (email && validateEmail(email)) {
          showToast('Thank you for subscribing!', 'success');
          document.getElementById('newsletterEmail').value = '';
        } else {
          showToast('Please enter a valid email address', 'error');
        }
      });
      
      // Price filter
      document.getElementById('applyPriceFilter').addEventListener('click', applyPriceFilter);
      document.getElementById('resetPriceFilter').addEventListener('click', resetPriceFilter);
      
      // Update price values when sliders change
      document.getElementById('minPriceSlider').addEventListener('input', function() {
        document.getElementById('minPrice').value = this.value;
        document.getElementById('minPriceValue').textContent = `₹${this.value}`;
      });
      
      document.getElementById('maxPriceSlider').addEventListener('input', function() {
        document.getElementById('maxPrice').value = this.value;
        document.getElementById('maxPriceValue').textContent = `₹${this.value}`;
      });
      
      document.getElementById('minPrice').addEventListener('input', function() {
        document.getElementById('minPriceSlider').value = this.value;
        document.getElementById('minPriceValue').textContent = `₹${this.value}`;
      });
      
      document.getElementById('maxPrice').addEventListener('input', function() {
        document.getElementById('maxPriceSlider').value = this.value;
        document.getElementById('maxPriceValue').textContent = `₹${this.value}`;
      });
      
      // User profile dropdown
      document.getElementById('userProfile').addEventListener('click', function(e) {
        e.stopPropagation();
        toggleUserMenu();
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', function() {
        const accountDropdown = document.getElementById('accountDropdown');
        if (accountDropdown) {
          accountDropdown.classList.remove('active');
        }
      });
    }

    function updateOrderSummary() {
      if (!selectedProduct) return;
      
      const totalPrice = selectedProduct.price * selectedQuantity;
      const deliveryCharge = 50;
      const finalTotal = totalPrice + deliveryCharge;
      
      document.getElementById('sumProduct').textContent = selectedProduct.name;
      document.getElementById('sumQty').textContent = selectedQuantity;
      document.getElementById('sumPrice').textContent = `₹${totalPrice}`;
      document.getElementById('sumDel').textContent = `₹${deliveryCharge}`;
      document.getElementById('sumTotal').textContent = `₹${finalTotal}`;
    }

    function placeOrder() {
      if (!selectedProduct || !userInfo) return;
      
      // Generate order ID
      const orderId = 'ORD' + Date.now();
      currentOrderId = orderId;
      
      const totalPrice = selectedProduct.price * selectedQuantity;
      const deliveryCharge = 50;
      const finalTotal = totalPrice + deliveryCharge;
      
      const orderData = {
        id: orderId,
        product: selectedProduct,
        size: selectedSize,
        quantity: selectedQuantity,
        userInfo: userInfo,
        total: finalTotal,
        status: 'confirmed',
        createdAt: new Date().toISOString(),
        estimatedDelivery: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString() // 7 days from now
      };
      
      // Save order to Firebase if user is logged in, otherwise to cache
      if (currentUser) {
        db.collection('orders').doc(orderId).set(orderData)
          .then(() => {
            showSuccessPage();
          })
          .catch(error => {
            console.error('Error saving order:', error);
            showToast('Error placing order', 'error');
          });
      } else {
        // Save to cache for guest users
        const guestOrders = loadFromCache(CACHE_KEYS.ORDERS) || [];
        guestOrders.push(orderData);
        saveToCache(CACHE_KEYS.ORDERS, guestOrders);
        showSuccessPage();
      }
    }

    function showSuccessPage() {
      showPage('successPage');
      
      // Reset order data
      selectedProduct = null;
      selectedSize = 'S';
      selectedQuantity = 1;
      userInfo = {};
      
      // Update notification badge
      updateOrdersNotification();
    }

    function showMyOrders() {
      const ordersList = document.getElementById('ordersList');
      const noOrders = document.getElementById('noOrders');
      
      if (!ordersList || !noOrders) return;
      
      let userOrders = [];
      
      if (currentUser) {
        // Load from Firebase for logged-in users
        db.collection('orders').where('userInfo.email', '==', currentUser.email).get()
          .then(querySnapshot => {
            querySnapshot.forEach(doc => {
              userOrders.push(doc.data());
            });
            
            // Also check cache for guest orders that might need to be migrated
            const guestOrders = loadFromCache(CACHE_KEYS.ORDERS) || [];
            if (guestOrders.length > 0) {
              // Migrate guest orders to user account
              guestOrders.forEach(order => {
                if (!userOrders.some(o => o.id === order.id)) {
                  order.userInfo.email = currentUser.email;
                  db.collection('orders').doc(order.id).set(order);
                  userOrders.push(order);
                }
              });
              // Clear guest orders from cache after migration
              clearCache(CACHE_KEYS.ORDERS);
            }
            
            displayOrders(userOrders, ordersList, noOrders);
          })
          .catch(error => {
            console.error('Error loading orders:', error);
            // Fallback to cache
            const cachedOrders = loadFromCache(CACHE_KEYS.ORDERS);
            displayOrders(cachedOrders || [], ordersList, noOrders);
          });
      } else {
        // Load from cache for guest users
        const cachedOrders = loadFromCache(CACHE_KEYS.ORDERS) || [];
        displayOrders(cachedOrders, ordersList, noOrders);
      }
    }

    function displayOrders(orders, ordersList, noOrders) {
      if (orders.length === 0) {
        ordersList.style.display = 'none';
        noOrders.style.display = 'block';
        return;
      }
      
      ordersList.style.display = 'block';
      noOrders.style.display = 'none';
      ordersList.innerHTML = '';
      
      // Sort orders by date (newest first)
      orders.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
      
      orders.forEach(order => {
        const orderCard = createOrderCard(order);
        ordersList.appendChild(orderCard);
      });
      
      // Update notification badge
      updateOrdersNotification();
    }

    function createOrderCard(order) {
      const card = document.createElement('div');
      card.className = 'order-card';
      card.onclick = () => showOrderDetail(order);
      
      const product = order.product;
      const firstImage = product.images && product.images.length > 0 ? product.images[0] : 'https://images.unsplash.com/photo-1560769629-975ec94e6a86?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60';
      
      const statusClass = {
        'confirmed': 'status-confirmed',
        'shipped': 'status-shipped',
        'delivered': 'status-delivered',
        'cancelled': 'status-cancelled'
      }[order.status] || 'status-confirmed';
      
      const statusText = {
        'confirmed': 'Confirmed',
        'shipped': 'Shipped',
        'delivered': 'Delivered',
        'cancelled': 'Cancelled'
      }[order.status] || 'Confirmed';
      
      card.innerHTML = `
        <div class="order-header">
          <div>
            <div class="order-id">Order #${order.id}</div>
            <div class="order-date">Placed on ${new Date(order.createdAt).toLocaleDateString()}</div>
            <div class="order-estimated">Est. delivery: ${new Date(order.estimatedDelivery).toLocaleDateString()}</div>
          </div>
          <div class="order-status ${statusClass}">${statusText}</div>
        </div>
        <div class="order-details">
          <div class="order-product-image" style="background-image: url('${firstImage}')"></div>
          <div class="order-product-info">
            <div class="order-product-title">${product.name}</div>
            <div class="order-product-price">₹${product.price} × ${order.quantity}</div>
            <div class="order-product-meta">Size: ${order.size} | Total: ₹${order.total}</div>
          </div>
        </div>
        <div class="order-actions">
          ${order.status === 'confirmed' ? '<button class="btn secondary cancel-order-btn">Cancel Order</button>' : ''}
          <button class="btn">View Details</button>
        </div>
      `;
      
      // Add cancel order event listener
      const cancelBtn = card.querySelector('.cancel-order-btn');
      if (cancelBtn) {
        cancelBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          showCancelOrderModal(order);
        });
      }
      
      return card;
    }

    function showOrderDetail(order) {
      const orderDetailContent = document.getElementById('orderDetailContent');
      if (!orderDetailContent) return;
      
      const product = order.product;
      const firstImage = product.images && product.images.length > 0 ? product.images[0] : 'https://images.unsplash.com/photo-1560769629-975ec94e6a86?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60';
      
      const statusClass = {
        'confirmed': 'status-confirmed',
        'shipped': 'status-shipped',
        'delivered': 'status-delivered',
        'cancelled': 'status-cancelled'
      }[order.status] || 'status-confirmed';
      
      const statusText = {
        'confirmed': 'Confirmed',
        'shipped': 'Shipped',
        'delivered': 'Delivered',
        'cancelled': 'Cancelled'
      }[order.status] || 'Confirmed';
      
      orderDetailContent.innerHTML = `
        <div class="order-detail-section">
          <div class="order-detail-label">Order ID</div>
          <div class="order-detail-value">${order.id}</div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Order Status</div>
          <div class="order-detail-value"><span class="order-status ${statusClass}">${statusText}</span></div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Order Date</div>
          <div class="order-detail-value">${new Date(order.createdAt).toLocaleDateString()}</div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Estimated Delivery</div>
          <div class="order-detail-value">${new Date(order.estimatedDelivery).toLocaleDateString()}</div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Product</div>
          <div class="order-detail-product">
            <div class="order-detail-image" style="background-image: url('${firstImage}')"></div>
            <div class="order-detail-product-info">
              <div class="order-product-title">${product.name}</div>
              <div class="order-product-price">₹${product.price}</div>
              <div class="order-product-meta">Size: ${order.size} | Quantity: ${order.quantity}</div>
            </div>
          </div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Delivery Address</div>
          <div class="order-detail-value">
            ${order.userInfo.fullname}<br>
            ${order.userInfo.house}<br>
            ${order.userInfo.city}, ${order.userInfo.state} - ${order.userInfo.pincode}<br>
            Phone: ${order.userInfo.mobile}
          </div>
        </div>
        
        <div class="order-detail-section">
          <div class="order-detail-label">Payment Summary</div>
          <div class="order-detail-value">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px">
              <span>Product Total:</span>
              <span>₹${product.price * order.quantity}</span>
            </div>
            <div style="display:flex;justify-content:space-between;margin-bottom:8px">
              <span>Delivery Charge:</span>
              <span>₹50</span>
            </div>
            <div style="display:flex;justify-content:space-between;font-weight:700;font-size:18px;margin-top:8px">
              <span>Total Amount:</span>
              <span>₹${order.total}</span>
            </div>
          </div>
        </div>
        
        ${order.status === 'confirmed' ? `
        <div class="order-detail-section">
          <button class="btn error" id="cancelOrderDetailBtn">Cancel Order</button>
        </div>
        ` : ''}
        
        ${order.status === 'delivered' ? `
        <div class="delivery-congrats">
          <div class="delivery-congrats-icon">🎉</div>
          <div>Your order has been delivered successfully!</div>
        </div>
        ` : ''}
      `;
      
      // Add cancel order event listener
      const cancelBtn = orderDetailContent.querySelector('#cancelOrderDetailBtn');
      if (cancelBtn) {
        cancelBtn.addEventListener('click', () => {
          showCancelOrderModal(order);
        });
      }
      
      showPage('orderDetailPage');
    }

    function showCancelOrderModal(order) {
      const modal = document.getElementById('cancelConfirmModal');
      const cancelBtn = document.getElementById('cancelCancel');
      const confirmBtn = document.getElementById('confirmCancel');
      
      // Calculate refund amount (deduct 2-3% for payment gateway charges)
      const gatewayCharges = Math.round(order.total * 0.025); // 2.5%
      const refundAmount = order.total - gatewayCharges;
      
      document.getElementById('refundOrderAmount').textContent = `₹${order.total}`;
      document.getElementById('refundCharges').textContent = `₹${gatewayCharges}`;
      document.getElementById('refundAmount').textContent = `₹${refundAmount}`;
      
      modal.classList.add('active');
      
      cancelBtn.onclick = () => {
        modal.classList.remove('active');
      };
      
      confirmBtn.onclick = () => {
        cancelOrder(order.id);
        modal.classList.remove('active');
      };
    }

    function cancelOrder(orderId) {
      if (currentUser) {
        // Update in Firebase
        db.collection('orders').doc(orderId).update({
          status: 'cancelled'
        })
        .then(() => {
          showToast('Order cancelled successfully', 'success');
          showMyOrders();
          if (document.getElementById('orderDetailPage').classList.contains('active')) {
            showPage('myOrdersPage');
          }
        })
        .catch(error => {
          console.error('Error cancelling order:', error);
          showToast('Error cancelling order', 'error');
        });
      } else {
        // Update in cache
        const guestOrders = loadFromCache(CACHE_KEYS.ORDERS) || [];
        const orderIndex = guestOrders.findIndex(order => order.id === orderId);
        if (orderIndex !== -1) {
          guestOrders[orderIndex].status = 'cancelled';
          saveToCache(CACHE_KEYS.ORDERS, guestOrders);
          showToast('Order cancelled successfully', 'success');
          showMyOrders();
          if (document.getElementById('orderDetailPage').classList.contains('active')) {
            showPage('myOrdersPage');
          }
        }
      }
    }

    function updateOrdersNotification() {
      const notification = document.getElementById('ordersNotification');
      if (!notification) return;
      
      let orderCount = 0;
      
      if (currentUser) {
        // Count confirmed orders from Firebase
        db.collection('orders')
          .where('userInfo.email', '==', currentUser.email)
          .where('status', 'in', ['confirmed', 'shipped'])
          .get()
          .then(querySnapshot => {
            orderCount = querySnapshot.size;
            updateNotificationBadge(orderCount);
          })
          .catch(error => {
            console.error('Error counting orders:', error);
            // Fallback to cache
            const cachedOrders = loadFromCache(CACHE_KEYS.ORDERS) || [];
            orderCount = cachedOrders.filter(order => order.status === 'confirmed' || order.status === 'shipped').length;
            updateNotificationBadge(orderCount);
          });
      } else {
        // Count from cache for guest users
        const cachedOrders = loadFromCache(CACHE_KEYS.ORDERS) || [];
        orderCount = cachedOrders.filter(order => order.status === 'confirmed' || order.status === 'shipped').length;
        updateNotificationBadge(orderCount);
      }
    }

    function updateNotificationBadge(count) {
      const notification = document.getElementById('ordersNotification');
      if (!notification) return;
      
      if (count > 0) {
        notification.textContent = count > 9 ? '9+' : count;
        notification.style.display = 'flex';
      } else {
        notification.style.display = 'none';
      }
    }

    function applyPriceFilter() {
      const minPrice = parseInt(document.getElementById('minPrice').value) || 0;
      const maxPrice = parseInt(document.getElementById('maxPrice').value) || 5000;
      
      const filteredProducts = products.filter(product => 
        product.price >= minPrice && product.price <= maxPrice
      );
      
      const productGrid = document.getElementById('productGrid');
      if (productGrid) {
        productGrid.innerHTML = '';
        if (filteredProducts.length === 0) {
          productGrid.innerHTML = '<p style="text-align:center;color:var(--muted);grid-column:1/-1">No products found in this price range.</p>';
        } else {
          filteredProducts.forEach(product => {
            productGrid.appendChild(createProductCard(product));
          });
        }
      }
    }

    function resetPriceFilter() {
      document.getElementById('minPrice').value = '0';
      document.getElementById('maxPrice').value = '5000';
      document.getElementById('minPriceSlider').value = '0';
      document.getElementById('maxPriceSlider').value = '5000';
      document.getElementById('minPriceValue').textContent = '₹0';
      document.getElementById('maxPriceValue').textContent = '₹5000';
      
      renderProducts();
    }

    function shareOnPlatform(platform) {
      if (!selectedProduct) return;
      
      const shareUrl = `${window.location.origin}${window.location.pathname}?product=${selectedProduct.id}`;
      const shareText = `Check out ${selectedProduct.name} on Buyzo Cart - ₹${selectedProduct.price}`;
      
      let shareWindowUrl = '';
      
      switch (platform) {
        case 'facebook':
          shareWindowUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
          break;
        case 'twitter':
          shareWindowUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;
          break;
        case 'whatsapp':
          shareWindowUrl = `https://wa.me/?text=${encodeURIComponent(shareText + ' ' + shareUrl)}`;
          break;
        default:
          return;
      }
      
      window.open(shareWindowUrl, '_blank', 'width=600,height=400');
    }

    function validateEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    // Hero Messages Rotation
    function rotateHeroMessages() {
      const messages = document.querySelectorAll('#heroMessages span');
      let currentIndex = 0;
      
      setInterval(() => {
        messages.forEach(msg => msg.classList.remove('active'));
        currentIndex = (currentIndex + 1) % messages.length;
        messages[currentIndex].classList.add('active');
      }, 3000);
    }

    // Initialize hero messages rotation
    rotateHeroMessages();

    // Load category circles
    function loadCategoryCircles() {
      const container = document.getElementById('categoryCirclesContainer');
      if (!container) return;
      
      container.innerHTML = '';
      
      categories.forEach(category => {
        const circle = document.createElement('div');
        circle.className = 'category-circle';
        circle.onclick = () => filterProductsByCategory(category.id);
        
        circle.innerHTML = `
          <div class="category-circle-image" style="background-image: url('${category.image || 'https://images.unsplash.com/photo-1560769629-975ec94e6a86?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60'}')"></div>
          <div class="category-circle-name">${category.name}</div>
        `;
        
        container.appendChild(circle);
      });
    }

    // Update category circles when categories are loaded
    const originalLoadCategories = loadCategories;
    loadCategories = function() {
      originalLoadCategories();
      loadCategoryCircles();
    };

    // Load trending products slider
    function loadTrendingProducts() {
      const slider = document.getElementById('productSlider');
      if (!slider) return;
      
      slider.innerHTML = '';
      
      // Get random products for trending section
      const trendingProducts = [...products]
        .sort(() => Math.random() - 0.5)
        .slice(0, 10);
      
      trendingProducts.forEach(product => {
        slider.appendChild(createSliderItem(product));
      });
    }

    // Update trending products when products are loaded
    const originalLoadProducts = loadProducts;
    loadProducts = function() {
      originalLoadProducts();
      loadTrendingProducts();
    };
  </script>
</body>
</html>